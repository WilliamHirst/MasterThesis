*#define CHECK

#if 0
* hggSM-SquaredME.F
* assembly of squared matrix element
* generated by FormCalc 7.5 on 27-Sep-2012 9:08
* this file is part of FeynHiggs
#endif

#include "hggSM-vars.h"

************************************************************************

	RealType function hggSM_sumup(CCloop, CCtree)
	implicit none

#include "hggSM-vars.h"

	ComplexType CCloop(1), CCtree(1)
	ComplexType m

	hggSM_sumup = 0

	m = 0
	m = m + CCloop(1)*MatSUN(1,1)
	hggSM_sumup = hggSM_sumup + Re(Conjugate(CCtree(1))*m)
	end

************************************************************************

	subroutine hggSM_SquaredMEHel(result)
	implicit none
	RealType result(*)

#include "hggSM-vars.h"

	RealType hggSM_sumup
	external hggSM_sumup

* hggSM-BEGIN ABBR_HEL
	call hggSM_abbr1hel
* hggSM-END ABBR_HEL

* hggSM-BEGIN FF_INI
	Cloop(1) = 0
* hggSM-END FF_INI

* hggSM-BEGIN FF_LOOP

	LOOP(Gen4, 1,3,1)
	call hggSM_v1_Gen4
	ENDLOOP(Gen4)

	result(2) = result(2) + hggSM_sumup(Cloop, Cloop)
* hggSM-END FF_LOOP
	end

************************************************************************

	subroutine hggSM_SquaredME(result, helicities)
	implicit none
	RealType result(*)
	integer helicities

#include "hggSM-vars.h"

* hggSM-BEGIN VARDECL
	external hggSM_SquaredMEHel

	integer Hel1, Hel2, Hel3
	equivalence (Hel(1), Hel1)
	equivalence (Hel(2), Hel2)
	equivalence (Hel(3), Hel3)

	data MatSUN /1*bogus/
* hggSM-END VARDECL

#include "inline.h"

* hggSM-BEGIN INVARIANTS
* hggSM-END INVARIANTS

* hggSM-BEGIN ABBR_S
	call hggSM_abbr1s
* hggSM-END ABBR_S

* hggSM-BEGIN ABBR_ANGLE
* hggSM-END ABBR_ANGLE

* hggSM-BEGIN RES_INI
	result(1) = 0
	result(2) = 0
* hggSM-END RES_INI

* hggSM-BEGIN HEL_LOOPS

	LOOP_HEL(Hel2)
	TEST(helicities, BIT_HEL(2))

	Hel3 = Hel2

	call hggSM_SquaredMEHel(result)

	ENDTEST(helicities, BIT_HEL(2))
	ENDLOOP_HEL(Hel2)

* hggSM-END HEL_LOOPS

#ifdef CHECK
	print *, 'tree =', result(1)
	print *, 'loop =', result(2)
	stop
#endif

* hggSM-END SQUAREDME
	end

