!
      SUBROUTINE CRGE601(T,GCURR,FCURR)
!
!Contains the full threshold RGEs.
!
!CRGE601 IS FOR THRESHOLDS WITH THETAS.
!
!     G(  1) = g_1         G(  2) = g_2         G(  3) = g_3
!     G(  4) = FU(1,1)     G(  5) = FU(1,2)     G( 12) = FU(3,3)
!     G( 13) = FD(1,1)     G( 22) = FE(1,1)     G( 30) = FE(3,3)
!     G( 31) = M_1         G( 32) = M_2         G( 33) = M_3
!     G( 34) = AU(1,1)     G( 43) = AD(1,1)     G( 52) = AE(1,1)
!     G( 61) = M_Hu^2+MT^2 G( 62) = M_Hd^2+MT^2 G( 63) = MQ(1,1)
!     G( 72) = ML(1,1)     G( 81) = MUP(1,1)    G( 90) = MD(1,1)
!     G( 99) = ME(1,1)     G(108) = mu          G(109) = b
!     G(110) = V_U         G(111) = V_D
!
!     G(112) = LU(1,1)     G(121) = LD(1,1)     G(130) = LE(1,1)
!
!     G(139) = GTPQ(1,1)   G(148) = GTPL(1,1)   G(157) = GTPU(1,1)
!     G(166) = GTPD(1,1)   G(175) = GTPE(1,1)   G(184) = GTP_Hu
!     G(185) = GTP_Hd      G(186) = GTQ(1,1)    G(195) = GTL(1,1)
!     G(204) = GT_Hu       G(205) = GT_Hd       G(206) = GTSQ(1,1)
!     G(215) = GTSU(1,1)   G(224) = GTSD(1,1)   G(233) = FTUQ(1,1)
!     G(242) = FTDQ(1,1)   G(251) = FTEL(1,1)   G(260) = FTUU(1,1)
!     G(269) = FTDD(1,1)   G(278) = FTEE(1,1)   G(287) = sGTP_Hu
!     G(288) = cGTP_Hd     G(289) = sGT_Hu      G(290) = cGT_Hd
!
!     G(291) = g(M)_1      G(292) = g(M)_2      G(293) = g(M)_3
!     G(294) = f(M)_U(1,1) G(303) = f(M)_D(1,1) G(312) = f(M)_E(1,1)
!     G(321) = M^(MV)_1(M) G(322) = M^(MV)_2(M) G(323) = M^(MV)_3(M)
!     G(324) = AU(M)(1,1)  G(333) = AD(M)(1,1)  G(342) = AE(M)(1,1)
!     G(351) = M(M)_Hu^2   G(352) = M(M)_Hd^2   G(353) = MQ(M)(1,1)
!     G(362) = ML(M)(1,1)  G(371) = MUP(M)(1,1) G(380) = MD(M)(1,1)
!     G(389) = ME(M)(1,1)  G(398) = mu(M)       G(399) = b(M)
!
!     G(400) = TRI_U(1,1)  G(409) = TRI_D(1,1)  G(418) = TRI_E(1,1)
!     G(427) = M_HUD       G(428) = VEV_SM      G(429) = LAM_SM
!
!     G(430) = MTSF_U(1,1) G(439) = MTSF_D(1,1) G(448) = MTSF_E(1,1)
!     G(457) = GLP         G(458) = G2L         G(459) = G3L
!     G(460) = FUHU(1,1)   G(469) = FDHD(1,1)   G(478) = FEHD(1,1)
!     G(487) = FUQ(1,1)    G(496) = FUUR(1,1)   G(505) = FDQ(1,1)
!     G(514) = FDDR(1.1)   G(523) = FEL(1,1)    G(532) = FEER(1,1)
!     G(541) = GLP*RT(C^2-S^2)      G(542) = G2L*RT(C^2-S^2)
!     G(543) = GLP*(C^2-S^2)        G(544) = G2L*(C^2-S^2)
!     G(545) = sFUQ(1,1)  G(554) = sFUUR(1,1)   G(563) = cFDQ(1,1)
!     G(572) = cFDDR(1.1) G(581) = cFEL(1,1)    G(590) = cFEER(1,1)
!     G(599) = M'_1       G(600) = M'_2         G(601) = M'_3
!
!NOTE: MQ, MU, ETC... ARE USED TO DENOTE *SQUARED* SOFT MASSES
!NOTE: BOTH G(31-33) AND G(599-601) SHOULD BE REAL. THEY ARE DEFINED
!      AS COMPLEX FOR EASE OF USE. ALSO, THE MSSM GAUGINO MASS TERMS
!      ARE MV NOTATION, ie M-iM'
!NOTE: FOR THE QUARTIC MATRICES, THE VALUES IN G ARE NOT READ FROM
!      OR WRITTEN TO BY THIS PROGRAMME. THE FINAL NUMBERS FOR THESE
!      ENTRIES IN G SHOULD BE IGNORED. IN ADDITION, IN THE CASE THAT
!      THIS CODE IS EXTENDED TO INCLUDE QUARTIC RUNNING SINCE IT IS
!      EXPECTED THAT QUARTIC RGES WILL ONLY BE DERIVABLE FOR THE
!      SQUARE OF THE TERMS ABOVE. EG FUQ*FUQ.
!
!This is the BT version which receives G in book notation
!
      IMPLICIT NONE
!
      COMMON/MYSUGRA/M0,M12,A0,TANB,SIGNMU,MT
      DOUBLE PRECISION M0,M12,A0,TANB,SIGNMU,MT
      SAVE/MYSUGRA/
!
      COMMON/LOOPS/SSQSTEP,SW2LP
      DOUBLE PRECISION SSQSTEP
      INTEGER SW2LP
      SAVE/LOOPS/
!
      COMMON/THRESH/QTHSORT,QTHQL,QTHUR,QTHDR,QTHLL,QTHER,QNSH,QNSG,
     $              QNH,QTHSB,QTHSW,EPS,LOCMH
      DOUBLE PRECISION QTHSORT(20),QTHQL(3),QTHUR(3),QTHDR(3),QTHLL(3),
     $                QTHER(3),QNSH,QNSG,QNH,QTHSB,QTHSW,EPS
                                     !EPSILON IS USED WHEN Q=THRESHOLD
      INTEGER LOCMH
      SAVE/THRESH/
!
      COMMON/DEC/NEWTH,ISADEC,BELOW,NSTEPTHRESH,NLTMT,
     $           THSQ,THSU,THSD,THSL,THSE
      DOUBLE PRECISION NEWTH(20)
      INTEGER ISADEC,BELOW(20),NSTEPTHRESH(19),NLTMT
      INTEGER THSQ(3),THSU(3),THSD(3),THSL(3),THSE(3)
      SAVE/DEC/
!
      COMMON /SQROT/ RQTOT,RUPTOT,RDTOT,RLTOT,RETOT
     $               ,RQSAV,RUPSAV,RDSAV,RLSAV,RESAV
     $               ,OLDNSQ,OLDNSU,OLDNSD,OLDNSL,OLDNSE
      DOUBLE COMPLEX RQTOT(3,3),RUPTOT(3,3),RDTOT(3,3)
      DOUBLE COMPLEX RLTOT(3,3),RETOT(3,3)
      DOUBLE COMPLEX RQSAV(2,3,3),RUPSAV(2,3,3),RDSAV(2,3,3)
      DOUBLE COMPLEX RLSAV(2,3,3),RESAV(2,3,3)
      INTEGER OLDNSQ,OLDNSU,OLDNSD,OLDNSL,OLDNSE
      SAVE /SQROT/
!
      DOUBLE PRECISION T
      DOUBLE COMPLEX G(601),GCURR(601)
      DOUBLE COMPLEX F(601),FCURR(601)
!
      DOUBLE COMPLEX FU(3,3),FD(3,3),FE(3,3)
      DOUBLE COMPLEX YU(3,3),YD(3,3),YE(3,3)
      DOUBLE COMPLEX AU(3,3),AD(3,3),AE(3,3)
      DOUBLE COMPLEX HU(3,3),HD(3,3),HE(3,3),DH(3,3,3)
      DOUBLE COMPLEX MQ(3,3),ML(3,3),MUP(3,3),MD(3,3),ME(3,3)
      DOUBLE COMPLEX MQM(3,3),MLM(3,3),MUPM(3,3),MDM(3,3),MEM(3,3)
      DOUBLE COMPLEX DM(5,3,3)
      DOUBLE COMPLEX LU(3,3),LD(3,3),LE(3,3)
      DOUBLE COMPLEX LYU(3,3),LYD(3,3),LYE(3,3)
      DOUBLE COMPLEX GTPQ(3,3),GTPL(3,3),GTPU(3,3),GTPD(3,3),GTPE(3,3)
      DOUBLE COMPLEX GTQ(3,3),GTL(3,3)
      DOUBLE COMPLEX GTSQ(3,3),GTSU(3,3),GTSD(3,3)
      DOUBLE COMPLEX FTUQ(3,3),FTDQ(3,3),FTEL(3,3)
      DOUBLE COMPLEX FTUU(3,3),FTDD(3,3),FTEE(3,3)
!
      DOUBLE COMPLEX TRIU(3,3),TRID(3,3),TRIE(3,3)
      DOUBLE COMPLEX MTSFU(3,3),MTSFD(3,3),MTSFE(3,3)
      DOUBLE COMPLEX FUHU(3,3),FDHD(3,3),FEHD(3,3)
      DOUBLE COMPLEX FUQ(3,3),FUUR(3,3)
      DOUBLE COMPLEX FDQ(3,3),FDDR(3,3)
      DOUBLE COMPLEX FEL(3,3),FEER(3,3)
      DOUBLE COMPLEX SFUQ(3,3),CFDQ(3,3),SFUUR(3,3)
      DOUBLE COMPLEX CFDDR(3,3),CFEL(3,3),CFEER(3,3)
!
      DOUBLE COMPLEX CMATMUL,CSFMUL,CTRACE,TCSFMUL,SUM
      DOUBLE COMPLEX CMODSQ,CCON,CRE
!
!These are used in the calculation of the RGEs which contain
!thresholds
!
      DOUBLE COMPLEX DUMU1(3,3),DUMU2(3,3),DUMD1(3,3),DUMD2(3,3)
      DOUBLE COMPLEX DUME1(3,3),DUME2(3,3)
      DOUBLE COMPLEX DUMM1(3,3),TDUMM1,DUMM2(3,3),TDUMM2,DUMM3(3,3)
      DOUBLE COMPLEX TDUMM3,DUMGRKMU1(3,3),TDUMGRKMU
      DOUBLE COMPLEX DUMTUQ1(3,3),DUMTUQ2(3,3),DUMTUQ3(3,3),TDUMTUQ2
      DOUBLE COMPLEX DUMTUQ4(3,3),DUMTUQ5(3,3),DUMTDQ1(3,3),DUMTDQ2(3,3)
      DOUBLE COMPLEX TDUMTDQ2,DUMTDQ3(3,3),DUMTDQ4(3,3),DUMTDQ5(3,3)
      DOUBLE COMPLEX DUMTEL1(3,3),TDUMTEL2,DUMTEL3(3,3),DUMTEL4(3,3)
      DOUBLE COMPLEX DUMTEL5(3,3),TDUMTUU1,DUMTUU2(3,3),DUMTUU3(3,3)
      DOUBLE COMPLEX DUMTUU4(3,3),TDUMTDD1,DUMTDD2(3,3),DUMTDD3(3,3)
      DOUBLE COMPLEX DUMTDD4(3,3),TDUMTEE1,DUMTEE3(3,3)
      DOUBLE COMPLEX DUMTQ1(3,3),TDUMTQ1,DUMTQ2(3,3),DUMTQ3(3,3)
      DOUBLE COMPLEX DUMTQ4(3,3),DUMTQ5(3,3),TDUMTL1,DUMTL2(3,3)
      DOUBLE COMPLEX DUMTL3(3,3),DUMTPQ1(3,3),TDUMTPQ1,DUMTPQ2(3,3)
      DOUBLE COMPLEX DUMTPQ3(3,3),DUMTPQ4(3,3),DUMTPQ5(3,3),TDUMTPL1
      DOUBLE COMPLEX DUMTPL2(3,3),DUMTPL3(3,3),DUMTPU1(3,3),TDUMTPU2
      DOUBLE COMPLEX DUMTPU3(3,3),DUMTPD1(3,3),TDUMTPD2,DUMTPD3(3,3)
      DOUBLE COMPLEX DUMTPE1(3,3),TDUMTPE2
      DOUBLE COMPLEX DUMTSQ1(3,3),TDUMTSQ1,DUMTSQ2(3,3),DUMTSQ3(3,3)
      DOUBLE COMPLEX DUMTSQ4(3,3),DUMTSQ5(3,3),DUMTSU1(3,3),TDUMTSU2
      DOUBLE COMPLEX DUMTSU3(3,3),TDUMTSU3,DUMTSU4(3,3),DUMTSD1(3,3)
      DOUBLE COMPLEX TDUMTSD2,TDUMTSD3,DUMTSD4(3,3)
      DOUBLE COMPLEX DUMGTHU1(3,3),TDUMGTHU1,DUMGTHD1(3,3),TDUMGTHD1
      DOUBLE COMPLEX DUMGTPHU1(3,3),TDUMGTPHU1,DUMGTPHU2(3,3),TDUMGTPHU2
      DOUBLE COMPLEX DUMGTPHD1(3,3),TDUMGTPHD1,DUMGTPHD2(3,3),TDUMGTPHD2
      DOUBLE COMPLEX DUMLUD1(3,3),DUMLUD2(3,3),DUMLUD(3,3),TDUMLUD
      DOUBLE COMPLEX DUMMTSFU1(3,3),DUMMTSFU2(3,3),DUMMTSFU3(3,3)
      DOUBLE COMPLEX DUMMTSFD1(3,3),DUMMTSFD2(3,3),DUMMTSFD3(3,3)
      DOUBLE COMPLEX DUMMTSFE1(3,3),DUMMTSFE2(3,3),DUMMTSFE3(3,3)
!
      DOUBLE COMPLEX FUS(3,3),FDS(3,3),FES(3,3)
      DOUBLE COMPLEX FUT(3,3),FDT(3,3),FET(3,3)
      DOUBLE COMPLEX LUS(3,3),LDS(3,3),LES(3,3)
      DOUBLE COMPLEX LUT(3,3),LDT(3,3),LET(3,3)
      DOUBLE COMPLEX AUS(3,3),ADS(3,3),AES(3,3)
      DOUBLE COMPLEX AUT(3,3),ADT(3,3),AET(3,3)
      DOUBLE COMPLEX FTUQS(3,3),FTUQT(3,3),FTUQD(3,3),FTUUD(3,3)
      DOUBLE COMPLEX FTUUS(3,3),FTUUT(3,3),FTDQS(3,3),FTDQT(3,3)
      DOUBLE COMPLEX FTDDD(3,3),FTDDS(3,3),FTDDT(3,3),FTDQD(3,3)
      DOUBLE COMPLEX FTELD(3,3),FTELS(3,3),FTELT(3,3),FTEED(3,3)
      DOUBLE COMPLEX FTEES(3,3),FTEET(3,3),GTQD(3,3),GTLD(3,3)
      DOUBLE COMPLEX GTPQD(3,3),GTSQD(3,3),GTPUD(3,3),GTPDD(3,3)
      DOUBLE COMPLEX GTPED(3,3),GTPLD(3,3),GTSUD(3,3),GTSDD(3,3)
      DOUBLE COMPLEX GTPUS(3,3),GTSUS(3,3),GTQS(3,3),GTLS(3,3)
      DOUBLE COMPLEX GTPQS(3,3),GTPLS(3,3),GTSQS(3,3),GTPDS(3,3)
      DOUBLE COMPLEX GTPES(3,3),GTSDS(3,3),GTPUT(3,3),GTQT(3,3)
      DOUBLE COMPLEX GTLT(3,3),GTPQT(3,3),GTPLT(3,3),GTPDT(3,3)
      DOUBLE COMPLEX GTPET(3,3),GTSUT(3,3),GTSQT(3,3),GTSDT(3,3)
      DOUBLE COMPLEX FUHUD(3,3),FDHDD(3,3),FEHDD(3,3)
      DOUBLE COMPLEX MTSFUS(3,3),MTSFDS(3,3),MTSFES(3,3)
      DOUBLE COMPLEX MTSFUT(3,3),MTSFDT(3,3),MTSFET(3,3)
      DOUBLE COMPLEX FUHUS(3,3),FDHDS(3,3),FEHDS(3,3)
      DOUBLE COMPLEX TRIUS(3,3),TRIDS(3,3),TRIES(3,3)
      DOUBLE COMPLEX FUHUT(3,3),FDHDT(3,3),FEHDT(3,3)
      DOUBLE COMPLEX TRIUT(3,3),TRIDT(3,3),TRIET(3,3)
!
      DOUBLE COMPLEX FUFUD(3,3),FDFDD(3,3),FEFED(3,3)
      DOUBLE COMPLEX YUDYU(3,3),YDDYD(3,3),YEDYE(3,3)
      DOUBLE COMPLEX LULUD(3,3),LDLDD(3,3),LELED(3,3)
      DOUBLE COMPLEX LUDLU(3,3),LDDLD(3,3),LEDLE(3,3)
      DOUBLE COMPLEX LYUDLYU(3,3),LYDDLYD(3,3),LYEDLYE(3,3)
      DOUBLE COMPLEX LYUDLYU2(3,3),LYDDLYD2(3,3),LYEDLYE2(3,3)
      DOUBLE COMPLEX LYUDLYU3(3,3),LYDDLYD3(3,3),LYEDLYE3(3,3)
      DOUBLE COMPLEX TLYUDLYU,TLYDDLYD,TLYEDLYE
      DOUBLE COMPLEX TLYUDLYU2,TLYDDLYD2,TLYEDLYE2
      DOUBLE COMPLEX TLYUDLYU3,TLYDDLYD3,TLYEDLYE3
      DOUBLE COMPLEX LYUDLYULYDDLYD(3,3),LYDDLYDLYUDLYU(3,3)
      DOUBLE COMPLEX TLYUDLYULYDDLYD
      DOUBLE COMPLEX FUDFU(3,3),FDDFD(3,3),FEDFE(3,3)
      DOUBLE COMPLEX YUYUD(3,3),YDYDD(3,3),YEYED(3,3)
      DOUBLE COMPLEX YUYDD(3,3),YDYUD(3,3)
      DOUBLE COMPLEX FUGTPUS(3,3),FDGTPDS(3,3),FEGTPES(3,3)
      DOUBLE COMPLEX FUGTSUS(3,3),FDGTSDS(3,3)
      DOUBLE COMPLEX LUGTPUS(3,3),LDGTPDS(3,3),LEGTPES(3,3)
      DOUBLE COMPLEX LUGTSUS(3,3),LDGTSDS(3,3)
      DOUBLE COMPLEX FTUQFTUQD(3,3),FTUQSFTUQT(3,3),FTUQSFUT(3,3)
      DOUBLE COMPLEX FTUQSLUT(3,3)
      DOUBLE COMPLEX FTDQFTDQD(3,3),FTDQSFTDQT(3,3),FTDQSFDT(3,3)
      DOUBLE COMPLEX FTDQSLDT(3,3)
      DOUBLE COMPLEX FTELFTELD(3,3),FTELSFTELT(3,3),FTELSFET(3,3)
      DOUBLE COMPLEX FTELSLET(3,3)
      DOUBLE COMPLEX GTQSGTQT(3,3),GTQGTQD(3,3),GTPQSGTPQT(3,3)
      DOUBLE COMPLEX GTPQGTPQD(3,3),GTPUTGTPUS(3,3),GTPUDGTPU(3,3)
      DOUBLE COMPLEX GTPDDGTPD(3,3),GTPDTGTPDS(3,3),GTSQSGTSQT(3,3)
      DOUBLE COMPLEX GTSQGTSQD(3,3),GTSUTGTSUS(3,3),GTSUDGTSU(3,3)
      DOUBLE COMPLEX GTSDDGTSD(3,3),GTSDTGTSDS(3,3),GTLSGTLT(3,3)
      DOUBLE COMPLEX GTLGTLD(3,3),GTPLSGTPLT(3,3),GTPLGTPLD(3,3)
      DOUBLE COMPLEX GTPETGTPES(3,3),GTPEDGTPE(3,3)
      DOUBLE COMPLEX FDDRFDDRD(3,3),FDQDFUQ(3,3),FTUQGTPUS(3,3)
      DOUBLE COMPLEX FTDQGTPDS(3,3),FTELGTPES(3,3),FTUQFUDFTDD(3,3)
      DOUBLE COMPLEX FTDQFDDFTUU(3,3),FTDQLDDFTUU(3,3),FTUQLUDFTDD(3,3)
      DOUBLE COMPLEX FUURFUURD(3,3),FUQDFDQ(3,3)
      DOUBLE COMPLEX FUQDFUQ(3,3),FDQDFDQ(3,3)
      DOUBLE COMPLEX FUQTFUQS(3,3),FUURSFUURT(3,3)
      DOUBLE COMPLEX FDQTFDQS(3,3),FDDRSFDDRT(3,3),FELTFELS(3,3)
      DOUBLE COMPLEX FEERSFEERT(3,3)
      DOUBLE COMPLEX GTPQSFTUU(3,3),GTQSFTUU(3,3),FDDFTUU(3,3)
      DOUBLE COMPLEX LUDFTDD(3,3),LDDFTUU(3,3)
      DOUBLE COMPLEX FUDFTDD(3,3),FEERFEERD(3,3),FELDFEL(3,3)
      DOUBLE COMPLEX FTUUDFTUU(3,3),FTDDDFTDD(3,3),FTEEDFTEE(3,3)
      DOUBLE COMPLEX GTPQSFTDD(3,3),GTQSFTDD(3,3)
      DOUBLE COMPLEX GTPLSFTEE(3,3),GTLSFTEE(3,3)
      DOUBLE COMPLEX FUSFUT(3,3),FDSFDT(3,3),FESFET(3,3)
      DOUBLE COMPLEX LUSLUT(3,3),LDSLDT(3,3),LESLET(3,3)
      DOUBLE COMPLEX FUTFUS(3,3),FDTFDS(3,3),FETFES(3,3)
      DOUBLE COMPLEX LUTLUS(3,3),LDTLDS(3,3),LETLES(3,3)
      DOUBLE COMPLEX FUTFTUUS(3,3),FDTFTDDS(3,3),FETFTEES(3,3)
      DOUBLE COMPLEX LUTFTUUS(3,3),LDTFTDDS(3,3),LETFTEES(3,3)
      DOUBLE COMPLEX TFUDFU,TFDDFD,TFEDFE
      DOUBLE COMPLEX TYUDYU,TYDDYD,TYEDYE
      DOUBLE COMPLEX TLUDLU,TLDDLD,TLEDLE
      DOUBLE COMPLEX FUFUDFU(3,3),FUFUDFD(3,3),FUTFUSGTPU(3,3)
      DOUBLE COMPLEX LUTLUSGTPU(3,3)
      DOUBLE COMPLEX FUTFUSGTSU(3,3),LUTLUSGTSU(3,3)
      DOUBLE COMPLEX FDTFDSGTSD(3,3),LDTLDSGTSD(3,3)
      DOUBLE COMPLEX FDFDDFU(3,3)
      DOUBLE COMPLEX FDTFDSGTPD(3,3),LDTLDSGTPD(3,3)
      DOUBLE COMPLEX FDFDDFD(3,3),FEFEDFE(3,3)
      DOUBLE COMPLEX FETFESGTPE(3,3),LETLESGTPE(3,3)
      DOUBLE COMPLEX LULUDLU(3,3),LULUDLD(3,3),LDLDDLU(3,3)
      DOUBLE COMPLEX LDLDDLD(3,3),LELEDLE(3,3)
      DOUBLE COMPLEX FTUQFUDFU(3,3),FTDQFDDFD(3,3),FTELFEDFE(3,3)
      DOUBLE COMPLEX FTUQLUDLU(3,3),FTDQLDDLD(3,3),FTELLEDLE(3,3)
      DOUBLE COMPLEX SQFTUQDFTUQ(3,3),SQFTUQTFTUQS(3,3),SQFTUQTGTQ(3,3)
      DOUBLE COMPLEX SQFTUQTGTPQ(3,3),SQFTUQTGTSQ(3,3),SQFTDQDFTDQ(3,3)
      DOUBLE COMPLEX SQFTDQTFTDQS(3,3),SQFTDQTGTPQ(3,3),SQFTDQTGTQ(3,3)
      DOUBLE COMPLEX SQFTDQTGTSQ(3,3),SQGTQTGTQS(3,3),SQGTQTFTUQ(3,3)
      DOUBLE COMPLEX SQGTQTFTDQ(3,3),SQGTQDGTQ(3,3),SQGTPQTGTPQS(3,3)
      DOUBLE COMPLEX SQGTPQTFTUQ(3,3),SQGTPQTFTDQ(3,3),SQGTPQDGTPQ(3,3)
      DOUBLE COMPLEX SQGTSQTGTSQS(3,3),SQGTSQTFTUQ(3,3),SQGTSQTFTDQ(3,3)
      DOUBLE COMPLEX SQGTSQDGTSQ(3,3),SQIDMTSFU(3,3),SQIDMTSFD(3,3)
      DOUBLE COMPLEX SQFUHUDMTSFU(3,3),SQFDHDDMTSFD(3,3)
      DOUBLE COMPLEX SUGTPUFTUUT(3,3),SUGTPUGTPUD(3,3)
      DOUBLE COMPLEX SUGTPUSGTPUT(3,3),SUGTSUGTSUD(3,3)
      DOUBLE COMPLEX SUGTSUSGTSUT(3,3),SUGTSUFTUUT(3,3),SUFTUUFTUUD(3,3)
      DOUBLE COMPLEX SUFTUUGTPUT(3,3),SUFTUUSFTUUT(3,3),SUFTUUGTSUT(3,3)
      DOUBLE COMPLEX SUMTSFUID(3,3),SUSQIDMTSFUID(3,3)
      DOUBLE COMPLEX SUMTSFUFUQDFDQ(3,3)
      DOUBLE COMPLEX SDFTDDFTDDD(3,3),SDFTDDSFTDDT(3,3),SDFTDDGTPDT(3,3)
      DOUBLE COMPLEX SDFTDDGTSDT(3,3),SDGTPDFTDDT(3,3),SDGTPDSGTPDT(3,3)
      DOUBLE COMPLEX SDGTPDGTPDD(3,3),SDGTSDGTSDD(3,3),SDGTSDSGTSDT(3,3)
      DOUBLE COMPLEX SDGTSDFTDDT(3,3),SDMTSFDFDQDFUQ(3,3)
      DOUBLE COMPLEX SDMTSFDID(3,3),SDSQIDMTSFDID(3,3)
      DOUBLE COMPLEX SLFTELDFTEL(3,3),SLFTELTFTELS(3,3)
      DOUBLE COMPLEX SLFTELTGTL(3,3),SLFTELTGTPL(3,3),SLGTLTGTLS(3,3)
      DOUBLE COMPLEX SLGTLTFTEL(3,3),SLGTLDGTL(3,3),SLGTPLTGTPLS(3,3)
      DOUBLE COMPLEX SLGTPLDGTPL(3,3),SLGTPLTFTEL(3,3),SLFEHDDMTSFE(3,3)
      DOUBLE COMPLEX SLIDMTSFE(3,3)
      DOUBLE COMPLEX SEGTPESGTPET(3,3)
      DOUBLE COMPLEX SEGTPEGTPED(3,3),SEGTPEFTEET(3,3),SEFTEEFTEED(3,3)
      DOUBLE COMPLEX SEFTEESFTEET(3,3),SEFTEEGTPET(3,3),SEMTSFEID(3,3)
      DOUBLE COMPLEX SESLIDMTSFEID(3,3)
      DOUBLE COMPLEX TFUSFUT,TFDSFDT,TFESFET,TLUSLUT,TLDSLDT,TLESLET
      DOUBLE COMPLEX TSQGTQDGTQ,TSLGTLDGTL,TSUFTUUFTUUD,TSDFTDDFTDDD
      DOUBLE COMPLEX TSEFTEEFTEED,TSQFTUQDFTUQ,TSQFTDQDFTDQ
      DOUBLE COMPLEX TSLFTELDFTEL,TSQGTPQDGTPQ,TSLGTPLDGTPL
      DOUBLE COMPLEX TSDGTPDGTPDD,TSUGTPUGTPUD,TSEGTPEGTPED
      DOUBLE COMPLEX SUTSQFUHUDMTSFU,SDTSQFDHDDMTSFD
      DOUBLE COMPLEX SETSLFEHDDMTSFE
      DOUBLE COMPLEX SQTSUMTSFUSAUT,SUMTSFUSAUT(3,3)
      DOUBLE COMPLEX SQTSDMTSFDSADT,SDMTSFDSADT(3,3)
      DOUBLE COMPLEX SLTSEMTSFESAET,SEMTSFESAET(3,3)
      DOUBLE COMPLEX MGTPHUSQ,MGTPHDSQ,MGTHUSQ,MGTHDSQ
      DOUBLE COMPLEX MSGTPHUSQ,MCGTPHDSQ,MSGTHUSQ,MCGTHDSQ
      DOUBLE COMPLEX MMUSQ,M1PM1PSQ,M2PM2PSQ,M3PM3PSQ
      DOUBLE COMPLEX Y2,H,Y4,CHI4
!
      DOUBLE COMPLEX SUAUID(3,3),SUAUFUQDFUQ(3,3),SUSQIDAUID(3,3)
      DOUBLE COMPLEX SQIDAU(3,3),SUTSQFUHUDAU,SQFUHUDAU(3,3)
      DOUBLE COMPLEX SQFUURFUURDAU(3,3),GTPQSFUGTPUS(3,3)
      DOUBLE COMPLEX SDADFDQDFUQ(3,3),GTSQSFUGTSUS(3,3)
      DOUBLE COMPLEX SQIDAD(3,3),SQFDDRFDDRDAD(3,3),SDSQIDADID(3,3)
      DOUBLE COMPLEX SDTSQFDHDDAD,SQFDHDDAD(3,3)
      DOUBLE COMPLEX SETSLFEHDDAE,SLFEHDDAE(3,3),SDADID(3,3)
      DOUBLE COMPLEX SDADFDQDFDQ(3,3),GTPQSFDGTPDS(3,3)
      DOUBLE COMPLEX GTSQSFDGTSDS(3,3),SUAUFUQDFDQ(3,3)
      DOUBLE COMPLEX SLIDAE(3,3),SLFEERFEERDAE(3,3),SEAEID(3,3)
      DOUBLE COMPLEX SESLIDAEID(3,3),SEAEFELDFEL(3,3)
      DOUBLE COMPLEX GTPLSFEGTPES(3,3)
!
      DOUBLE COMPLEX SFUQDSFUQ(3,3),SFUURSFUURD(3,3),CFDDRCFDDRD(3,3)
      DOUBLE COMPLEX CFDQDSFUQ(3,3),CFDQDCFDQ(3,3)
      DOUBLE COMPLEX SFUQDCFDQ(3,3),CFEERCFEERD(3,3)
      DOUBLE COMPLEX CFELDCFEL(3,3)
      DOUBLE COMPLEX SUTRIUID(3,3),SUTRIUSFUQDSFUQ(3,3),SQIDTRIU(3,3)
      DOUBLE COMPLEX SUSQIDTRIUID(3,3),SUTSQFUHUDTRIU,SQFUHUDTRIU(3,3)
      DOUBLE COMPLEX SQSFUURSFUURDTRIU(3,3),SQCFDDRCFDDRDTRIU(3,3)
      DOUBLE COMPLEX GTPQSLUGTPUS(3,3),GTSQSLUGTSUS(3,3)
      DOUBLE COMPLEX SQIDTRID(3,3),SQSFUURSFUURDTRID(3,3)
      DOUBLE COMPLEX SQCFDDRCFDDRDTRID(3,3),SDSQIDTRIDID(3,3)
      DOUBLE COMPLEX SDTSQFDHDDTRID,SQFDHDDTRID(3,3)
      DOUBLE COMPLEX SETSLFEHDDTRIE,SLFEHDDTRIE(3,3),SDTRIDID(3,3)
      DOUBLE COMPLEX SDTRIDCFDQDCFDQ(3,3)
      DOUBLE COMPLEX GTPQSLDGTPDS(3,3),GTSQSLDGTSDS(3,3)
      DOUBLE COMPLEX SLIDTRIE(3,3),SLCFEERCFEERDTRIE(3,3)
      DOUBLE COMPLEX SESLIDTRIEID(3,3),SETRIEID(3,3)
      DOUBLE COMPLEX SETRIECFELDCFEL(3,3),GTPLSLEGTPES(3,3)
!
      DOUBLE COMPLEX SUTSUIDMU,SUIDMU(3,3),SUTSUFUQTFUQSMU
      DOUBLE COMPLEX SUFUQTFUQSMU(3,3),SQTSQIDMQ,SQIDMQ(3,3)
      DOUBLE COMPLEX SQTSQFUURSFUURTMQ,SQFUURSFUURTMQ(3,3)
      DOUBLE COMPLEX SDTSDIDMD,SDIDMD(3,3),SLTSLIDML,SLIDML(3,3)
      DOUBLE COMPLEX SETSEIDME,SEIDME(3,3),SQTSUAUSAUT,SUAUSAUT(3,3)
      DOUBLE COMPLEX SQTSDMTSFDSMTSFDT,SDMTSFDSMTSFDT(3,3)
      DOUBLE COMPLEX SLTSEMTSFESMTSFET,SEMTSFESMTSFET(3,3)
      DOUBLE COMPLEX SQTSQFDDRSFDDRTMQ,SQFDDRSFDDRTMQ(3,3)
      DOUBLE COMPLEX SDTSDFDQTFDQSMD,SDFDQTFDQSMD(3,3)
      DOUBLE COMPLEX SLTSLFEERSFEERTML,SLFEERSFEERTML(3,3)
      DOUBLE COMPLEX SETSEFELTFELSME,SEFELTFELSME(3,3)
      DOUBLE COMPLEX SQTSUMTSFUSMTSFUT,SUMTSFUSMTSFUT(3,3)
      DOUBLE COMPLEX SQTSDADSADT,SDADSADT(3,3),SLTSEAESAET,SEAESAET(3,3)
!
      DOUBLE COMPLEX SUTSUSFUQTSFUQSMU,SUSFUQTSFUQSMU(3,3)
      DOUBLE COMPLEX SFUQTSFUQS(3,3),SQTSQSFUURSSFUURTMQ
      DOUBLE COMPLEX SQSFUURSSFUURTMQ(3,3),SFUURSSFUURT(3,3)
      DOUBLE COMPLEX SQTSQCFDDRSCFDDRTMQ,SQCFDDRSCFDDRTMQ(3,3)
      DOUBLE COMPLEX CFDDRSCFDDRT(3,3),SDTSDCFDQTCFDQSMD
      DOUBLE COMPLEX SDCFDQTCFDQSMD(3,3),CFDQTCFDQS(3,3)
      DOUBLE COMPLEX SLTSLCFEERSCFEERTML,SLCFEERSCFEERTML(3,3)
      DOUBLE COMPLEX CFEERSCFEERT(3,3),SETSECFELTCFELSME
      DOUBLE COMPLEX SECFELTCFELSME(3,3),CFELTCFELS(3,3)
      DOUBLE COMPLEX SQTSUTRIUTRIUD,SUTRIUTRIUD(3,3),TRIUD(3,3)
      DOUBLE COMPLEX SQTSDTRIDTRIDD,SDTRIDTRIDD(3,3),TRIDD(3,3)
      DOUBLE COMPLEX SLTSETRIETRIED,SETRIETRIED(3,3),TRIED(3,3)
!
      DOUBLE COMPLEX SUTMU,SQTMQ,SDTMD,SLTML,SETME
      DOUBLE COMPLEX SQSQIDMQID(3,3)
      DOUBLE COMPLEX SUSUFUHUSMUFUHUT(3,3),SUFUHUSMU(3,3)
      DOUBLE COMPLEX SDSDFDHDSMDFDHDT(3,3),SDFDHDSMD(3,3)
      DOUBLE COMPLEX SUTRIUSTRIUT(3,3),SDTRIDSTRIDT(3,3)
      DOUBLE COMPLEX SUSUIDMUID(3,3),SQSQFUHUTMQFUHUS(3,3)
      DOUBLE COMPLEX SQFUHUTMQ(3,3),SQAUTAUS(3,3),SQMTSFUTMTSFUS(3,3)
      DOUBLE COMPLEX SQTRIUTTRIUS(3,3),FTUUTFTUUS(3,3)
      DOUBLE COMPLEX SDSDIDMDID(3,3)
      DOUBLE COMPLEX SQSQFDHDTMQFDHDS(3,3),SQFDHDTMQ(3,3),SQADTADS(3,3)
      DOUBLE COMPLEX SQMTSFDTMTSFDS(3,3),FTDDTFTDDS(3,3)
      DOUBLE COMPLEX SQTRIDTTRIDS(3,3),SLSLIDMLID(3,3)
      DOUBLE COMPLEX SEFEHDSME(3,3),SESEFEHDSMEFEHDT(3,3)
      DOUBLE COMPLEX SETRIESTRIET(3,3)
      DOUBLE COMPLEX SESEIDMEID(3,3),SLSLFEHDTMLFEHDS(3,3)
      DOUBLE COMPLEX SLFEHDTML(3,3)
      DOUBLE COMPLEX SLAETAES(3,3),SLMTSFETMTSFES(3,3),FTEETFTEES(3,3)
      DOUBLE COMPLEX SLTRIETTRIES(3,3)
!
      DOUBLE COMPLEX B1U(3,3),B1D(3,3),B1E(3,3)
      DOUBLE COMPLEX BFTUQ(3,3),BFTDQ(3,3),BFTEL(3,3)
      DOUBLE COMPLEX BFTUU(3,3),BFTDD(3,3),BFTEE(3,3)
      DOUBLE COMPLEX BGTQ(3,3),BGTL(3,3),BGTPQ(3,3),BGTPL(3,3)
      DOUBLE COMPLEX BGTPU(3,3),BGTPD(3,3),BGTPE(3,3)
      DOUBLE COMPLEX BGTSQ(3,3),BGTSU(3,3),BGTSD(3,3)
      DOUBLE COMPLEX BGRKMU,BM(3),BMP(3),BGTHU,BGTHD,BGTPHU,BGTPHD
      DOUBLE COMPLEX BSGTHU,BCGTHD,BSGTPHU,BCGTPHD,BETALAM1,BETALAM2
      DOUBLE COMPLEX BMTSFU(3,3),BMTSFD(3,3),BMTSFE(3,3)
      DOUBLE COMPLEX BMHUPMT,BMHDPMT,BMHUD
!
!The following are for two loop and soft RGEs
!
      DOUBLE COMPLEX S,SP,SIG1,SIG2,SIG3
      DOUBLE COMPLEX DUM2U11(3,3),DUM2U12(3,3),DUM2U21(3,3)
      DOUBLE COMPLEX DUM2U22(3,3),DUM2U23(3,3),DUM1D11(3,3)
      DOUBLE COMPLEX DUM1D12(3,3),DUM2D11(3,3),DUM2D12(3,3)
      DOUBLE COMPLEX DUM2D21(3,3),DUM2D22(3,3),DUM2D23(3,3)
      DOUBLE COMPLEX DUM1E11(3,3),DUM1E21(3,3),DUM2E11(3,3)
      DOUBLE COMPLEX DUM2E12(3,3),DUM2E21(3,3),DUM2E22(3,3)
      DOUBLE COMPLEX DUM2E23(3,3)
      DOUBLE COMPLEX DUM1U1(3,3),DUM1U2(3,3),DUM2U1(3,3),DUM2U2(3,3)
      DOUBLE COMPLEX DUM1D1(3,3),DUM1D2(3,3),DUM2D1(3,3),DUM2D2(3,3)
      DOUBLE COMPLEX DUM1E1(3,3),DUM1E2(3,3),DUM2E1(3,3),DUM2E2(3,3)
      DOUBLE COMPLEX DUM1U(3,3),DUM2U(3,3),DUM1D(3,3),DUM2D(3,3)
      DOUBLE COMPLEX DUM1E(3,3),DUM2E(3,3)
      DOUBLE COMPLEX DUMS(3,3),DUMSP1(3,3),DUMSP2(3,3),DUMSP3(3,3)
      DOUBLE COMPLEX DUMSIG1(3,3),DUMSIG2(3,3),DUMSIG3(3,3)
      DOUBLE COMPLEX DUM1HU1(3,3)
      DOUBLE COMPLEX DUMSP(3,3)
      DOUBLE COMPLEX DUM2HU11(3,3),DUM2HU12(3,3),DUM2HU21(3,3)
      DOUBLE COMPLEX DUM2HD11(3,3)
      DOUBLE COMPLEX DUM2HD12(3,3),DUM2HD13(3,3),DUM2HD21(3,3)
      DOUBLE COMPLEX DUM2HD31(3,3)
      DOUBLE COMPLEX DUM2HU1(3,3),DUM2HU2(3,3),DUM1HD1(3,3)
      DOUBLE COMPLEX DUM1HD2(3,3)
      DOUBLE COMPLEX DUM2HD1(3,3),DUM2HD2(3,3),DUM2HD3(3,3)
      DOUBLE COMPLEX DUM1HU(3,3),DUM1HD(3,3)
      DOUBLE COMPLEX DUM2Q31(3,3),DUM2Q41(3,3),DUM2L21(3,3)
      DOUBLE COMPLEX DUM2U31(3,3),DUM2D31(3,3)
      DOUBLE COMPLEX DUM1Q1(3,3),DUM1Q2(3,3),DUM1Q3(3,3),DUM2Q1(3,3)
      DOUBLE COMPLEX DUM2Q2(3,3),DUM2Q3(3,3),DUM2Q4(3,3),DUM2Q5(3,3)
      DOUBLE COMPLEX DUM2Q6(3,3),DUM2Q7(3,3),DUM2Q8(3,3),DUM2Q9(3,3)
      DOUBLE COMPLEX DUM2QA(3,3),DUM2QB(3,3),DUM2QC(3,3),DUM2QD(3,3)
      DOUBLE COMPLEX DUM1L1(3,3),DUM2L1(3,3),DUM2L2(3,3),DUM2L3(3,3)
      DOUBLE COMPLEX DUM2L4(3,3),DUM2L5(3,3),DUM2L6(3,3),DUM2L7(3,3)
      DOUBLE COMPLEX DUM2L8(3,3),DUM2L9(3,3),DUM2U3(3,3),DUM2U4(3,3)
      DOUBLE COMPLEX DUM2U5(3,3),DUM2D3(3,3),DUM2D4(3,3),DUM2D5(3,3)
      DOUBLE COMPLEX DUM2D6(3,3),DUM2D7(3,3),DUM2D8(3,3),DUM2D9(3,3)
      DOUBLE COMPLEX DUM2DA(3,3),DUM2E3(3,3),DUM2E4(3,3),DUM2E5(3,3)
      DOUBLE COMPLEX DUM2E6(3,3),DUM2E7(3,3),DUM2E8(3,3),DUM2E9(3,3)
      DOUBLE COMPLEX DUM1GRKMU(3,3),DUM2GRKMU(3,3),DUM1B1(3,3)
      DOUBLE COMPLEX DUM1B2(3,3)
      DOUBLE COMPLEX DUM2B1(3,3),DUM2B2(3,3)
!
      DOUBLE COMPLEX TYUDHU,TYDDHD,TYEDHE,THUYUD
      DOUBLE COMPLEX THDYDD,THEYED,THUDYU,THDDYD,THEDYE,THUDHU
      DOUBLE COMPLEX YUYUDYUYUD(3,3),YDYDDYDYDD(3,3)
      DOUBLE COMPLEX YEYEDYEYED(3,3),YUDYUYUDYU(3,3)
      DOUBLE COMPLEX YDDYDYDDYD(3,3),YEDYEYEDYE(3,3)
      DOUBLE COMPLEX YDDYDYUDYU(3,3),YUDYUYDDYD(3,3)
      DOUBLE COMPLEX YUYDDYDYUD(3,3),YDYUDYUYDD(3,3)
      DOUBLE COMPLEX HUYUD(3,3),HDYDD(3,3),HEYED(3,3)
      DOUBLE COMPLEX YUDHU(3,3),YDDHD(3,3),YEDHE(3,3)
      DOUBLE COMPLEX HUDHU(3,3),HDDHD(3,3),HEDHE(3,3)
      DOUBLE COMPLEX HUDYU(3,3),HDDYD(3,3),HEDYE(3,3)
      DOUBLE COMPLEX HUHUD(3,3),HDHDD(3,3),HEHED(3,3)
      DOUBLE COMPLEX YUHUD(3,3),YDHDD(3,3),YEHED(3,3)
      DOUBLE COMPLEX HUYDD(3,3),HDYUD(3,3),HUHDD(3,3)
      DOUBLE COMPLEX HDHUD(3,3),YDHUD(3,3),YUHDD(3,3)
      DOUBLE COMPLEX MUPMYU(3,3),MDMYD(3,3),MEMYE(3,3)
      DOUBLE COMPLEX YUMQM(3,3),YDMQM(3,3),YEMLM(3,3)
      DOUBLE COMPLEX YUDMUPMYU(3,3),YDDMDMYD(3,3),YEDMEMYE(3,3)
      DOUBLE COMPLEX YEDYEMLM(3,3),YUMQMYUD(3,3),YUYUDMUPM(3,3)
      DOUBLE COMPLEX YDMQMYDD(3,3),YDYDDMDM(3,3),YEMLMYED(3,3)
      DOUBLE COMPLEX YEYEDMEM(3,3),YUDYUMQM(3,3),YDDYDMQM(3,3)
      DOUBLE COMPLEX MQMYUDYU(3,3),MQMYDDYD(3,3),MLMYEDYE(3,3)
      DOUBLE COMPLEX YUDYUYDD(3,3),YUMQMYDD(3,3),YUYDDMDM(3,3)
      DOUBLE COMPLEX YDMQMYUD(3,3),YDYUDMUPM(3,3)
      DOUBLE COMPLEX HUYUDYUYUD(3,3),HUYDDYDYUD(3,3),HDYUDYUYDD(3,3)
      DOUBLE COMPLEX HDYDDYDYDD(3,3),HEYEDYEYED(3,3),YUDYUYUDHU(3,3)
      DOUBLE COMPLEX YUDHUYUDYU(3,3),YDDYDYDDHD(3,3),YDDHDYDDYD(3,3)
      DOUBLE COMPLEX YDDYDYUDHU(3,3),YDDHDYUDYU(3,3),YUDHUYDDYD(3,3)
      DOUBLE COMPLEX YUDYUYDDHD(3,3),YEDYEYEDHE(3,3),YEDHEYEDYE(3,3)
      DOUBLE COMPLEX HUDHUYUDYU(3,3),HUDYUYUDHU(3,3),HDDHDYDDYD(3,3)
      DOUBLE COMPLEX HDDYDYDDHD(3,3),HDDHDYUDYU(3,3),YDDYDHUDHU(3,3)
      DOUBLE COMPLEX HDDYDYUDHU(3,3),YDDHDHUDYU(3,3),HUDHUYDDYD(3,3)
      DOUBLE COMPLEX YUDYUHDDHD(3,3),HUDYUYDDHD(3,3),YUDHUHDDYD(3,3)
      DOUBLE COMPLEX HEDHEYEDYE(3,3),HEDYEYEDHE(3,3),YUDYUHUDHU(3,3)
      DOUBLE COMPLEX YDDYDHDDHD(3,3),YUDHUHUDYU(3,3),YDDHDHDDYD(3,3)
      DOUBLE COMPLEX YEDYEHEDHE(3,3),YEDHEHEDYE(3,3),HUHUDYUYUD(3,3)
      DOUBLE COMPLEX YUYUDHUHUD(3,3),HUYUDYUHUD(3,3),YUHUDHUYUD(3,3)
      DOUBLE COMPLEX HUHDDYDYUD(3,3),YUYDDHDHUD(3,3),HUYDDYDHUD(3,3)
      DOUBLE COMPLEX YUHDDHDYUD(3,3),HDHDDYDYDD(3,3),YDYDDHDHDD(3,3)
      DOUBLE COMPLEX HDYDDYDHDD(3,3),YDHDDHDYDD(3,3),HDHUDYUYDD(3,3)
      DOUBLE COMPLEX YDYUDHUHDD(3,3),HDYUDYUHDD(3,3),YDHUDHUYDD(3,3)
      DOUBLE COMPLEX HEHEDYEYED(3,3),YEYEDHEHED(3,3),HEYEDYEHED(3,3)
      DOUBLE COMPLEX YEHEDHEYED(3,3),YUDMUPMYUYUDYU(3,3)
      DOUBLE COMPLEX YUDMUPMYUYDDYD(3,3),YUDYUMQMYDDYD(3,3)
      DOUBLE COMPLEX YUDYUYDDMDMYD(3,3),YDDMDMYDYDDYD(3,3)
      DOUBLE COMPLEX YEDMEMYEYEDYE(3,3),YUDYUMQMYUDYU(3,3)
      DOUBLE COMPLEX YUDYUYUDMUPMYU(3,3),YUDYUYUDYUMQM(3,3)
      DOUBLE COMPLEX YDDYDMQMYDDYD(3,3),YDDYDYDDMDMYD(3,3)
      DOUBLE COMPLEX YDDYDYDDYDMQM(3,3),YEDYEMLMYEDYE(3,3)
      DOUBLE COMPLEX YEDYEYEDMEMYE(3,3),YEDYEYEDYEMLM(3,3)
      DOUBLE COMPLEX YUMQMYUDYUYUD(3,3),YUYUDMUPMYUYUD(3,3)
      DOUBLE COMPLEX YUYUDYUMQMYUD(3,3),YUYUDYUYUDMUPM(3,3)
      DOUBLE COMPLEX YUMQMYDDYDYUD(3,3),YUYDDMDMYDYUD(3,3)
      DOUBLE COMPLEX YUYDDYDMQMYUD(3,3),YUYDDYDYUDMUPM(3,3)
      DOUBLE COMPLEX YDMQMYDDYDYDD(3,3),YDYDDMDMYDYDD(3,3)
      DOUBLE COMPLEX YDYDDYDMQMYDD(3,3),YDYDDYDYDDMDM(3,3)
      DOUBLE COMPLEX YDMQMYUDYUYDD(3,3),YDYUDMUPMYUYDD(3,3)
      DOUBLE COMPLEX YDYUDYUMQMYDD(3,3),YDYUDYUYDDMDM(3,3)
      DOUBLE COMPLEX YEMLMYEDYEYED(3,3),YEYEDMEMYEYED(3,3)
      DOUBLE COMPLEX YEYEDYEMLMYED(3,3),YEYEDYEYEDMEM(3,3)
      DOUBLE COMPLEX TYUDYUYUDYU,TYDDYDYDDYD,TYEDYEYEDYE
      DOUBLE COMPLEX TYUDYUYDDYD,TYDDYDYUDYU
!
      DOUBLE COMPLEX BETA1U(3,3),BETA2U(3,3),BETA1D(3,3),BETA2D(3,3)
      DOUBLE COMPLEX BETA1E(3,3),BETA2E(3,3)
      DOUBLE COMPLEX BETAT2U(3,3),BETAT2D(3,3),BETAT2E(3,3)
      DOUBLE COMPLEX BETA1HU,BETA2HU,BETA1HD
      DOUBLE COMPLEX BETA2HD,BETA1MQ(3,3),BETA2MQ(3,3),BETA1ML(3,3)
      DOUBLE COMPLEX BETA2ML(3,3),BETA1MU(3,3),BETA2MU(3,3)
      DOUBLE COMPLEX BETA1MD(3,3)
      DOUBLE COMPLEX BETA2MD(3,3),BETA1ME(3,3),BETA2ME(3,3)
      DOUBLE COMPLEX BETA2GRKMU,BETA1B,BETA2B,BETA1VU,BETA1VD,BETA2VU
      DOUBLE COMPLEX BETA2VD,B2GM(3),B1YMU(3,3),B1YMD(3,3),B1YME(3,3)
      DOUBLE COMPLEX B1TRIU(3,3),B1TRID(3,3),B1TRIE(3,3)
      DOUBLE COMPLEX B2YMU(3,3),B2YMD(3,3),B2YME(3,3),BETAVEV1,BETAVEV2
      DOUBLE COMPLEX B2GRKMUM,B2M(3),B2HMU(3,3),B2HMD(3,3),B2HME(3,3)
      DOUBLE COMPLEX B2HUM,B2HDM,B2MQM(3,3),B2MLM(3,3),B2MUM(3,3)
      DOUBLE COMPLEX B2MDM(3,3),B2MEM(3,3),BETA2BM
!
      DOUBLE COMPLEX ID(3,3),MVMU,MVB
      DOUBLE PRECISION B1LP(3),B1LPM(3),B2LPSM(3,3),B2LPM(3,3)
      DOUBLE PRECISION CM(3,3),CSM(3,3),SINB,COSB
      DOUBLE PRECISION PI,Q
!
      INTEGER I,J,NG,ND,NE,NNU,NU,NSQ,NSU,NSD,NSL,NSE,NSH,NH,NSW,NSG
      INTEGER THLH,THHH,THSH,THSB,THSW,THGL
!
      DATA ID(1,1)/(1.D0,0.D0)/,ID(1,2)/(0.D0,0.D0)/
     $    ,ID(1,3)/(0.D0,0.D0)/
      DATA ID(2,1)/(0.D0,0.D0)/,ID(2,2)/(1.D0,0.D0)/
     $    ,ID(2,3)/(0.D0,0.D0)/
      DATA ID(3,1)/(0.D0,0.D0)/,ID(3,2)/(0.D0,0.D0)/
     $    ,ID(3,3)/(1.D0,0.D0)/
      DATA B1LPM(1)/6.6D0/,B1LPM(2)/1.D0/,B1LPM(3)/-3.D0/
      DATA B2LPM(1,1)/7.96D0/,B2LPM(1,2)/5.4D0/,B2LPM(1,3)/17.6D0/
      DATA B2LPM(2,1)/1.8D0/,B2LPM(2,2)/25.D0/,B2LPM(2,3)/24.D0/
      DATA B2LPM(3,1)/2.2D0/,B2LPM(3,2)/9.D0/,B2LPM(3,3)/14.D0/
      DATA CM(1,1)/5.2D0/,CM(1,2)/2.8D0/,CM(1,3)/3.6D0/
      DATA CM(2,1)/6.D0/,CM(2,2)/6.D0/,CM(2,3)/2.D0/
      DATA CM(3,1)/4.D0/,CM(3,2)/4.D0/,CM(3,3)/0.D0/
!
      Q=SSQSTEP !This means that thresholds depend on the q being
                !calculated by the main programme instead of the
                !integration subroutine
!
      DO I=1,601
        G(I)=GCURR(I)
      END DO
!
!Set all F's and betas to zero
!
      DO I=1,601
        F(I)=(0.D0,0.D0)
      END DO
      DO I=1,3
        DO J=1,3
          B1U(I,J)=(0.D0,0.D0)
          B1D(I,J)=(0.D0,0.D0)
          B1E(I,J)=(0.D0,0.D0)
          BETA1U(I,J)=(0.D0,0.D0)
          BETA2U(I,J)=(0.D0,0.D0)
          BETAT2U(I,J)=(0.D0,0.D0)
          BETA1D(I,J)=(0.D0,0.D0)
          BETA2D(I,J)=(0.D0,0.D0)
          BETA1E(I,J)=(0.D0,0.D0)
          BETA2E(I,J)=(0.D0,0.D0)
          BETA1MQ(I,J)=(0.D0,0.D0)
          BETA2MQ(I,J)=(0.D0,0.D0)
          BETA1ML(I,J)=(0.D0,0.D0)
          BETA2ML(I,J)=(0.D0,0.D0)
          BETA1MU(I,J)=(0.D0,0.D0)
          BETA2MU(I,J)=(0.D0,0.D0)
          BETA1MD(I,J)=(0.D0,0.D0)
          BETA2MD(I,J)=(0.D0,0.D0)
          BETA1ME(I,J)=(0.D0,0.D0)
          BETA2ME(I,J)=(0.D0,0.D0)
          BFTUQ(I,J)=(0.D0,0.D0)
          BFTDQ(I,J)=(0.D0,0.D0)
          BFTEL(I,J)=(0.D0,0.D0)
          BFTUU(I,J)=(0.D0,0.D0)
          BFTDD(I,J)=(0.D0,0.D0)
          BFTEE(I,J)=(0.D0,0.D0)
          BGTQ(I,J)=(0.D0,0.D0)
          BGTL(I,J)=(0.D0,0.D0)
          BGTPQ(I,J)=(0.D0,0.D0)
          BGTPL(I,J)=(0.D0,0.D0)
          BGTPU(I,J)=(0.D0,0.D0)
          BGTPD(I,J)=(0.D0,0.D0)
          BGTPE(I,J)=(0.D0,0.D0)
          BGTSQ(I,J)=(0.D0,0.D0)
          BGTSU(I,J)=(0.D0,0.D0)
          BGTSD(I,J)=(0.D0,0.D0)
          BMTSFU(I,J)=(0.D0,0.D0)
          BMTSFD(I,J)=(0.D0,0.D0)
          BMTSFE(I,J)=(0.D0,0.D0)
!          
          B1YMU(I,J)=(0.D0,0.D0)
          B1YMD(I,J)=(0.D0,0.D0)
          B1YME(I,J)=(0.D0,0.D0)
          B1TRIU(I,J)=(0.D0,0.D0)
          B1TRID(I,J)=(0.D0,0.D0)
          B1TRIE(I,J)=(0.D0,0.D0)
          B2YMU(I,J)=(0.D0,0.D0)
          B2YMD(I,J)=(0.D0,0.D0)
          B2YME(I,J)=(0.D0,0.D0)
          B2HMU(I,J)=(0.D0,0.D0)
          B2HMD(I,J)=(0.D0,0.D0)
          B2HME(I,J)=(0.D0,0.D0)
          B2MQM(I,J)=(0.D0,0.D0)
          B2MLM(I,J)=(0.D0,0.D0)
          B2MUM(I,J)=(0.D0,0.D0)
          B2MDM(I,J)=(0.D0,0.D0)
          B2MEM(I,J)=(0.D0,0.D0)
        END DO
        BM(I)=(0.D0,0.D0)
        BMP(I)=(0.D0,0.D0)
        B2GM(I)=(0.D0,0.D0)
        B2M(I)=(0.D0,0.D0)
      END DO
      BETA1HU=(0.D0,0.D0)
      BETA2HU=(0.D0,0.D0)
      BETA1HD=(0.D0,0.D0)
      BETA2HD=(0.D0,0.D0)
      B2HUM=(0.D0,0.D0)
      B2HDM=(0.D0,0.D0)
      BGRKMU=(0.D0,0.D0)
      BETA2GRKMU=(0.D0,0.D0)
      B2GRKMUM=(0.D0,0.D0)
      BETA1B=(0.D0,0.D0)
      BETA2B=(0.D0,0.D0)
      BETA2BM=(0.D0,0.D0)
      BETA1VU=(0.D0,0.D0)
      BETA1VD=(0.D0,0.D0)
      BETA2VU=(0.D0,0.D0)
      BETA2VD=(0.D0,0.D0)
      BGTHU=(0.D0,0.D0)
      BGTHD=(0.D0,0.D0)
      BGTPHU=(0.D0,0.D0)
      BGTPHD=(0.D0,0.D0)
      BSGTHU=(0.D0,0.D0)
      BCGTHD=(0.D0,0.D0)
      BSGTPHU=(0.D0,0.D0)
      BCGTPHD=(0.D0,0.D0)
      BETALAM1=(0.D0,0.D0)
      BETALAM2=(0.D0,0.D0)
      BETAVEV1=(0.D0,0.D0)
      BETAVEV2=(0.D0,0.D0)
!
      BMHUPMT=(0D0,0.D0)
      BMHDPMT=(0D0,0.D0)
      BMHUD=(0D0,0.D0)
!
      PI=4.D0*ATAN(1.D0)
      SINB=DSQRT(DBLE(TANB)**2/(1+DBLE(TANB)**2))
      COSB=SINB/TANB
      IF(Q.LT.1.D0)THEN
        WRITE(*,*)'ERROR IN Q: ',Q
        STOP
      END IF
      NG=3.D0
      NU=3
      ND=3
      NE=3
      NNU=3
      IF ((Q-QNSH).GT.ABS(EPS).OR.
     $         (ABS(Q-QNSH).LT.ABS(EPS).AND.EPS.GT.0)) THEN
        NSH=2
      ELSE
        NSH=0
      END IF
      IF ((Q-QNSG).GT.ABS(EPS).OR.
     $         (ABS(Q-QNSG).LT.ABS(EPS).AND.EPS.GT.0)) THEN
        NSG=1
      ELSE
        NSG=0
      END IF
      IF ((Q-QNH).GT.ABS(EPS).OR.
     $         (ABS(Q-QNH).LT.ABS(EPS).AND.EPS.GT.0)) THEN
        NH=2
      ELSE
        NH=1
      END IF
      IF ((Q-QTHSB).GT.ABS(EPS).OR.
     $         (ABS(Q-QTHSB).LT.ABS(EPS).AND.EPS.GT.0)) THEN
        THSB=1
      ELSE
        THSB=0
      END IF
      IF ((Q-QTHSW).GT.ABS(EPS).OR.
     $         (ABS(Q-QTHSW).LT.ABS(EPS).AND.EPS.GT.0)) THEN
        NSW=1
        THSW=1
      ELSE
        NSW=0
        THSW=0
      END IF
      THLH=1
      THHH=NH/2 !This works so long as THHH is an integer variable
      IF(THHH.NE.1)THEN !Perform check
        IF(THHH.NE.0)WRITE(*,*)'ERROR IN THHH'
      END IF
      THSH=NSH/2
      THGL=NSG
!
      NSQ=0
      NSU=0
      NSD=0
      NSL=0
      NSE=0
      DO I=1,3
        NSQ=NSQ+THSQ(I)
        NSU=NSU+THSU(I)
        NSD=NSD+THSD(I)
        NSL=NSL+THSL(I)
        NSE=NSE+THSE(I)
      END DO
!
!Since I remove entries in the sfermion mass matrix
!as they decouple, I need to continue rotating even
!when all NS_ are zero.
!
      IF(NSQ+NSU+NSD+NSL+NSE.LT.15)THEN
!
!Rotate to the mass basis.
!
        CALL ROTSQ(GCURR,G)
!
      END IF
!
!Convert input into 3x3 matrices. For the Yukawas and a-parameters
!I also convert notation and define Y and H as Martin and Vaughn
!parameters.
!
      DO I=1,3
        DO J=1,3
          FU(I,J)=G(3+(I-1)*3+J)
          FD(I,J)=G(12+(I-1)*3+J)
          FE(I,J)=G(21+(I-1)*3+J)
          AU(I,J)=G(33+(I-1)*3+J)
          AD(I,J)=G(42+(I-1)*3+J)
          AE(I,J)=G(51+(I-1)*3+J)
          MQ(I,J)=G(62+(I-1)*3+J)
          ML(I,J)=G(71+(I-1)*3+J)
          MUP(I,J)=G(80+(I-1)*3+J)
          MD(I,J)=G(89+(I-1)*3+J)
          ME(I,J)=G(98+(I-1)*3+J)
!
          YU(I,J)=G(293+(J-1)*3+I)
          YD(I,J)=G(302+(J-1)*3+I)
          YE(I,J)=G(311+(J-1)*3+I)
          HU(I,J)=-G(323+(J-1)*3+I)
          HD(I,J)=-G(332+(J-1)*3+I)
          HE(I,J)=-G(341+(J-1)*3+I)
          MQM(I,J)=G(352+(I-1)*3+J)
          MLM(I,J)=G(361+(I-1)*3+J)
          MUPM(I,J)=G(370+(I-1)*3+J)
          MDM(I,J)=G(379+(I-1)*3+J)
          MEM(I,J)=G(388+(I-1)*3+J)
!
          LU(I,J)=G(111+(I-1)*3+J)
          LD(I,J)=G(120+(I-1)*3+J)
          LE(I,J)=G(129+(I-1)*3+J)
!
          GTPQ(I,J)=G(138+(I-1)*3+J)
          GTPL(I,J)=G(147+(I-1)*3+J)
          GTPU(I,J)=G(156+(I-1)*3+J)
          GTPD(I,J)=G(165+(I-1)*3+J)
          GTPE(I,J)=G(174+(I-1)*3+J)
          GTQ(I,J)=G(185+(I-1)*3+J)
          GTL(I,J)=G(194+(I-1)*3+J)
          GTSQ(I,J)=G(205+(I-1)*3+J)
          GTSU(I,J)=G(214+(I-1)*3+J)
          GTSD(I,J)=G(223+(I-1)*3+J)
          FTUQ(I,J)=G(232+(I-1)*3+J)
          FTDQ(I,J)=G(241+(I-1)*3+J)
          FTEL(I,J)=G(250+(I-1)*3+J)
          FTUU(I,J)=G(259+(I-1)*3+J)
          FTDD(I,J)=G(268+(I-1)*3+J)
          FTEE(I,J)=G(277+(I-1)*3+J)
!
          TRIU(I,J)=G(399+(I-1)*3+J)
          TRID(I,J)=G(408+(I-1)*3+J)
          TRIE(I,J)=G(417+(I-1)*3+J)
          MTSFU(I,J)=G(429+(I-1)*3+J)
          MTSFD(I,J)=G(438+(I-1)*3+J)
          MTSFE(I,J)=G(447+(I-1)*3+J)
!
!For now the quartics are not run independently
!If you wish to introduce independent quartic running
!see the note at the top of this subroutine.
!Care should be taken with quartics which are
!equal by SU(2) invariance.
!
          FUHU(I,J)=FU(I,J)
          FDHD(I,J)=FD(I,J)
          FEHD(I,J)=FE(I,J)
          FUQ(I,J)=FU(I,J)
          FDQ(I,J)=FD(I,J)
          FUUR(I,J)=FU(I,J)
          FDDR(I,J)=FD(I,J)
          FEL(I,J)=FE(I,J)
          FEER(I,J)=FE(I,J)
          IF(THHH.EQ.0)THEN
            SFUQ(I,J)=LU(I,J)
            CFDQ(I,J)=LD(I,J)
            SFUUR(I,J)=LU(I,J)
            CFDDR(I,J)=LD(I,J)
            CFEL(I,J)=LE(I,J)
            CFEER(I,J)=LE(I,J)
          ELSE
            SFUQ(I,J)=(0.D0,0.D0)
            CFDQ(I,J)=(0.D0,0.D0)
            SFUUR(I,J)=(0.D0,0.D0)
            CFDDR(I,J)=(0.D0,0.D0)
            CFEL(I,J)=(0.D0,0.D0)
            CFEER(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
!Set other quartics to their counterparts
!
      G(457)=DSQRT(3.D0/5.D0)*G(1)
      G(458)=G(2)
      G(459)=G(3)
      IF(THHH.EQ.0)THEN
        G(541)=SQRT(DCMPLX(COSB**2)-DCMPLX(SINB**2))
     $                             *DSQRT(3.D0/5.D0)*G(1)
        G(542)=SQRT(DCMPLX(COSB**2)-DCMPLX(SINB**2))*G(2)
        G(543)=(COSB**2-SINB**2)*DSQRT(3.D0/5.D0)*G(1)
        G(544)=(COSB**2-SINB**2)*G(2)
      ELSE
        G(541)=(0.D0,0.D0)
        G(542)=(0.D0,0.D0)
        G(543)=(0.D0,0.D0)
        G(544)=(0.D0,0.D0)
      END IF
!
!The mu and b running is partly in MV notation, so I must convert
!NB: MVMU is the MSSM MV notation \mu.
!
      MVMU=G(398)
      MVB=-G(399)
!      
!The separated out contributions are from PRD 49 4882 (1194),
!Castano,Piard,Ramond
!
      B1LP(1)=2.D0/5.D0*(17.D0/12.D0*DBLE(NU)+5.D0/12.D0*DBLE(ND)
     $        +5.D0/4.D0*DBLE(NE)+1.D0/4.D0*DBLE(NNU))+1.D0/30.D0
     $        *DBLE(NSQ)+4.D0/15.D0*DBLE(NSU)+1.D0/15.D0*DBLE(NSD)
     $        +1.D0/10.D0*DBLE(NSL)+1.D0/5.D0*DBLE(NSE)
     $        +1.D0/5.D0*DBLE(NSH)+1.D0/10.D0*DBLE(NH)
      B1LP(2)=-22.D0/3.D0+1.D0/2.D0*(DBLE(NU)+DBLE(ND))+1.D0/6.D0
     $        *(DBLE(NE)+DBLE(NNU))+1.D0/2.D0*DBLE(NSQ)
     $        +1.D0/6.D0*DBLE(NSL)+1.D0/3.D0*DBLE(NSH)+1.D0/6.D0
     $        *DBLE(NH)+4.D0/3.D0*DBLE(NSW)
      B1LP(3)=-11.D0+2.D0/3.D0*(DBLE(NU)+DBLE(ND))+1.D0/3.D0
     $        *DBLE(NSQ)+1.D0/6.D0*DBLE(NSU)+1.D0/6.D0*DBLE(NSD)
     $        +2.D0*DBLE(NSG)
      B2LPSM(1,1)=-(-NG*19.D0/15.D0-9.D0/50.D0)
      B2LPSM(1,2)=-(-NG*3.D0/5.D0-9.D0/10.D0)
      B2LPSM(1,3)=-(-NG*44.D0/15.D0)
      B2LPSM(2,1)=-(-NG*1.D0/5.D0-3.D0/10.D0)
      B2LPSM(2,2)=-(136.D0/3.D0-NG*49.D0/3.D0-13.D0/6.D0)
      B2LPSM(2,3)=-(-NG*4.D0)
      B2LPSM(3,1)=-(-NG*11.D0/30.D0)
      B2LPSM(3,2)=-(-NG*3.D0/2.D0)
      B2LPSM(3,3)=-(102.D0-NG*76.D0/3.D0)
      CSM(1,1)=1.7D0
      CSM(1,2)=.5D0
      CSM(1,3)=1.5D0
      CSM(2,1)=1.5D0
      CSM(2,2)=1.5D0
      CSM(2,3)=.5D0
      CSM(3,1)=2.D0
      CSM(3,2)=2.D0
      CSM(3,3)=0.D0
!
!I need many variations on the 3x3 matrices.
!
      CALL CDAGGER(FTUQ,FTUQD)
      CALL CDAGGER(FTUU,FTUUD)
      CALL CDAGGER(FTDD,FTDDD)
      CALL CDAGGER(FTDQ,FTDQD)
      CALL CDAGGER(FTEL,FTELD)
      CALL CDAGGER(FTEE,FTEED)
      CALL CDAGGER(GTQ,GTQD)
      CALL CDAGGER(GTL,GTLD)
      CALL CDAGGER(GTPQ,GTPQD)
      CALL CDAGGER(GTPU,GTPUD)
      CALL CDAGGER(GTPD,GTPDD)
      CALL CDAGGER(GTPL,GTPLD)
      CALL CDAGGER(GTPE,GTPED)
      CALL CDAGGER(GTSQ,GTSQD)
      CALL CDAGGER(GTSU,GTSUD)
      CALL CDAGGER(GTSD,GTSDD)
      CALL CDAGGER(FUHU,FUHUD)
      CALL CDAGGER(FDHD,FDHDD)
      CALL CDAGGER(FEHD,FEHDD)
      CALL CDAGGER(TRIU,TRIUD)
      CALL CDAGGER(TRID,TRIDD)
      CALL CDAGGER(TRIE,TRIED)
      DO I=1,3
        DO J=1,3
          FUS(I,J)=CONJG(FU(I,J))
          FDS(I,J)=CONJG(FD(I,J))
          FES(I,J)=CONJG(FE(I,J))
          LUS(I,J)=CONJG(LU(I,J))
          LDS(I,J)=CONJG(LD(I,J))
          LES(I,J)=CONJG(LE(I,J))
          AUS(I,J)=CONJG(AU(I,J))
          ADS(I,J)=CONJG(AD(I,J))
          AES(I,J)=CONJG(AE(I,J))
          FTUQS(I,J)=CONJG(FTUQ(I,J))
          FTUUS(I,J)=CONJG(FTUU(I,J))
          FTDQS(I,J)=CONJG(FTDQ(I,J))
          FTDDS(I,J)=CONJG(FTDD(I,J))
          FTELS(I,J)=CONJG(FTEL(I,J))
          FTEES(I,J)=CONJG(FTEE(I,J))
          GTPUS(I,J)=CONJG(GTPU(I,J))
          GTSUS(I,J)=CONJG(GTSU(I,J))
          GTQS(I,J)=CONJG(GTQ(I,J))
          GTLS(I,J)=CONJG(GTL(I,J))
          GTPQS(I,J)=CONJG(GTPQ(I,J))
          GTPLS(I,J)=CONJG(GTPL(I,J))
          GTSQS(I,J)=CONJG(GTSQ(I,J))
          GTPDS(I,J)=CONJG(GTPD(I,J))
          GTPES(I,J)=CONJG(GTPE(I,J))
          GTSDS(I,J)=CONJG(GTSD(I,J))
          MTSFUS(I,J)=CONJG(MTSFU(I,J))
          MTSFDS(I,J)=CONJG(MTSFD(I,J))
          MTSFES(I,J)=CONJG(MTSFE(I,J))
          FUHUS(I,J)=CONJG(FUHU(I,J))
          FDHDS(I,J)=CONJG(FDHD(I,J))
          FEHDS(I,J)=CONJG(FEHD(I,J))
          TRIUS(I,J)=CONJG(TRIU(I,J))
          TRIDS(I,J)=CONJG(TRID(I,J))
          TRIES(I,J)=CONJG(TRIE(I,J))
          FUT(I,J)=FU(J,I)
          FDT(I,J)=FD(J,I)
          FET(I,J)=FE(J,I)
          LUT(I,J)=LU(J,I)
          LDT(I,J)=LD(J,I)
          LET(I,J)=LE(J,I)
          AUT(I,J)=AU(J,I)
          ADT(I,J)=AD(J,I)
          AET(I,J)=AE(J,I)
          FTUQT(I,J)=FTUQ(J,I)
          FTUUT(I,J)=FTUU(J,I)
          FTDQT(I,J)=FTDQ(J,I)
          FTDDT(I,J)=FTDD(J,I)
          FTELT(I,J)=FTEL(J,I)
          FTEET(I,J)=FTEE(J,I)
          GTPUT(I,J)=GTPU(J,I)
          GTQT(I,J)=GTQ(J,I)
          GTLT(I,J)=GTL(J,I)
          GTPQT(I,J)=GTPQ(J,I)
          GTPLT(I,J)=GTPL(J,I)
          GTPDT(I,J)=GTPD(J,I)
          GTPET(I,J)=GTPE(J,I)
          GTSUT(I,J)=GTSU(J,I)
          GTSQT(I,J)=GTSQ(J,I)
          GTSDT(I,J)=GTSD(J,I)
          MTSFUT(I,J)=MTSFU(J,I)
          MTSFDT(I,J)=MTSFD(J,I)
          MTSFET(I,J)=MTSFE(J,I)
          FUHUT(I,J)=FUHU(J,I)
          FDHDT(I,J)=FDHD(J,I)
          FEHDT(I,J)=FEHD(J,I)
          TRIUT(I,J)=TRIU(J,I)
          TRIDT(I,J)=TRID(J,I)
          TRIET(I,J)=TRIE(J,I)
        END DO
      END DO
!
!Now all the matrix multiples
!
      DO I=1,3
        DO J=1,3
          YUDYU(I,J)=CMATMUL(1,YU,YU,I,J)
          YDDYD(I,J)=CMATMUL(1,YD,YD,I,J)
          YEDYE(I,J)=CMATMUL(1,YE,YE,I,J)
          YUYUD(I,J)=CMATMUL(2,YU,YU,I,J)
          YDYDD(I,J)=CMATMUL(2,YD,YD,I,J)
          YEYED(I,J)=CMATMUL(2,YE,YE,I,J)
          YUYDD(I,J)=CMATMUL(2,YU,YD,I,J)
          YDYUD(I,J)=CMATMUL(2,YD,YU,I,J)
!
          HUYUD(I,J)=CMATMUL(2,HU,YU,I,J)
          HDYDD(I,J)=CMATMUL(2,HD,YD,I,J)
          HEYED(I,J)=CMATMUL(2,HE,YE,I,J)
          YUDHU(I,J)=CMATMUL(1,YU,HU,I,J)
          YDDHD(I,J)=CMATMUL(1,YD,HD,I,J)
          YEDHE(I,J)=CMATMUL(1,YE,HE,I,J)
          HUDHU(I,J)=CMATMUL(1,HU,HU,I,J)
          HDDHD(I,J)=CMATMUL(1,HD,HD,I,J)
          HEDHE(I,J)=CMATMUL(1,HE,HE,I,J)
          HUDYU(I,J)=CMATMUL(1,HU,YU,I,J)
          HDDYD(I,J)=CMATMUL(1,HD,YD,I,J)
          HEDYE(I,J)=CMATMUL(1,HE,YE,I,J)
          HUHUD(I,J)=CMATMUL(2,HU,HU,I,J)
          HDHDD(I,J)=CMATMUL(2,HD,HD,I,J)
          HEHED(I,J)=CMATMUL(2,HE,HE,I,J)
          YUHUD(I,J)=CMATMUL(2,YU,HU,I,J)
          YDHDD(I,J)=CMATMUL(2,YD,HD,I,J)
          YEHED(I,J)=CMATMUL(2,YE,HE,I,J)
          HUYDD(I,J)=CMATMUL(2,HU,YD,I,J)
          HDYUD(I,J)=CMATMUL(2,HD,YU,I,J)
          HUHDD(I,J)=CMATMUL(2,HU,HD,I,J)
          HDHUD(I,J)=CMATMUL(2,HD,HU,I,J)
          YDHUD(I,J)=CMATMUL(2,YD,HU,I,J)
          YUHDD(I,J)=CMATMUL(2,YU,HD,I,J)
!
          MUPMYU(I,J)=CMATMUL(0,MUPM,YU,I,J)
          MDMYD(I,J)=CMATMUL(0,MDM,YD,I,J)
          MEMYE(I,J)=CMATMUL(0,MEM,YE,I,J)
          YUMQM(I,J)=CMATMUL(0,YU,MQM,I,J)
          YDMQM(I,J)=CMATMUL(0,YD,MQM,I,J)
          YEMLM(I,J)=CMATMUL(0,YE,MLM,I,J)
!
          FUFUD(I,J)=CMATMUL(2,FU,FU,I,J)
          FUSFUT(I,J)=CMATMUL(0,FUS,FUT,I,J)
          LUSLUT(I,J)=CMATMUL(0,LUS,LUT,I,J)
          FUTFUS(I,J)=CMATMUL(0,FUT,FUS,I,J)
          LUTLUS(I,J)=CMATMUL(0,LUT,LUS,I,J)
          FUTFTUUS(I,J)=CMATMUL(0,FUT,FTUUS,I,J)
          LUTFTUUS(I,J)=CMATMUL(0,LUT,FTUUS,I,J)
          FUGTPUS(I,J)=CMATMUL(0,FU,GTPUS,I,J)
          FUGTSUS(I,J)=CMATMUL(0,FU,GTSUS,I,J)
          LUGTPUS(I,J)=CMATMUL(0,LU,GTPUS,I,J)
          LUGTSUS(I,J)=CMATMUL(0,LU,GTSUS,I,J)
          FDFDD(I,J)=CMATMUL(2,FD,FD,I,J)
          FDTFDS(I,J)=CMATMUL(0,FDT,FDS,I,J)
          LDTLDS(I,J)=CMATMUL(0,LDT,LDS,I,J)
          FDTFTDDS(I,J)=CMATMUL(0,FDT,FTDDS,I,J)
          LDTFTDDS(I,J)=CMATMUL(0,LDT,FTDDS,I,J)
          FDSFDT(I,J)=CMATMUL(0,FDS,FDT,I,J)
          LDSLDT(I,J)=CMATMUL(0,LDS,LDT,I,J)
          FDGTPDS(I,J)=CMATMUL(0,FD,GTPDS,I,J)
          FDGTSDS(I,J)=CMATMUL(0,FD,GTSDS,I,J)
          LDGTPDS(I,J)=CMATMUL(0,LD,GTPDS,I,J)
          LDGTSDS(I,J)=CMATMUL(0,LD,GTSDS,I,J)
          FEFED(I,J)=CMATMUL(2,FE,FE,I,J)
          FETFES(I,J)=CMATMUL(0,FET,FES,I,J)
          LETLES(I,J)=CMATMUL(0,LET,LES,I,J)
          FETFTEES(I,J)=CMATMUL(0,FET,FTEES,I,J)
          LETFTEES(I,J)=CMATMUL(0,LET,FTEES,I,J)
          FESFET(I,J)=CMATMUL(0,FES,FET,I,J)
          LESLET(I,J)=CMATMUL(0,LES,LET,I,J)
          FEGTPES(I,J)=CMATMUL(0,FE,GTPES,I,J)
          LEGTPES(I,J)=CMATMUL(0,LE,GTPES,I,J)
          FUDFU(I,J)=CMATMUL(1,FU,FU,I,J)
          FDDFD(I,J)=CMATMUL(1,FD,FD,I,J)
          FEDFE(I,J)=CMATMUL(1,FE,FE,I,J)
          LUDLU(I,J)=CMATMUL(1,LU,LU,I,J)
          LDDLD(I,J)=CMATMUL(1,LD,LD,I,J)
          LEDLE(I,J)=CMATMUL(1,LE,LE,I,J)
          LULUD(I,J)=CMATMUL(2,LU,LU,I,J)
          LDLDD(I,J)=CMATMUL(2,LD,LD,I,J)
          LELED(I,J)=CMATMUL(2,LE,LE,I,J)
!
          FTUQFTUQD(I,J)=CMATMUL(2,FTUQ,FTUQ,I,J)
          FTUQSFTUQT(I,J)=CMATMUL(0,FTUQS,FTUQT,I,J)
          FTUQSFUT(I,J)=CMATMUL(0,FTUQS,FUT,I,J)
          FTUQSLUT(I,J)=CMATMUL(0,FTUQS,LUT,I,J)
          FTDQFTDQD(I,J)=CMATMUL(2,FTDQ,FTDQ,I,J)
          FTDQSFTDQT(I,J)=CMATMUL(0,FTDQS,FTDQT,I,J)
          FTDQSFDT(I,J)=CMATMUL(0,FTDQS,FDT,I,J)
          FTDQSLDT(I,J)=CMATMUL(0,FTDQS,LDT,I,J)
          FTELFTELD(I,J)=CMATMUL(2,FTEL,FTEL,I,J)
          FTELSFTELT(I,J)=CMATMUL(0,FTELS,FTELT,I,J)
          FTELSFET(I,J)=CMATMUL(0,FTELS,FET,I,J)
          FTELSLET(I,J)=CMATMUL(0,FTELS,LET,I,J)
          GTQSGTQT(I,J)=CMATMUL(0,GTQS,GTQT,I,J)
          GTQGTQD(I,J)=CMATMUL(2,GTQ,GTQ,I,J)
          GTPQSGTPQT(I,J)=CMATMUL(0,GTPQS,GTPQT,I,J)
          GTPQGTPQD(I,J)=CMATMUL(2,GTPQ,GTPQ,I,J)
          GTPUTGTPUS(I,J)=CMATMUL(0,GTPUT,GTPUS,I,J)
          GTPUDGTPU(I,J)=CMATMUL(1,GTPU,GTPU,I,J)
          GTPDDGTPD(I,J)=CMATMUL(1,GTPD,GTPD,I,J)
          GTPDTGTPDS(I,J)=CMATMUL(0,GTPDT,GTPDS,I,J)
          GTSQSGTSQT(I,J)=CMATMUL(0,GTSQS,GTSQT,I,J)
          GTSQGTSQD(I,J)=CMATMUL(2,GTSQ,GTSQD,I,J)
          GTSUTGTSUS(I,J)=CMATMUL(0,GTSUT,GTSUS,I,J)
          GTSUDGTSU(I,J)=CMATMUL(1,GTSU,GTSU,I,J)
          GTSDDGTSD(I,J)=CMATMUL(1,GTSD,GTSD,I,J)
          GTSDTGTSDS(I,J)=CMATMUL(0,GTSDT,GTSDS,I,J)
          GTLSGTLT(I,J)=CMATMUL(0,GTLS,GTLT,I,J)
          GTLGTLD(I,J)=CMATMUL(2,GTL,GTL,I,J)
          GTPLSGTPLT(I,J)=CMATMUL(0,GTPLS,GTPLT,I,J)
          GTPLGTPLD(I,J)=CMATMUL(2,GTPL,GTPL,I,J)
          GTPETGTPES(I,J)=CMATMUL(0,GTPET,GTPES,I,J)
          GTPEDGTPE(I,J)=CMATMUL(1,GTPE,GTPE,I,J)
          FUURFUURD(I,J)=CMATMUL(2,FUUR,FUUR,I,J)
          FUQDFUQ(I,J)=CMATMUL(1,FUQ,FUQ,I,J)
          FUQDFDQ(I,J)=CMATMUL(1,FUQ,FDQ,I,J)
          FDQDFUQ(I,J)=CMATMUL(1,FDQ,FUQ,I,J)
          FDQDFDQ(I,J)=CMATMUL(1,FDQ,FDQ,I,J)
          FDDRFDDRD(I,J)=CMATMUL(2,FDDR,FDDR,I,J)
          FEERFEERD(I,J)=CMATMUL(2,FEER,FEER,I,J)
          FELDFEL(I,J)=CMATMUL(1,FEL,FEL,I,J)
          FTUQGTPUS(I,J)=CMATMUL(0,FTUQ,GTPUS,I,J)
          FTDQGTPDS(I,J)=CMATMUL(0,FTDQ,GTPDS,I,J)
          FTELGTPES(I,J)=CMATMUL(0,FTEL,GTPES,I,J)
          GTPQSFTUU(I,J)=CMATMUL(0,GTPQS,FTUU,I,J)
          GTPQSFTDD(I,J)=CMATMUL(0,GTPQS,FTDD,I,J)
          GTPLSFTEE(I,J)=CMATMUL(0,GTPLS,FTEE,I,J)
          GTQSFTUU(I,J)=CMATMUL(0,GTQS,FTUU,I,J)
          GTQSFTDD(I,J)=CMATMUL(0,GTQS,FTDD,I,J)
          GTLSFTEE(I,J)=CMATMUL(0,GTLS,FTEE,I,J)
          FDDFTUU(I,J)=CMATMUL(1,FD,FTUU,I,J)
          LDDFTUU(I,J)=CMATMUL(1,LD,FTUU,I,J)
          FUDFTDD(I,J)=CMATMUL(1,FU,FTDD,I,J)
          LUDFTDD(I,J)=CMATMUL(1,LU,FTDD,I,J)
          FTUUDFTUU(I,J)=CMATMUL(0,FTUUD,FTUU,I,J)
          FTDDDFTDD(I,J)=CMATMUL(0,FTDDD,FTDD,I,J)
          FTEEDFTEE(I,J)=CMATMUL(0,FTEED,FTEE,I,J)
        END DO
      END DO
      DO I=1,3
        DO J=1,3
          FUQTFUQS(I,J)=FUQDFUQ(J,I)
          FUURSFUURT(I,J)=FUURFUURD(J,I)
          FDQTFDQS(I,J)=FDQDFDQ(J,I)
          FDDRSFDDRT(I,J)=FDDRFDDRD(J,I)
          FEERSFEERT(I,J)=FEERFEERD(J,I)
          FELTFELS(I,J)=FELDFEL(J,I)
          FTUUTFTUUS(I,J)=FTUUDFTUU(J,I)
          FTDDTFTDDS(I,J)=FTDDDFTDD(J,I)
          FTEETFTEES(I,J)=FTEEDFTEE(J,I)
        END DO
      END DO
!
      IF(THHH.EQ.0)THEN
        MSGTPHUSQ=CONJG(G(287))*G(287)
        MCGTPHDSQ=CONJG(G(288))*G(288)
        MSGTHUSQ=CONJG(G(289))*G(289)
        MCGTHDSQ=CONJG(G(290))*G(290)
      END IF
      MGTPHUSQ=CONJG(G(184))*G(184)
      MGTPHDSQ=CONJG(G(185))*G(185)
      MGTHUSQ=CONJG(G(204))*G(204)
      MGTHDSQ=CONJG(G(205))*G(205)
      MMUSQ=CONJG(G(108))*G(108)
      M1PM1PSQ=G(31)**2+G(599)**2
      M2PM2PSQ=G(32)**2+G(600)**2
      M3PM3PSQ=G(33)**2+G(601)**2
!
      TYUDYU=CTRACE(YUDYU)
      TYDDYD=CTRACE(YDDYD)
      TYEDYE=CTRACE(YEDYE)
      TYUDHU=CTRACE(YUDHU)
      TYDDHD=CTRACE(YDDHD)
      TYEDHE=CTRACE(YEDHE)
      THUYUD=CTRACE(HUYUD)
!
      TFUDFU=CTRACE(FUDFU)
      TFDDFD=CTRACE(FDDFD)
      TFEDFE=CTRACE(FEDFE)
      TLUDLU=CTRACE(LULUD)
      TLDDLD=CTRACE(LDLDD)
      TLEDLE=CTRACE(LELED)
!
      DO I=1,3
        DO J=1,3
          YUDMUPMYU(I,J)=CMATMUL(1,YU,MUPMYU,I,J)
          YDDMDMYD(I,J)=CMATMUL(1,YD,MDMYD,I,J)
          YEDMEMYE(I,J)=CMATMUL(1,YE,MEMYE,I,J)
          YEDYEMLM(I,J)=CMATMUL(1,YE,YEMLM,I,J)
          YUMQMYUD(I,J)=CMATMUL(2,YUMQM,YU,I,J)
          YUYUDMUPM(I,J)=CMATMUL(0,YUYUD,MUPM,I,J)
          YDMQMYDD(I,J)=CMATMUL(2,YDMQM,YD,I,J)
          YDYDDMDM(I,J)=CMATMUL(0,YDYDD,MDM,I,J)
          YEMLMYED(I,J)=CMATMUL(2,YEMLM,YE,I,J)
          YEYEDMEM(I,J)=CMATMUL(0,YEYED,MEM,I,J)
!
          FUFUDFU(I,J)=CMATMUL(0,FUFUD,FU,I,J)
          FUFUDFD(I,J)=CMATMUL(0,FUFUD,FD,I,J)
          FUTFUSGTPU(I,J)=CMATMUL(0,FUTFUS,GTPU,I,J)
          LUTLUSGTPU(I,J)=CMATMUL(0,LUTLUS,GTPU,I,J)
          FUTFUSGTSU(I,J)=CMATMUL(0,FUTFUS,GTSU,I,J)
          LUTLUSGTSU(I,J)=CMATMUL(0,LUTLUS,GTSU,I,J)
          FDFDDFU(I,J)=CMATMUL(0,FDFDD,FU,I,J)
          FDFDDFD(I,J)=CMATMUL(0,FDFDD,FD,I,J)
          FDTFDSGTPD(I,J)=CMATMUL(0,FDTFDS,GTPD,I,J)
          LDTLDSGTPD(I,J)=CMATMUL(0,LDTLDS,GTPD,I,J)
          FDTFDSGTSD(I,J)=CMATMUL(0,FDTFDS,GTSD,I,J)
          LDTLDSGTSD(I,J)=CMATMUL(0,LDTLDS,GTSD,I,J)
          FEFEDFE(I,J)=CMATMUL(0,FEFED,FE,I,J)
          FETFESGTPE(I,J)=CMATMUL(0,FETFES,GTPE,I,J)
          LETLESGTPE(I,J)=CMATMUL(0,LETLES,GTPE,I,J)
          LULUDLU(I,J)=CMATMUL(0,LULUD,LU,I,J)
          LULUDLD(I,J)=CMATMUL(0,LULUD,LD,I,J)
          LDLDDLU(I,J)=CMATMUL(0,LDLDD,LU,I,J)
          LDLDDLD(I,J)=CMATMUL(0,LDLDD,LD,I,J)
          LELEDLE(I,J)=CMATMUL(0,LELED,LE,I,J)
          FTUQFUDFU(I,J)=CMATMUL(0,FTUQ,FUDFU,I,J)
          FTUQLUDLU(I,J)=CMATMUL(0,FTUQ,LUDLU,I,J)
          FTDQFDDFD(I,J)=CMATMUL(0,FTDQ,FDDFD,I,J)
          FTDQLDDLD(I,J)=CMATMUL(0,FTDQ,LDDLD,I,J)
          FTELFEDFE(I,J)=CMATMUL(0,FTEL,FEDFE,I,J)
          FTELLEDLE(I,J)=CMATMUL(0,FTEL,LEDLE,I,J)
          FTUQFUDFTDD(I,J)=CMATMUL(0,FTUQ,FUDFTDD,I,J)
          FTUQLUDFTDD(I,J)=CMATMUL(0,FTUQ,LUDFTDD,I,J)
          FTDQFDDFTUU(I,J)=CMATMUL(0,FTDQ,FDDFTUU,I,J)
          FTDQLDDFTUU(I,J)=CMATMUL(0,FTDQ,LDDFTUU,I,J)
          GTPQSFUGTPUS(I,J)=CMATMUL(0,GTPQS,FUGTPUS,I,J)
          GTPQSLUGTPUS(I,J)=CMATMUL(0,GTPQS,LUGTPUS,I,J)
          GTSQSFUGTSUS(I,J)=CMATMUL(0,GTSQS,FUGTSUS,I,J)
          GTSQSLUGTSUS(I,J)=CMATMUL(0,GTSQS,LUGTSUS,I,J)
          GTPQSFDGTPDS(I,J)=CMATMUL(0,GTPQS,FDGTPDS,I,J)
          GTPQSLDGTPDS(I,J)=CMATMUL(0,GTPQS,LDGTPDS,I,J)
          GTSQSFDGTSDS(I,J)=CMATMUL(0,GTSQS,FDGTSDS,I,J)
          GTSQSLDGTSDS(I,J)=CMATMUL(0,GTSQS,LDGTSDS,I,J)
          GTPLSFEGTPES(I,J)=CMATMUL(0,GTPLS,FEGTPES,I,J)
          GTPLSLEGTPES(I,J)=CMATMUL(0,GTPLS,LEGTPES,I,J)
          SQFTUQDFTUQ(I,J)=CSFMUL(THSQ,FTUQD,FTUQ,I,J)
          SQFTUQTFTUQS(I,J)=CSFMUL(THSQ,FTUQT,FTUQS,I,J)
          SQFTUQTGTQ(I,J)=CSFMUL(THSQ,FTUQT,GTQ,I,J)
          SQFTUQTGTPQ(I,J)=CSFMUL(THSQ,FTUQT,GTPQ,I,J)
          SQFTUQTGTSQ(I,J)=CSFMUL(THSQ,FTUQT,GTSQ,I,J)
          SQFTDQDFTDQ(I,J)=CSFMUL(THSQ,FTDQD,FTDQ,I,J)
          SQFTDQTFTDQS(I,J)=CSFMUL(THSQ,FTDQT,FTDQS,I,J)
          SQFTDQTGTQ(I,J)=CSFMUL(THSQ,FTDQT,GTQ,I,J)
          SQFTDQTGTPQ(I,J)=CSFMUL(THSQ,FTDQT,GTPQ,I,J)
          SQFTDQTGTSQ(I,J)=CSFMUL(THSQ,FTDQT,GTSQ,I,J)
          SQGTQTGTQS(I,J)=CSFMUL(THSQ,GTQT,GTQS,I,J)
          SQGTQTFTUQ(I,J)=CSFMUL(THSQ,GTQT,FTUQ,I,J)
          SQGTQTFTDQ(I,J)=CSFMUL(THSQ,GTQT,FTDQ,I,J)
          SQGTQDGTQ(I,J)=CSFMUL(THSQ,GTQD,GTQ,I,J)
          SQGTPQTGTPQS(I,J)=CSFMUL(THSQ,GTPQT,GTPQS,I,J)
          SQGTPQTFTUQ(I,J)=CSFMUL(THSQ,GTPQT,FTUQ,I,J)
          SQGTPQTFTDQ(I,J)=CSFMUL(THSQ,GTPQT,FTDQ,I,J)
          SQGTPQDGTPQ(I,J)=CSFMUL(THSQ,GTPQD,GTPQ,I,J)
          SQGTSQTGTSQS(I,J)=CSFMUL(THSQ,GTSQT,GTSQS,I,J)
          SQGTSQTFTUQ(I,J)=CSFMUL(THSQ,GTSQT,FTUQ,I,J)
          SQGTSQTFTDQ(I,J)=CSFMUL(THSQ,GTSQT,FTDQ,I,J)
          SQGTSQDGTSQ(I,J)=CSFMUL(THSQ,GTSQD,GTSQ,I,J)
          SDMTSFDSADT(I,J)=CSFMUL(THSD,MTSFDS,ADT,I,J)
          SUFTUUFTUUD(I,J)=CSFMUL(THSU,FTUU,FTUUD,I,J)
          SUFTUUSFTUUT(I,J)=CSFMUL(THSU,FTUUS,FTUUT,I,J)
          SUFTUUGTPUT(I,J)=CSFMUL(THSU,FTUU,GTPUT,I,J)
          SUFTUUGTSUT(I,J)=CSFMUL(THSU,FTUU,GTSUT,I,J)
          SUGTPUFTUUT(I,J)=CSFMUL(THSU,GTPU,FTUUT,I,J)
          SUGTPUSGTPUT(I,J)=CSFMUL(THSU,GTPUS,GTPUT,I,J)
          SUGTPUGTPUD(I,J)=CSFMUL(THSU,GTPU,GTPUD,I,J)
          SUGTSUGTSUD(I,J)=CSFMUL(THSU,GTSU,GTSUD,I,J)
          SUGTSUSGTSUT(I,J)=CSFMUL(THSU,GTSUS,GTSUT,I,J)
          SUGTSUFTUUT(I,J)=CSFMUL(THSU,GTSU,FTUUT,I,J)
          SUMTSFUSAUT(I,J)=CSFMUL(THSU,MTSFUS,AUT,I,J)
          SDFTDDFTDDD(I,J)=CSFMUL(THSD,FTDD,FTDDD,I,J)
          SDFTDDSFTDDT(I,J)=CSFMUL(THSD,FTDDS,FTDDT,I,J)
          SDFTDDGTPDT(I,J)=CSFMUL(THSD,FTDD,GTPDT,I,J)
          SDFTDDGTSDT(I,J)=CSFMUL(THSD,FTDD,GTSDT,I,J)
          SDGTPDFTDDT(I,J)=CSFMUL(THSD,GTPD,FTDDT,I,J)
          SDGTPDSGTPDT(I,J)=CSFMUL(THSD,GTPDS,GTPDT,I,J)
          SDGTPDGTPDD(I,J)=CSFMUL(THSD,GTPD,GTPDD,I,J)
          SDGTSDFTDDT(I,J)=CSFMUL(THSD,GTSD,FTDDT,I,J)
          SDGTSDGTSDD(I,J)=CSFMUL(THSD,GTSD,GTSDD,I,J)
          SDGTSDSGTSDT(I,J)=CSFMUL(THSD,GTSDS,GTSDT,I,J)
          SLFTELDFTEL(I,J)=CSFMUL(THSL,FTELD,FTEL,I,J)
          SLFTELTFTELS(I,J)=CSFMUL(THSL,FTELT,FTELS,I,J)
          SLFTELTGTL(I,J)=CSFMUL(THSL,FTELT,GTL,I,J)
          SLFTELTGTPL(I,J)=CSFMUL(THSL,FTELT,GTPL,I,J)
          SLGTLTGTLS(I,J)=CSFMUL(THSL,GTLT,GTLS,I,J)
          SLGTLTFTEL(I,J)=CSFMUL(THSL,GTLT,FTEL,I,J)
          SLGTLDGTL(I,J)=CSFMUL(THSL,GTLD,GTL,I,J)
          SLGTPLTGTPLS(I,J)=CSFMUL(THSL,GTPLT,GTPLS,I,J)
          SLGTPLDGTPL(I,J)=CSFMUL(THSL,GTPLD,GTPL,I,J)
          SLGTPLTFTEL(I,J)=CSFMUL(THSL,GTPLT,FTEL,I,J)
          SEMTSFESAET(I,J)=CSFMUL(THSE,MTSFES,AET,I,J)
          SEFTEEFTEED(I,J)=CSFMUL(THSE,FTEE,FTEED,I,J)
          SEFTEESFTEET(I,J)=CSFMUL(THSE,FTEES,FTEET,I,J)
          SEFTEEGTPET(I,J)=CSFMUL(THSE,FTEE,GTPET,I,J)
          SEGTPEFTEET(I,J)=CSFMUL(THSE,GTPE,FTEET,I,J)
          SEGTPESGTPET(I,J)=CSFMUL(THSE,GTPES,GTPET,I,J)
          SEGTPEGTPED(I,J)=CSFMUL(THSE,GTPE,GTPED,I,J)
        END DO
      END DO
      IF(THHH.EQ.0)THEN
        DO I=1,3
          DO J=1,3
            SFUQDSFUQ(I,J)=CMATMUL(1,SFUQ,SFUQ,I,J)
            SFUURSFUURD(I,J)=CMATMUL(2,SFUUR,SFUUR,I,J)
            SFUQDCFDQ(I,J)=CMATMUL(1,SFUQ,CFDQ,I,J)
            CFDDRCFDDRD(I,J)=CMATMUL(2,CFDDR,CFDDR,I,J)
            CFDQDCFDQ(I,J)=CMATMUL(1,CFDQ,CFDQ,I,J)
            CFDQDSFUQ(I,J)=CMATMUL(1,CFDQ,SFUQ,I,J)
            CFEERCFEERD(I,J)=CMATMUL(2,CFEER,CFEER,I,J)
            CFELDCFEL(I,J)=CMATMUL(1,CFEL,CFEL,I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            SFUQTSFUQS(I,J)=SFUQDSFUQ(J,I)
            SFUURSSFUURT(I,J)=SFUURSFUURD(J,I)
            CFDDRSCFDDRT(I,J)=CFDDRCFDDRD(J,I)
            CFDQTCFDQS(I,J)=CFDQDCFDQ(J,I)
            CFEERSCFEERT(I,J)=CFEERCFEERD(J,I)
            CFELTCFELS(I,J)=CFELDCFEL(J,I)
          END DO
        END DO
      END IF
!
!These are the two loop terms. All in MV notation
!
      IF(SW2LP.EQ.1)THEN
!
        THDYDD=CTRACE(HDYDD)
        THEYED=CTRACE(HEYED)
        THUDYU=CTRACE(HUDYU)
        THDDYD=CTRACE(HDDYD)
        THEDYE=CTRACE(HEDYE)
        THUDHU=CTRACE(HUDHU)
!
        DO I=1,3
          DO J=1,3
            YUDYUMQM(I,J)=CMATMUL(0,YUDYU,MQM,I,J)
            YDDYDMQM(I,J)=CMATMUL(0,YDDYD,MQM,I,J)
            MQMYUDYU(I,J)=CMATMUL(0,MQM,YUDYU,I,J)
            MQMYDDYD(I,J)=CMATMUL(0,MQM,YDDYD,I,J)
            MLMYEDYE(I,J)=CMATMUL(0,MLM,YEDYE,I,J)
            YUDYUYDD(I,J)=CMATMUL(2,YUDYU,YD,I,J)
            YUMQMYDD(I,J)=CMATMUL(2,YUMQM,YD,I,J)
            YUYDDMDM(I,J)=CMATMUL(0,YUYDD,MDM,I,J)
            YDMQMYUD(I,J)=CMATMUL(2,YDMQM,YU,I,J)
            YDYUDMUPM(I,J)=CMATMUL(0,YDYUD,MUPM,I,J)
            YDMQMYUD(I,J)=CMATMUL(2,YDMQM,YU,I,J)
          END DO
        END DO
!
        DO I=1,3
          DO J=1,3
            YUYUDYUYUD(I,J)=CMATMUL(0,YUYUD,YUYUD,I,J)
            YDYDDYDYDD(I,J)=CMATMUL(0,YDYDD,YDYDD,I,J)
            YEYEDYEYED(I,J)=CMATMUL(0,YEYED,YEYED,I,J)
            YUDYUYUDYU(I,J)=CMATMUL(0,YUDYU,YUDYU,I,J)
            YDDYDYDDYD(I,J)=CMATMUL(0,YDDYD,YDDYD,I,J)
            YEDYEYEDYE(I,J)=CMATMUL(0,YEDYE,YEDYE,I,J)
            YDDYDYUDYU(I,J)=CMATMUL(0,YDDYD,YUDYU,I,J)
            YUDYUYDDYD(I,J)=CMATMUL(0,YUDYU,YDDYD,I,J)
            YUYDDYDYUD(I,J)=CMATMUL(0,YUYDD,YDYUD,I,J)
            YDYUDYUYDD(I,J)=CMATMUL(0,YDYUD,YUYDD,I,J)
!
            HUYUDYUYUD(I,J)=CMATMUL(0,HUYUD,YUYUD,I,J)
            HUYDDYDYUD(I,J)=CMATMUL(0,HUYDD,YDYUD,I,J)
            HDYUDYUYDD(I,J)=CMATMUL(0,HDYUD,YUYDD,I,J)
            HDYDDYDYDD(I,J)=CMATMUL(0,HDYDD,YDYDD,I,J)
            HEYEDYEYED(I,J)=CMATMUL(0,HEYED,YEYED,I,J)
            YUDYUYUDHU(I,J)=CMATMUL(0,YUDYU,YUDHU,I,J)
            YUDHUYUDYU(I,J)=CMATMUL(0,YUDHU,YUDYU,I,J)
            YDDYDYDDHD(I,J)=CMATMUL(0,YDDYD,YDDHD,I,J)
            YDDHDYDDYD(I,J)=CMATMUL(0,YDDHD,YDDYD,I,J)
            YDDYDYUDHU(I,J)=CMATMUL(0,YDDYD,YUDHU,I,J)
            YDDHDYUDYU(I,J)=CMATMUL(0,YDDHD,YUDYU,I,J)
            YUDHUYDDYD(I,J)=CMATMUL(0,YUDHU,YDDYD,I,J)
            YUDYUYDDHD(I,J)=CMATMUL(0,YUDYU,YDDHD,I,J)
            YEDYEYEDHE(I,J)=CMATMUL(0,YEDYE,YEDHE,I,J)
            YEDHEYEDYE(I,J)=CMATMUL(0,YEDHE,YEDYE,I,J)
            HUDHUYUDYU(I,J)=CMATMUL(0,HUDHU,YUDYU,I,J)
            HUDYUYUDHU(I,J)=CMATMUL(0,HUDYU,YUDHU,I,J)
            HDDHDYDDYD(I,J)=CMATMUL(0,HDDHD,YDDYD,I,J)
            HDDYDYDDHD(I,J)=CMATMUL(0,HDDYD,YDDHD,I,J)
            HDDHDYUDYU(I,J)=CMATMUL(0,HDDHD,YUDYU,I,J)
            YDDYDHUDHU(I,J)=CMATMUL(0,YDDYD,HUDHU,I,J)
            HDDYDYUDHU(I,J)=CMATMUL(0,HDDYD,YUDHU,I,J)
            YDDHDHUDYU(I,J)=CMATMUL(0,YDDHD,HUDYU,I,J)
            HUDHUYDDYD(I,J)=CMATMUL(0,HUDHU,YDDYD,I,J)
            YUDYUHDDHD(I,J)=CMATMUL(0,YUDYU,HDDHD,I,J)
            HUDYUYDDHD(I,J)=CMATMUL(0,HUDYU,YDDHD,I,J)
            YUDHUHDDYD(I,J)=CMATMUL(0,YUDHU,HDDYD,I,J)
            HEDHEYEDYE(I,J)=CMATMUL(0,HEDHE,YEDYE,I,J)
            HEDYEYEDHE(I,J)=CMATMUL(0,HEDYE,YEDHE,I,J)
            YUDYUHUDHU(I,J)=CMATMUL(0,YUDYU,HUDHU,I,J)
            YDDYDHDDHD(I,J)=CMATMUL(0,YDDYD,HDDHD,I,J)
            YUDHUHUDYU(I,J)=CMATMUL(0,YUDHU,HUDYU,I,J)
            YDDHDHDDYD(I,J)=CMATMUL(0,YDDHD,HDDYD,I,J)
            YEDYEHEDHE(I,J)=CMATMUL(0,YEDYE,HEDHE,I,J)
            YEDHEHEDYE(I,J)=CMATMUL(0,YEDHE,HEDYE,I,J)
            HUHUDYUYUD(I,J)=CMATMUL(0,HUHUD,YUYUD,I,J)
            YUYUDHUHUD(I,J)=CMATMUL(0,YUYUD,HUHUD,I,J)
            HUYUDYUHUD(I,J)=CMATMUL(0,HUYUD,YUHUD,I,J)
            YUHUDHUYUD(I,J)=CMATMUL(0,YUHUD,HUYUD,I,J)
            HUHDDYDYUD(I,J)=CMATMUL(0,HUHDD,YDYUD,I,J)
            YUYDDHDHUD(I,J)=CMATMUL(0,YUYDD,HDHUD,I,J)
            HUYDDYDHUD(I,J)=CMATMUL(0,HUYDD,YDHUD,I,J)
            YUHDDHDYUD(I,J)=CMATMUL(0,YUHDD,HDYUD,I,J)
            HDHDDYDYDD(I,J)=CMATMUL(0,HDHDD,YDYDD,I,J)
            YDYDDHDHDD(I,J)=CMATMUL(0,YDYDD,HDHDD,I,J)
            HDYDDYDHDD(I,J)=CMATMUL(0,HDYDD,YDHDD,I,J)
            YDHDDHDYDD(I,J)=CMATMUL(0,YDHDD,HDYDD,I,J)
            HDHUDYUYDD(I,J)=CMATMUL(0,HDHUD,YUYDD,I,J)
            YDYUDHUHDD(I,J)=CMATMUL(0,YDYUD,HUHDD,I,J)
            HDYUDYUHDD(I,J)=CMATMUL(0,HDYUD,YUHDD,I,J)
            YDHUDHUYDD(I,J)=CMATMUL(0,YDHUD,HUYDD,I,J)
            HEHEDYEYED(I,J)=CMATMUL(0,HEHED,YEYED,I,J)
            YEYEDHEHED(I,J)=CMATMUL(0,YEYED,HEHED,I,J)
            HEYEDYEHED(I,J)=CMATMUL(0,HEYED,YEHED,I,J)
            YEHEDHEYED(I,J)=CMATMUL(0,YEHED,HEYED,I,J)
!
            YUDMUPMYUYUDYU(I,J)=CMATMUL(0,YUDMUPMYU,YUDYU,I,J)
            YUDMUPMYUYDDYD(I,J)=CMATMUL(0,YUDMUPMYU,YDDYD,I,J)
            YUDYUMQMYDDYD(I,J)=CMATMUL(0,YUDYUMQM,YDDYD,I,J)
            YUDYUYDDMDMYD(I,J)=CMATMUL(0,YUDYUYDD,MDMYD,I,J)
            YDDMDMYDYDDYD(I,J)=CMATMUL(0,YDDMDMYD,YDDYD,I,J)
            YEDMEMYEYEDYE(I,J)=CMATMUL(0,YEDMEMYE,YEDYE,I,J)
            YUDYUMQMYUDYU(I,J)=CMATMUL(0,YUDYUMQM,YUDYU,I,J)
            YUDYUYUDMUPMYU(I,J)=CMATMUL(0,YUDYU,YUDMUPMYU,I,J)
            YUDYUYUDYUMQM(I,J)=CMATMUL(0,YUDYU,YUDYUMQM,I,J)
            YDDYDMQMYDDYD(I,J)=CMATMUL(0,YDDYDMQM,YDDYD,I,J)
            YDDYDYDDMDMYD(I,J)=CMATMUL(0,YDDYD,YDDMDMYD,I,J)
            YDDYDYDDYDMQM(I,J)=CMATMUL(0,YDDYD,YDDYDMQM,I,J)
            YEDYEMLMYEDYE(I,J)=CMATMUL(0,YEDYEMLM,YEDYE,I,J)
            YEDYEYEDMEMYE(I,J)=CMATMUL(0,YEDYE,YEDMEMYE,I,J)
            YEDYEYEDYEMLM(I,J)=CMATMUL(0,YEDYE,YEDYEMLM,I,J)
            YUMQMYUDYUYUD(I,J)=CMATMUL(0,YUMQMYUD,YUYUD,I,J)
            YUYUDMUPMYUYUD(I,J)=CMATMUL(0,YUYUDMUPM,YUYUD,I,J)
            YUYUDYUMQMYUD(I,J)=CMATMUL(0,YUYUD,YUMQMYUD,I,J)
            YUYUDYUYUDMUPM(I,J)=CMATMUL(0,YUYUD,YUYUDMUPM,I,J)
            YUMQMYDDYDYUD(I,J)=CMATMUL(0,YUMQMYDD,YDYUD,I,J)
            YUYDDMDMYDYUD(I,J)=CMATMUL(0,YUYDDMDM,YDYUD,I,J)
            YUYDDYDMQMYUD(I,J)=CMATMUL(0,YUYDD,YDMQMYUD,I,J)
            YUYDDYDYUDMUPM(I,J)=CMATMUL(0,YUYDD,YDYUDMUPM,I,J)
            YDMQMYDDYDYDD(I,J)=CMATMUL(0,YDMQMYDD,YDYDD,I,J)
            YDYDDMDMYDYDD(I,J)=CMATMUL(0,YDYDDMDM,YDYDD,I,J)
            YDYDDYDMQMYDD(I,J)=CMATMUL(0,YDYDD,YDMQMYDD,I,J)
            YDYDDYDYDDMDM(I,J)=CMATMUL(0,YDYDD,YDYDDMDM,I,J)
            YDMQMYUDYUYDD(I,J)=CMATMUL(0,YDMQMYUD,YUYDD,I,J)
            YDYUDMUPMYUYDD(I,J)=CMATMUL(0,YDYUDMUPM,YUYDD,I,J)
            YDYUDYUMQMYDD(I,J)=CMATMUL(0,YDYUD,YUMQMYDD,I,J)
            YDYUDYUYDDMDM(I,J)=CMATMUL(0,YDYUD,YUYDDMDM,I,J)
            YEMLMYEDYEYED(I,J)=CMATMUL(0,YEMLMYED,YEYED,I,J)
            YEYEDMEMYEYED(I,J)=CMATMUL(0,YEYEDMEM,YEYED,I,J)
            YEYEDYEMLMYED(I,J)=CMATMUL(0,YEYED,YEMLMYED,I,J)
            YEYEDYEYEDMEM(I,J)=CMATMUL(0,YEYED,YEYEDMEM,I,J)
          END DO
        END DO
!
        TYUDYUYUDYU=CTRACE(YUDYUYUDYU)
        TYUDYUYDDYD=CTRACE(YUDYUYDDYD)
        TYDDYDYUDYU=CTRACE(YDDYDYUDYU)
        TYDDYDYDDYD=CTRACE(YDDYDYDDYD)
        TYEDYEYEDYE=CTRACE(YEDYEYEDYE)
!
!These are SM terms for the two loop running below m_H
!I am going to use LYU for the MV notation SM Yukawa
!
        IF(THHH.EQ.0)THEN
          DO I=1,3
            DO J=1,3
              LYU(I,J)=LU(J,I)
              LYD(I,J)=LD(J,I)
              LYE(I,J)=LE(J,I)
            END DO
          END DO
          DO I=1,3
            DO J=1,3
              LYUDLYU(I,J)=CMATMUL(1,LYU,LYU,I,J)
              LYDDLYD(I,J)=CMATMUL(1,LYD,LYD,I,J)
              LYEDLYE(I,J)=CMATMUL(1,LYE,LYE,I,J)
            END DO
          END DO
          TLYUDLYU=CTRACE(LYUDLYU)
          TLYDDLYD=CTRACE(LYDDLYD)
          TLYEDLYE=CTRACE(LYEDLYE)
          DO I=1,3
            DO J=1,3
              LYUDLYU2(I,J)=CMATMUL(0,LYUDLYU,LYUDLYU,I,J)
              LYDDLYD2(I,J)=CMATMUL(0,LYDDLYD,LYDDLYD,I,J)
              LYEDLYE2(I,J)=CMATMUL(0,LYEDLYE,LYEDLYE,I,J)
              LYUDLYULYDDLYD(I,J)=CMATMUL(0,LYUDLYU,LYDDLYD,I,J)
              LYDDLYDLYUDLYU(I,J)=CMATMUL(0,LYDDLYD,LYUDLYU,I,J)
              DUMLUD1(I,J)=LYUDLYU(I,J)+LYDDLYD(I,J)
            END DO
          END DO
          TLYUDLYU2=CTRACE(LYUDLYU2)
          TLYDDLYD2=CTRACE(LYDDLYD2)
          TLYEDLYE2=CTRACE(LYEDLYE2)
          DO I=1,3
            DO J=1,3
              DUMLUD2(I,J)=CMATMUL(0,DUMLUD1,LYDDLYD,I,J)
            END DO
          END DO
          DO I=1,3
            DO J=1,3
              LYUDLYU3(I,J)=CMATMUL(0,LYUDLYU2,LYUDLYU,I,J)
              LYDDLYD3(I,J)=CMATMUL(0,LYDDLYD2,LYDDLYD,I,J)
              LYEDLYE3(I,J)=CMATMUL(0,LYEDLYE2,LYEDLYE,I,J)
              DUMLUD(I,J)=CMATMUL(0,LYUDLYU,DUMLUD2,I,J)
            END DO
          END DO
          TLYUDLYU3=CTRACE(LYUDLYU3)
          TLYDDLYD3=CTRACE(LYDDLYD3)
          TLYEDLYE3=CTRACE(LYEDLYE3)
          TLYUDLYULYDDLYD=CTRACE(LYUDLYULYDDLYD)
          TDUMLUD=CTRACE(DUMLUD)
!
          Y2=3.D0*TLYUDLYU+3.D0*TLYDDLYD+TLYEDLYE
          H=3.D0*TLYUDLYU2+3.D0*TLYDDLYD2+TLYEDLYE2
          Y4=(83.D0/40.D0*G(1)**2+27.D0/8.D0*G(2)**2
     $       +28.D0*G(3)**2)*TLYUDLYU+(-1.D0/40.D0*G(1)**2
     $       +27.D0/8.D0*G(2)**2+28.D0*G(3)**2)*TLYDDLYD
     $       +(93.D0/40.D0*G(1)**2+9.D0/8.D0*G(2)**2)*TLYEDLYE
          CHI4=9.D0/4.D0*(3.D0*TLYUDLYU2+3.D0*TLYDDLYD2+TLYEDLYE2
     $         -2.D0/3.D0*TLYUDLYULYDDLYD)
        END IF
      ELSE
        THDYDD=(0.D0,0.D0)
        THEYED=(0.D0,0.D0)
        THUDYU=(0.D0,0.D0)
        THDDYD=(0.D0,0.D0)
        THEDYE=(0.D0,0.D0)
        THUDHU=(0.D0,0.D0)
!
        DO I=1,3
          DO J=1,3
            YUDYUMQM(I,J)=(0.D0,0.D0)
            YDDYDMQM(I,J)=(0.D0,0.D0)
            MQMYUDYU(I,J)=(0.D0,0.D0)
            MQMYDDYD(I,J)=(0.D0,0.D0)
            MLMYEDYE(I,J)=(0.D0,0.D0)
            YUDYUYDD(I,J)=(0.D0,0.D0)
            YUMQMYDD(I,J)=(0.D0,0.D0)
            YUYDDMDM(I,J)=(0.D0,0.D0)
            YDMQMYUD(I,J)=(0.D0,0.D0)
            YDYUDMUPM(I,J)=(0.D0,0.D0)
            YDMQMYUD(I,J)=(0.D0,0.D0)
          END DO
        END DO
!
        DO I=1,3
          DO J=1,3
            YUYUDYUYUD(I,J)=(0.D0,0.D0)
            YDYDDYDYDD(I,J)=(0.D0,0.D0)
            YEYEDYEYED(I,J)=(0.D0,0.D0)
            YUDYUYUDYU(I,J)=(0.D0,0.D0)
            YDDYDYDDYD(I,J)=(0.D0,0.D0)
            YEDYEYEDYE(I,J)=(0.D0,0.D0)
            YDDYDYUDYU(I,J)=(0.D0,0.D0)
            YUDYUYDDYD(I,J)=(0.D0,0.D0)
            YUYDDYDYUD(I,J)=(0.D0,0.D0)
            YDYUDYUYDD(I,J)=(0.D0,0.D0)
!
            HUYUDYUYUD(I,J)=(0.D0,0.D0)
            HUYDDYDYUD(I,J)=(0.D0,0.D0)
            HDYUDYUYDD(I,J)=(0.D0,0.D0)
            HDYDDYDYDD(I,J)=(0.D0,0.D0)
            HEYEDYEYED(I,J)=(0.D0,0.D0)
            YUDYUYUDHU(I,J)=(0.D0,0.D0)
            YUDHUYUDYU(I,J)=(0.D0,0.D0)
            YDDYDYDDHD(I,J)=(0.D0,0.D0)
            YDDHDYDDYD(I,J)=(0.D0,0.D0)
            YDDYDYUDHU(I,J)=(0.D0,0.D0)
            YDDHDYUDYU(I,J)=(0.D0,0.D0)
            YUDHUYDDYD(I,J)=(0.D0,0.D0)
            YUDYUYDDHD(I,J)=(0.D0,0.D0)
            YEDYEYEDHE(I,J)=(0.D0,0.D0)
            YEDHEYEDYE(I,J)=(0.D0,0.D0)
            HUDHUYUDYU(I,J)=(0.D0,0.D0)
            HUDYUYUDHU(I,J)=(0.D0,0.D0)
            HDDHDYDDYD(I,J)=(0.D0,0.D0)
            HDDYDYDDHD(I,J)=(0.D0,0.D0)
            HDDHDYUDYU(I,J)=(0.D0,0.D0)
            YDDYDHUDHU(I,J)=(0.D0,0.D0)
            HDDYDYUDHU(I,J)=(0.D0,0.D0)
            YDDHDHUDYU(I,J)=(0.D0,0.D0)
            HUDHUYDDYD(I,J)=(0.D0,0.D0)
            YUDYUHDDHD(I,J)=(0.D0,0.D0)
            HUDYUYDDHD(I,J)=(0.D0,0.D0)
            YUDHUHDDYD(I,J)=(0.D0,0.D0)
            HEDHEYEDYE(I,J)=(0.D0,0.D0)
            HEDYEYEDHE(I,J)=(0.D0,0.D0)
            YUDYUHUDHU(I,J)=(0.D0,0.D0)
            YDDYDHDDHD(I,J)=(0.D0,0.D0)
            YUDHUHUDYU(I,J)=(0.D0,0.D0)
            YDDHDHDDYD(I,J)=(0.D0,0.D0)
            YEDYEHEDHE(I,J)=(0.D0,0.D0)
            YEDHEHEDYE(I,J)=(0.D0,0.D0)
            HUHUDYUYUD(I,J)=(0.D0,0.D0)
            YUYUDHUHUD(I,J)=(0.D0,0.D0)
            HUYUDYUHUD(I,J)=(0.D0,0.D0)
            YUHUDHUYUD(I,J)=(0.D0,0.D0)
            HUHDDYDYUD(I,J)=(0.D0,0.D0)
            YUYDDHDHUD(I,J)=(0.D0,0.D0)
            HUYDDYDHUD(I,J)=(0.D0,0.D0)
            YUHDDHDYUD(I,J)=(0.D0,0.D0)
            HDHDDYDYDD(I,J)=(0.D0,0.D0)
            YDYDDHDHDD(I,J)=(0.D0,0.D0)
            HDYDDYDHDD(I,J)=(0.D0,0.D0)
            YDHDDHDYDD(I,J)=(0.D0,0.D0)
            HDHUDYUYDD(I,J)=(0.D0,0.D0)
            YDYUDHUHDD(I,J)=(0.D0,0.D0)
            HDYUDYUHDD(I,J)=(0.D0,0.D0)
            YDHUDHUYDD(I,J)=(0.D0,0.D0)
            HEHEDYEYED(I,J)=(0.D0,0.D0)
            YEYEDHEHED(I,J)=(0.D0,0.D0)
            HEYEDYEHED(I,J)=(0.D0,0.D0)
            YEHEDHEYED(I,J)=(0.D0,0.D0)
!
            YUDMUPMYUYUDYU(I,J)=(0.D0,0.D0)
            YUDMUPMYUYDDYD(I,J)=(0.D0,0.D0)
            YUDYUMQMYDDYD(I,J)=(0.D0,0.D0)
            YUDYUYDDMDMYD(I,J)=(0.D0,0.D0)
            YDDMDMYDYDDYD(I,J)=(0.D0,0.D0)
            YEDMEMYEYEDYE(I,J)=(0.D0,0.D0)
            YUDYUMQMYUDYU(I,J)=(0.D0,0.D0)
            YUDYUYUDMUPMYU(I,J)=(0.D0,0.D0)
            YUDYUYUDYUMQM(I,J)=(0.D0,0.D0)
            YDDYDMQMYDDYD(I,J)=(0.D0,0.D0)
            YDDYDYDDMDMYD(I,J)=(0.D0,0.D0)
            YDDYDYDDYDMQM(I,J)=(0.D0,0.D0)
            YEDYEMLMYEDYE(I,J)=(0.D0,0.D0)
            YEDYEYEDMEMYE(I,J)=(0.D0,0.D0)
            YEDYEYEDYEMLM(I,J)=(0.D0,0.D0)
            YUMQMYUDYUYUD(I,J)=(0.D0,0.D0)
            YUYUDMUPMYUYUD(I,J)=(0.D0,0.D0)
            YUYUDYUMQMYUD(I,J)=(0.D0,0.D0)
            YUYUDYUYUDMUPM(I,J)=(0.D0,0.D0)
            YUMQMYDDYDYUD(I,J)=(0.D0,0.D0)
            YUYDDMDMYDYUD(I,J)=(0.D0,0.D0)
            YUYDDYDMQMYUD(I,J)=(0.D0,0.D0)
            YUYDDYDYUDMUPM(I,J)=(0.D0,0.D0)
            YDMQMYDDYDYDD(I,J)=(0.D0,0.D0)
            YDYDDMDMYDYDD(I,J)=(0.D0,0.D0)
            YDYDDYDMQMYDD(I,J)=(0.D0,0.D0)
            YDYDDYDYDDMDM(I,J)=(0.D0,0.D0)
            YDMQMYUDYUYDD(I,J)=(0.D0,0.D0)
            YDYUDMUPMYUYDD(I,J)=(0.D0,0.D0)
            YDYUDYUMQMYDD(I,J)=(0.D0,0.D0)
            YDYUDYUYDDMDM(I,J)=(0.D0,0.D0)
            YEMLMYEDYEYED(I,J)=(0.D0,0.D0)
            YEYEDMEMYEYED(I,J)=(0.D0,0.D0)
            YEYEDYEMLMYED(I,J)=(0.D0,0.D0)
            YEYEDYEYEDMEM(I,J)=(0.D0,0.D0)
          END DO
        END DO
!
        TYUDYUYUDYU=(0.D0,0.D0)
        TYUDYUYDDYD=(0.D0,0.D0)
        TYDDYDYUDYU=(0.D0,0.D0)
        TYDDYDYDDYD=(0.D0,0.D0)
        TYEDYEYEDYE=(0.D0,0.D0)
!
        IF(THHH.EQ.0)THEN
          DO I=1,3
            DO J=1,3
              LYU(I,J)=(0.D0,0.D0)
              LYD(I,J)=(0.D0,0.D0)
              LYE(I,J)=(0.D0,0.D0)
            END DO
          END DO
          DO I=1,3
            DO J=1,3
              LYUDLYU(I,J)=(0.D0,0.D0)
              LYDDLYD(I,J)=(0.D0,0.D0)
              LYEDLYE(I,J)=(0.D0,0.D0)
            END DO
          END DO
          TLYUDLYU=(0.D0,0.D0)
          TLYDDLYD=(0.D0,0.D0)
          TLYEDLYE=(0.D0,0.D0)
          DO I=1,3
            DO J=1,3
              LYUDLYU2(I,J)=(0.D0,0.D0)
              LYDDLYD2(I,J)=(0.D0,0.D0)
              LYEDLYE2(I,J)=(0.D0,0.D0)
              LYUDLYULYDDLYD(I,J)=(0.D0,0.D0)
              LYDDLYDLYUDLYU(I,J)=(0.D0,0.D0)
              DUMLUD1(I,J)=(0.D0,0.D0)
            END DO
          END DO
          TLYUDLYU2=(0.D0,0.D0)
          TLYDDLYD2=(0.D0,0.D0)
          TLYEDLYE2=(0.D0,0.D0)
          DO I=1,3
            DO J=1,3
              DUMLUD2(I,J)=(0.D0,0.D0)
            END DO
          END DO
          DO I=1,3
            DO J=1,3
              LYUDLYU3(I,J)=(0.D0,0.D0)
              LYDDLYD3(I,J)=(0.D0,0.D0)
              LYEDLYE3(I,J)=(0.D0,0.D0)
              DUMLUD(I,J)=(0.D0,0.D0)
            END DO
          END DO
          TLYUDLYU3=(0.D0,0.D0)
          TLYDDLYD3=(0.D0,0.D0)
          TLYEDLYE3=(0.D0,0.D0)
          TLYUDLYULYDDLYD=(0.D0,0.D0)
          TDUMLUD=(0.D0,0.D0)
!
          Y2=(0.D0,0.D0)
          H=(0.D0,0.D0)
          Y4=(0.D0,0.D0)
          CHI4=(0.D0,0.D0)
        END IF
      END IF
!
!Now I calculate the runnng of the MSSM gauge, yukawas and soft terms
!which will be kept intact for two loop running of fs, SUSY couplings
!and tildas.
!
      DO I=1,3
        SUM=(0.D0,0.D0)
        DO J=1,3
          SUM=SUM+B2LPM(I,J)*G(290+J)**2
        END DO
        F(290+I)=G(290+I)**3/16.D0/PI**2*(B1LPM(I)
     $           +DBLE(SW2LP)/16.D0/PI**2*(SUM-(CM(I,1)*TYUDYU
     $           +CM(I,2)*TYDDYD+CM(I,3)*TYEDYE)))
        B2GM(I)=G(290+I)**3*DBLE(SW2LP)*(SUM-(CM(I,1)*TYUDYU
     $          +CM(I,2)*TYDDYD+CM(I,3)*TYEDYE))
      END DO
!
      DO I=1,3
        DO J=1,3
          DUM1U1(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
          DUM1D1(I,J)=DUM1U1(I,J)
          DUM1E1(I,J)=DUM1U1(I,J)
          IF(SW2LP.EQ.1)THEN
            DUM2U1(I,J)=3.D0*YUYUDYUYUD(I,J)+YUYDDYDYUD(I,J)
            DUM2U2(I,J)=DUM1D1(I,J)
            DUM2D1(I,J)=3.D0*YDYDDYDYDD(I,J)+YUYDDYDYUD(I,J)+
     $                  YEYEDYEYED(I,J)
            DUM2D2(I,J)=DUM1D1(I,J)
            DUM2E1(I,J)=DUM2D1(I,J)
            DUM2E2(I,J)=DUM2U2(I,J)
          ELSE
            DUM2U1(I,J)=(0.D0,0.D0)
            DUM2U2(I,J)=(0.D0,0.D0)
            DUM2D1(I,J)=(0.D0,0.D0)
            DUM2D2(I,J)=(0.D0,0.D0)
            DUM2E1(I,J)=(0.D0,0.D0)
            DUM2E2(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
      DO I=1,3
        DO J=1,3
          DUM1U(I,J)=3.D0*TYUDYU*ID(I,J)+3.D0*YUDYU(I,J)+YDDYD(I,J)
     $               +(-16.D0/3.D0*G(293)**2-3.D0*G(292)**2
     $               -13.D0/15.D0*G(291)**2)*ID(I,J)              
          DUM1D(I,J)=CTRACE(DUM1D1)*ID(I,J)+3.D0*YDDYD(I,J)+YUDYU(I,J)
     $               +(-16.D0/3.D0*G(293)**2-3.D0*G(292)**2
     $               -7.D0/15.D0*G(291)**2)*ID(I,J)
          DUM1E(I,J)=CTRACE(DUM1E1)*ID(I,J)+3.D0*YEDYE(I,J)+(-3.D0
     $               *G(292)**2-9.D0/5.D0*G(291)**2)*ID(I,J)
!
!Here are the two loop terms
!
          IF(SW2LP.EQ.1)THEN
            DUM2U(I,J)=-3.D0*CTRACE(DUM2U1)*ID(I,J)-YDDYD(I,J)
     $                 *CTRACE(DUM2U2)-9.D0*YUDYU(I,J)*TYUDYU
     $                 -4.D0*YUDYUYUDYU(I,J)-2.D0*YDDYDYDDYD(I,J)-2.D0
     $                 *YDDYDYUDYU(I,J)+(16.D0*G(293)**2+4.D0/5.D0
     $                 *G(291)**2)*TYUDYU*ID(I,J)+(6.D0*G(292)**2
     $                 +2.D0/5.D0*G(291)**2)*YUDYU(I,J)+2.D0/5.D0
     $                 *G(291)**2*YDDYD(I,J)+(-16.D0/9.D0*G(293)**4
     $                 +8.D0*G(293)**2*G(292)**2+136.D0/45.D0
     $                 *G(293)**2*G(291)**2+15.D0/2.D0*G(292)**4
     $                 +G(292)**2*G(291)**2+2743.D0/450.D0
     $                 *G(291)**4)*ID(I,J)
            DUM2D(I,J)=-3.D0*CTRACE(DUM2D1)*ID(I,J)-3.D0*YUDYU(I,J)
     $                 *TYUDYU-3.D0*YDDYD(I,J)*CTRACE(DUM2D2)
     $                 -4.D0*YDDYDYDDYD(I,J)-2.D0*YUDYUYUDYU(I,J)
     $                 -2.D0*YUDYUYDDYD(I,J)+(16.D0*G(293)**2
     $                 -2.D0/5.D0*G(291)**2)*TYDDYD*ID(I,J)+6.D0/5.D0
     $                 *G(291)**2*TYEDYE*ID(I,J)+4.D0/5.D0*G(291)**2
     $                 *YUDYU(I,J)+(6.D0*G(292)**2+4.D0/5.D0
     $                 *G(291)**2)*YDDYD(I,J)+(-16.D0/9.D0*G(293)**4
     $                 +8.D0*G(293)**2*G(292)**2+8.D0/9.D0
     $                 *G(293)**2*G(291)**2+15.D0/2.D0*G(292)**4
     $                 +G(292)**2*G(291)**2+287.D0/90.D0
     $                 *G(291)**4)*ID(I,J)
            DUM2E(I,J)=-3.D0*CTRACE(DUM2E1)*ID(I,J)-3.D0*YEDYE(I,J)
     $                 *CTRACE(DUM2E2)-4.D0*YEDYEYEDYE(I,J)+(16.D0
     $                 *G(293)**2-2.D0/5.D0*G(291)**2)*TYDDYD
     $                 *ID(I,J)+6.D0/5.D0*G(291)**2*TYEDYE*ID(I,J)
     $                 +6.D0*G(292)**2*YEDYE(I,J)+(15.D0/2.D0
     $                 *G(292)**4+9.D0/5.D0*G(292)**2*G(291)**2
     $                 +27.D0/2.D0*G(291)**4)*ID(I,J)
          ELSE
            DUM2U(I,J)=(0.D0,0.D0)
            DUM2D(I,J)=(0.D0,0.D0)
            DUM2E(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
!Now calculate the beta functions for the Yukawas
!
      DO I=1,3
        DO J=1,3
          B1YMU(I,J)=CMATMUL(0,YU,DUM1U,I,J)
          B1YMD(I,J)=CMATMUL(0,YD,DUM1D,I,J)
          B1YME(I,J)=CMATMUL(0,YE,DUM1E,I,J)
          IF(SW2LP.EQ.1)THEN
            B2YMU(I,J)=CMATMUL(0,YU,DUM2U,I,J)
            B2YMD(I,J)=CMATMUL(0,YD,DUM2D,I,J)
            B2YME(I,J)=CMATMUL(0,YE,DUM2E,I,J)
          END IF
        END DO
      END DO
!
!Convert to differentials
!
      DO I=1,3
        DO J=1,3
        F(293+(I-1)*3+J)=1.D0/16.D0/PI**2*B1YMU(J,I)
     $                   +1.D0/(16.D0*PI**2)**2*B2YMU(J,I)
        F(302+(I-1)*3+J)=1.D0/16.D0/PI**2*B1YMD(J,I)
     $                   +1.D0/(16.D0*PI**2)**2*B2YMD(J,I)
        F(311+(I-1)*3+J)=1.D0/16.D0/PI**2*B1YME(J,I)
     $                   +1.D0/(16.D0*PI**2)**2*B2YME(J,I)
        END DO
      END DO
!
!Similarly, the MSSM Gaugino mass parameters are:
!
      DO I=1,3
        SUM=(0.D0,0.D0)
        DO J=1,3
          SUM=SUM+B2LPM(I,J)*G(290+J)**2*(G(320+I)+G(320+J))
        END DO
        IF(SW2LP.EQ.1)THEN
          B2M(I)=2.D0*G(290+I)**2*(SUM+CM(I,1)*(TYUDHU-G(320+I)
     $           *TYUDYU)+CM(I,2)*(TYDDHD-G(320+I)*TYDDYD)+CM(I,3)
     $           *(TYEDHE-G(320+I)*TYEDYE))
        END IF
        F(320+I)=2.D0*G(290+I)**2/16.D0/PI**2*B1LPM(I)*G(320+I)
     $          +1.D0/(16.D0*PI**2)**2*B2M(I)
      END DO
!
!And here is the MSSM \mu
!
      DO I=1,3
        DO J=1,3
          DUMGRKMU1(I,J)=3.D0*YUYUD(I,J)+3.D0*YDYDD(I,J)+YEYED(I,J)
          DUM1B1(I,J)=3.D0*YUYUD(I,J)+3.D0*YDYDD(I,J)+YEYED(I,J)
          DUM1B2(I,J)=6.D0*HUYUD(I,J)+6.D0*HDYDD(I,J)+2.D0*HEYED(I,J)
          IF(SW2LP.EQ.1)THEN
            DUM2B1(I,J)=3.D0*YUYUDYUYUD(I,J)+3.D0*YDYDDYDYDD(I,J)
     $                  +2.D0*YUYDDYDYUD(I,J)+YEYEDYEYED(I,J)
            DUM2B2(I,J)=3.D0*HUYUDYUYUD(I,J)+3.D0*HDYDDYDYDD(I,J)
     $                  +HUYDDYDYUD(I,J)+HDYUDYUYDD(I,J)
     $                  +HEYEDYEYED(I,J)
            DUM2GRKMU(I,J)=3.D0*YUYUDYUYUD(I,J)+3.D0*YDYDDYDYDD(I,J)
     $                     +2.D0*YUYDDYDYUD(I,J)+YEYEDYEYED(I,J)
          ELSE
            DUM2B1(I,J)=(0.D0,0.D0)
            DUM2B2(I,J)=(0.D0,0.D0)
            DUM2GRKMU(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
        BGRKMU=MVMU*(CTRACE(DUMGRKMU1)-3.D0*G(292)**2-3.D0/5.D0
     $           *G(291)**2)
        BETA1B=MVB*(CTRACE(DUM1B1)-3.D0*G(292)**2-3.D0/5.D0
     $         *G(291)**2)+MVMU*(CTRACE(DUM1B2)+6.D0*G(292)**2
     $         *G(322)+6.D0/5.D0*G(291)**2*G(321))
!
      IF(SW2LP.EQ.1)THEN
        BETA2GRKMU=MVMU*(-3.D0*CTRACE(DUM2GRKMU)+(16.D0*G(293)**2+4.D0
     $             /5.D0*G(291)**2)*TYUDYU+(16.D0*G(293)**2-2.D0/5.D0
     $             *G(291)**2)*TYDDYD+6.D0/5.D0*G(291)**2*TYEDYE
     $             +15.D0/2.D0*G(292)**4+9.D0/5.D0*G(291)**2*G(292)**2
     $             +207.D0/50.D0*G(291)**4)
        B2GRKMUM=BETA2GRKMU
        BETA2B=MVB*(-3.D0*CTRACE(DUM2B1)+(16.D0*G(293)**2+4.D0/5.D0
     $         *G(291)**2)*TYUDYU+(16.D0*G(293)**2-2.D0/5.D0*G(291)**2)
     $         *TYDDYD+6.D0/5.D0*G(291)**2*TYEDYE+15.D0/2.D0*G(292)**4
     $         +9.D0/5.D0*G(291)**2*G(292)**2+207.D0/50.D0*G(291)**4)
     $         +MVMU*(-12.D0*CTRACE(DUM2B2)+(32.D0*G(293)**2
     $         +8.D0/5.D0*G(291)**2)*THUYUD+(32.D0*G(293)**2-4.D0/5.D0
     $         *G(291)**2)*THDYDD+12.D0/5.D0*G(291)**2*THEYED-(32.D0
     $         *G(293)**2*G(323)+8.D0/5.D0*G(291)**2*G(321))*TYUDYU
     $         -(32.D0*G(293)**2*G(323)-4.D0/5.D0*G(291)**2*G(321))
     $         *TYDDYD-12.D0/5.D0*G(291)**2*G(321)*TYEDYE-30.D0
     $         *G(292)**4*G(322)-18.D0/5.D0*G(291)**2*G(292)**2
     $         *(G(321)+G(322))-414.D0/25.D0*G(291)**4*G(321))
         BETA2BM=BETA2B
      END IF
!
!The RKSTP compatible derivative is (with a minus sign
!to convert the running to BT notation)
!
        F(398)=1.D0/16.D0/PI**2*BGRKMU+1.D0/(16.D0*PI**2)**2
     $         *BETA2GRKMU
        F(399)=-1.D0/16.D0/PI**2*BETA1B-1.D0/(16.D0*PI**2)**2*BETA2B
!
!Now the MSSM trilinear couplings - it should be ok to use the same
!dummy matrices, but the betas must be reset
!
      DO I=1,3
        DO J=1,3
          BETA1U(I,J)=(0.D0,0.D0)
          BETA2U(I,J)=(0.D0,0.D0)
          BETA1D(I,J)=(0.D0,0.D0)
          BETA2D(I,J)=(0.D0,0.D0)
          BETA1E(I,J)=(0.D0,0.D0)
          BETA2E(I,J)=(0.D0,0.D0)
        END DO
      END DO
!
!DUM2U11 is a dummy matrix for the calculation of DUM2U1
!
      DO I=1,3
        DO J=1,3
          DUM1D11(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
          DUM1D12(I,J)=6.D0*HDYDD(I,J)+2.D0*HEYED(I,J)
          DUM1E11(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
          DUM1E21(I,J)=6.D0*HDYDD(I,J)+2.D0*HEYED(I,J)
          IF(SW2LP.EQ.1)THEN
            DUM2U11(I,J)=3.D0*YUYUDYUYUD(I,J)+YUYDDYDYUD(I,J)
            DUM2U12(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
            DUM2U21(I,J)=6.D0*HUYUDYUYUD(I,J)+HUYDDYDYUD(I,J)
     $                   +HDYUDYUYDD(I,J)
            DUM2U22(I,J)=6.D0*HDYDD(I,J)+2.D0*HEYED(I,J)
            DUM2U23(I,J)=6.D0*YDYDD(I,J)+2.D0*YEYED(I,J)
            DUM2D11(I,J)=3.D0*YDYDDYDYDD(I,J)+YUYDDYDYUD(I,J)
     $                   +YEYEDYEYED(I,J)
            DUM2D12(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
            DUM2D21(I,J)=6.D0*HDYDDYDYDD(I,J)+HUYDDYDYUD(I,J)
     $                   +HDYUDYUYDD(I,J)+2.D0*HEYEDYEYED(I,J)
            DUM2D22(I,J)=3.D0*HDYDD(I,J)+HEYED(I,J)
            DUM2D23(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
            DUM2E11(I,J)=3.D0*YDYDDYDYDD(I,J)+YUYDDYDYUD(I,J)
     $                   +YEYEDYEYED(I,J)
            DUM2E12(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
            DUM2E21(I,J)=6.D0*HDYDDYDYDD(I,J)+HUYDDYDYUD(I,J)
     $                   +HDYUDYUYDD(I,J)+2.D0*HEYEDYEYED(I,J)
            DUM2E22(I,J)=3.D0*YDYDD(I,J)+YEYED(I,J)
            DUM2E23(I,J)=3.D0*HDYDD(I,J)+HEYED(I,J)
          ELSE
            DUM2U11(I,J)=(0.D0,0.D0)
            DUM2U12(I,J)=(0.D0,0.D0)
            DUM2U21(I,J)=(0.D0,0.D0)
            DUM2U22(I,J)=(0.D0,0.D0)
            DUM2U23(I,J)=(0.D0,0.D0)
            DUM2D11(I,J)=(0.D0,0.D0)
            DUM2D12(I,J)=(0.D0,0.D0)
            DUM2D21(I,J)=(0.D0,0.D0)
            DUM2D22(I,J)=(0.D0,0.D0)
            DUM2D23(I,J)=(0.D0,0.D0)
            DUM2E11(I,J)=(0.D0,0.D0)
            DUM2E12(I,J)=(0.D0,0.D0)
            DUM2E21(I,J)=(0.D0,0.D0)
            DUM2E22(I,J)=(0.D0,0.D0)
            DUM2E23(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
!DUM1U1 is a dummy matrix for the calculation of BETA1U
!
      DO I=1,3
        DO J=1,3
          DUM1U1(I,J)=3.D0*TYUDYU*ID(I,J)+5.D0*YUDYU(I,J)+YDDYD(I,J)
     $                +(-16.D0/3.D0*G(293)**2-3.D0*G(292)**2
     $                -13.D0/15.D0*G(291)**2)*ID(I,J)
          DUM1U2(I,J)=6.D0*THUYUD*ID(I,J)+4.D0*YUDHU(I,J)+2.D0
     $                *YDDHD(I,J)+(32.D0/3.D0*G(293)**2*G(323)+6.D0
     $                *G(292)**2*G(322)+26.D0/15.D0*G(291)**2*G(321))
     $                *ID(I,J)
          DUM1D1(I,J)=CTRACE(DUM1D11)*ID(I,J)+5.D0*YDDYD(I,J)+YUDYU(I,J)
     $                +(-16.D0/3.D0*G(293)**2-3.D0*G(292)**2-7.D0/15.D0
     $                *G(291)**2)*ID(I,J)
          DUM1D2(I,J)=CTRACE(DUM1D12)*ID(I,J)+4.D0*YDDHD(I,J)+2.D0
     $                *YUDHU(I,J)+(32.D0/3.D0*G(293)**2*G(323)+6.D0
     $                *G(292)**2*G(322)+14.D0/15.D0*G(291)**2*G(321))
     $                *ID(I,J)
          DUM1E1(I,J)=CTRACE(DUM1E11)*ID(I,J)+5.D0*YEDYE(I,J)+(-3.D0
     $                *G(292)**2-9.D0/5.D0*G(291)**2)*ID(I,J)
          DUM1E2(I,J)=CTRACE(DUM1E21)*ID(I,J)+4.D0*YEDHE(I,J)+(6.D0
     $                *G(292)**2*G(322)+18.D0/5.D0*G(291)**2*G(321))
     $                *ID(I,J)
          IF(SW2LP.EQ.1)THEN
            DUM2U1(I,J)=-3.D0*CTRACE(DUM2U11)*ID(I,J)-YDDYD(I,J)
     $                  *CTRACE(DUM2U12)-15.D0*YUDYU(I,J)*TYUDYU
     $                  -6.D0*YUDYUYUDYU(I,J)-2.D0*YDDYDYDDYD(I,J)
     $                  -4.D0*YDDYDYUDYU(I,J)+(16.D0*G(293)**2+4.D0/5.D0
     $                  *G(291)**2)*TYUDYU*ID(I,J)+12.D0*G(292)**2
     $                  *YUDYU(I,J)+2.D0/5.D0*G(291)**2*YDDYD(I,J)
     $                  +(-16.D0/9.D0*G(293)**4+8.D0*G(293)**2
     $                  *G(292)**2+136.D0/45.D0*G(293)**2*G(291)**2
     $                  +15.D0/2.D0*G(292)**4+G(292)**2*G(291)**2
     $                  +2743.D0/450.D0*G(291)**4)*ID(I,J)
            DUM2U2(I,J)=-6.D0*CTRACE(DUM2U21)*ID(I,J)-18.D0
     $                  *YUDYU(I,J)*THUYUD-YDDYD(I,J)*CTRACE(DUM2U22)
     $                  -12.D0*YUDHU(I,J)*TYUDYU-YDDHD(I,J)
     $                  *CTRACE(DUM2U23)-6.D0*YUDYUYUDHU(I,J)
     $                  -8.D0*YUDHUYUDYU(I,J)-4.D0*YDDYDYDDHD(I,J)-4.D0
     $                  *YDDHDYDDYD(I,J)-2.D0*YDDYDYUDHU(I,J)-4.D0
     $                  *YDDHDYUDYU(I,J)+(32.D0*G(293)**2+8.D0/5.D0
     $                  *G(291)**2)*THUYUD*ID(I,J)+(6.D0*G(292)**2
     $                  +6.D0/5.D0*G(291)**2)*YUDHU(I,J)+4.D0/5.D0
     $                  *G(291)**2*YDDHD(I,J)-(32.D0*G(293)**2*G(323)
     $                  +8.D0/5.D0*G(291)**2*G(321))*TYUDYU*ID(I,J)
     $                  -(12.D0*G(292)**2*G(322)+4.D0/5.D0*G(291)**2
     $                  *G(321))*YUDYU(I,J)-4.D0/5.D0*G(291)**2
     $                  *G(321)*YDDYD(I,J)+(64.D0/9.D0*G(293)**4
     $                  *G(323)-16.D0*G(293)**2*G(292)**2*(G(323)
     $                  +G(322))-272.D0/45.D0*G(293)**2*G(291)**2
     $                  *(G(323)+G(321))-30.D0*G(292)**4*G(322)-2.D0
     $                  *G(292)**2*G(291)**2*(G(322)+G(321))
     $                  -5486.D0/225.D0*G(291)**4*G(321))*ID(I,J)      
            DUM2D1(I,J)=-3.D0*CTRACE(DUM2D11)*ID(I,J)-3.D0*YUDYU(I,J)
     $                  *TYUDYU-5.D0*YDDYD(I,J)*CTRACE(DUM2D12)-6.D0
     $                  *YDDYDYDDYD(I,J)-2.D0*YUDYUYUDYU(I,J)-4.D0
     $                  *YUDYUYDDYD(I,J)+(16.D0*G(293)**2-2.D0/5.D0
     $                  *G(291)**2)*TYDDYD*ID(I,J)+6.D0/5.D0*G(291)**2
     $                  *TYEDYE*ID(I,J)+4.D0/5.D0*G(291)**2*YUDYU(I,J)
     $                  +(12.D0*G(292)**2+6.D0/5.D0*G(291)**2)
     $                  *YDDYD(I,J)+(-16.D0/9.D0*G(293)**4+8.D0
     $                  *G(293)**2*G(292)**2+8.D0/9.D0*G(293)**2
     $                  *G(291)**2+15.D0/2.D0*G(292)**4+G(292)**2
     $                  *G(291)**2+287.D0/90.D0*G(291)**4)*ID(I,J)
            DUM2D2(I,J)=-6.D0*CTRACE(DUM2D21)*ID(I,J)-6.D0*YUDYU(I,J)
     $                  *THUYUD-6.D0*YDDYD(I,J)*CTRACE(DUM2D22)-6.D0
     $                  *YUDHU(I,J)*TYUDYU-4.D0*YDDHD(I,J)
     $                  *CTRACE(DUM2D23)-6.D0*YDDYDYDDHD(I,J)-8.D0
     $                  *YDDHDYDDYD(I,J)-4.D0*YUDHUYUDYU(I,J)-4.D0
     $                  *YUDYUYUDHU(I,J)-4.D0*YUDHUYDDYD(I,J)-2.D0
     $                  *YUDYUYDDHD(I,J)+(32.D0*G(293)**2-4.D0/5.D0
     $                  *G(291)**2)*THDYDD*ID(I,J)+12.D0/5.D0*G(291)**2
     $                  *THEYED*ID(I,J)+8.D0/5.D0*G(291)**2*YUDHU(I,J)
     $                  +(6.D0*G(292)**2+6.D0/5.D0*G(291)**2)*YDDHD(I,J)
     $                  -(32.D0*G(293)**2*G(323)-4.D0/5.D0*G(291)**2
     $                  *G(321))*TYDDYD*ID(I,J)-12.D0/5.D0*G(291)**2
     $                  *G(321)*TYEDYE*ID(I,J)-(12.D0*G(292)**2*G(322)
     $                  +8.D0/5.D0*G(291)**2*G(321))*YDDYD(I,J)
     $                  -8.D0/5.D0*G(291)**2*G(321)*YUDYU(I,J)
     $                  +(64.D0/9.D0*G(293)**4*G(323)-16.D0*G(293)**2
     $                  *G(292)**2*(G(323)+G(322))-16.D0/9.D0
     $                  *G(293)**2*G(291)**2*(G(323)+G(321))-30.D0
     $                  *G(292)**4*G(322)-2.D0*G(292)**2*G(291)**2
     $                  *(G(322)+G(321))-574.D0/45.D0*G(291)**4*G(321))
     $                  *ID(I,J)
            DUM2E1(I,J)=-3.D0*CTRACE(DUM2E11)*ID(I,J)-5.D0*YEDYE(I,J)
     $                  *CTRACE(DUM2E12)-6.D0*YEDYEYEDYE(I,J)+(16.D0
     $                  *G(293)**2-2.D0/5.D0*G(291)**2)*TYDDYD*ID(I,J)
     $                  +6.D0/5.D0*G(291)**2*TYEDYE*ID(I,J)+(12.D0
     $                  *G(292)**2-6.D0/5.D0*G(291)**2)*YEDYE(I,J)
     $                  +(15.D0/2.D0*G(292)**4+9.D0/5.D0*G(292)**2
     $                  *G(291)**2+27.D0/2.D0*G(291)**4)*ID(I,J)
            DUM2E2(I,J)=-6.D0*CTRACE(DUM2E21)*ID(I,J)-4.D0*YEDHE(I,J)
     $                  *CTRACE(DUM2E22)-6.D0*YEDYE(I,J)*CTRACE(DUM2E23)
     $                  -6.D0*YEDYEYEDHE(I,J)-8.D0*YEDHEYEDYE(I,J)
     $                  +(32.D0*G(293)**2-4.D0/5.D0*G(291)**2)*THDYDD
     $                  *ID(I,J)+12.D0/5.D0*G(291)**2*THEYED*ID(I,J)
     $                  +(6.D0*G(292)**2+6.D0/5.D0*G(291)**2)*YEDHE(I,J)
     $                  -(32.D0*G(293)**2*G(323)-4.D0/5.D0*G(291)**2
     $                  *G(321))*TYDDYD*ID(I,J)-12.D0/5.D0*G(291)**2
     $                  *G(321)*TYEDYE*ID(I,J)-12.D0*G(292)**2*G(322)
     $                  *YEDYE(I,J)+(-30.D0*G(292)**4*G(322)-18.D0/5.D0
     $                  *G(292)**2*G(291)**2*(G(321)+G(322))-54.D0
     $                  *G(291)**4*G(321))*ID(I,J)
          ELSE
            DUM2U1(I,J)=(0.D0,0.D0)
            DUM2U2(I,J)=(0.D0,0.D0)
            DUM2D1(I,J)=(0.D0,0.D0)
            DUM2D2(I,J)=(0.D0,0.D0)
            DUM2E1(I,J)=(0.D0,0.D0)
            DUM2E2(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
!Now calculate the beta functions for the trilinears
!
      DO I=1,3
        DO J=1,3
          BETA1U(I,J)=CMATMUL(0,HU,DUM1U1,I,J)+CMATMUL(0,YU,DUM1U2,I,J)
          BETA1D(I,J)=CMATMUL(0,HD,DUM1D1,I,J)+CMATMUL(0,YD,DUM1D2,I,J)
          BETA1E(I,J)=CMATMUL(0,HE,DUM1E1,I,J)+CMATMUL(0,YE,DUM1E2,I,J)
          IF(SW2LP.EQ.1)THEN
            BETA2U(I,J)=CMATMUL(0,HU,DUM2U1,I,J)
     $                  +CMATMUL(0,YU,DUM2U2,I,J)
            BETA2D(I,J)=CMATMUL(0,HD,DUM2D1,I,J)
     $                  +CMATMUL(0,YD,DUM2D2,I,J)
            BETA2E(I,J)=CMATMUL(0,HE,DUM2E1,I,J)
     $                  +CMATMUL(0,YE,DUM2E2,I,J)
            B2HMU(I,J)=BETA2U(I,J)
            B2HMD(I,J)=BETA2D(I,J)
            B2HME(I,J)=BETA2E(I,J)
          END IF
!
!Calculate the differentials DH
!
          DH(1,I,J)=1.D0/16.D0/PI**2*BETA1U(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2U(I,J)
          DH(2,I,J)=1.D0/16.D0/PI**2*BETA1D(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2D(I,J)
          DH(3,I,J)=1.D0/16.D0/PI**2*BETA1E(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2E(I,J)
        END DO
      END DO
!
!Convert into form readable by RKSTP (converting to BT notation...)
!Need new do loop due to the (J,I) ordering
!
      DO I=1,3
        DO J=1,3
          F(323+(I-1)*3+J)=-DH(1,J,I)
          F(332+(I-1)*3+J)=-DH(2,J,I)
          F(341+(I-1)*3+J)=-DH(3,J,I)
        END DO
      END DO
!
!Now for the (mass)^2 parameters. DUMSP are dummy matrices for the
!calculation of S'
!
      IF(SW2LP.EQ.1)THEN
        DO I=1,3
          DO J=1,3
            DUMSP1(I,J)=3.D0*G(351)*ID(I,J)+MQM(I,J)
            DUMSP2(I,J)=3.D0*G(352)*ID(I,J)-MQM(I,J)
            DUMSP3(I,J)=G(352)*ID(I,J)+MLM(I,J)
          END DO
        END DO
      ELSE
        DO I=1,3
          DO J=1,3
            DUMSP1(I,J)=(0.D0,0.D0)
            DUMSP2(I,J)=(0.D0,0.D0)
            DUMSP3(I,J)=(0.D0,0.D0)
          END DO
        END DO
      END IF
!
!Dummy matrices for S, S' and SIGMAi
!
      DO I=1,3
        DO J=1,3
          DUMS(I,J)=MQM(I,J)-MLM(I,J)-2.D0*MUPM(I,J)+MDM(I,J)+MEM(I,J)
          IF(SW2LP.EQ.1)THEN
            DUMSP(I,J)=-CMATMUL(0,DUMSP1,YUDYU,I,J)+4.D0*YUDMUPMYU(I,J)
     $                 +CMATMUL(0,DUMSP2,YDDYD,I,J)-2.D0*YDDMDMYD(I,J)
     $                 +CMATMUL(0,DUMSP3,YEDYE,I,J)-2.D0*YEDMEMYE(I,J)
            DUMSIG1(I,J)=MQM(I,J)+3.D0*MLM(I,J)+8.D0*MUPM(I,J)
     $                   +2.D0*MDM(I,J)+6.D0*MEM(I,J)
            DUMSIG2(I,J)=3.D0*MQM(I,J)+MLM(I,J)
            DUMSIG3(I,J)=2.D0*MQM(I,J)+MUPM(I,J)+MDM(I,J)
          ELSE
            DUMSP(I,J)=(0.D0,0.D0)
            DUMSIG1(I,J)=(0.D0,0.D0)
            DUMSIG2(I,J)=(0.D0,0.D0)
            DUMSIG3(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
!These definitions make the equations shorter
!
      S=G(351)-G(352)+CTRACE(DUMS)
      IF(SW2LP.EQ.1)THEN
        SP=CTRACE(DUMSP)+(3.D0/2.D0*G(292)**2+3.D0/10.D0*G(291)**2)
     $     *(G(351)-G(352)-CTRACE(MLM))+(8.D0/3.D0*G(293)**2+3.D0/2.D0
     $     *G(292)**2+1.D0/30.D0*G(291)**2)*CTRACE(MQM)-(16.D0/3.D0
     $     *G(293)**2+16.D0/15.D0*G(291)**2)*CTRACE(MUPM)+(8.D0/3.D0
     $     *G(293)**2+2.D0/15.D0*G(291)**2)*CTRACE(MDM)+6.D0/5.D0
     $     *G(291)**2*CTRACE(MEM)
        SIG1=1.D0/5.D0*G(291)**2*(3.D0*(G(351)+G(352))
     $       +CTRACE(DUMSIG1))
        SIG2=G(292)**2*(G(351)+G(352)+CTRACE(DUMSIG2))
        SIG3=G(293)**2*CTRACE(DUMSIG3)
      ELSE
        SP=(0.D0,0.D0)
        SIG1=(0.D0,0.D0)
        SIG2=(0.D0,0.D0)
        SIG3=(0.D0,0.D0)
      END IF
!
!Now the dummy matrices for the higgs betas
!
      IF(SW2LP.EQ.1)THEN
        DO I=1,3
          DO J=1,3
            DUM2HU11(I,J)=G(351)*ID(I,J)+MQM(I,J)
            DUM2HU12(I,J)=(G(351)+G(352))*ID(I,J)+MQM(I,J)
            DUM2HU21(I,J)=DUM2HU11(I,J)
            DUM2HD11(I,J)=G(352)*ID(I,J)+MQM(I,J)
            DUM2HD12(I,J)=DUM2HU12(I,J)
            DUM2HD13(I,J)=G(352)*ID(I,J)+MLM(I,J)
            DUM2HD21(I,J)=DUM2HD11(I,J)
            DUM2HD31(I,J)=DUM2HD13(I,J)
          END DO
        END DO
      ELSE
        DO I=1,3
          DO J=1,3
            DUM2HU11(I,J)=(0.D0,0.D0)
            DUM2HU12(I,J)=(0.D0,0.D0)
            DUM2HU21(I,J)=(0.D0,0.D0)
            DUM2HD11(I,J)=(0.D0,0.D0)
            DUM2HD12(I,J)=(0.D0,0.D0)
            DUM2HD13(I,J)=(0.D0,0.D0)
            DUM2HD21(I,J)=(0.D0,0.D0)
            DUM2HD31(I,J)=(0.D0,0.D0)
          END DO
        END DO
      END IF
      DO I=1,3
        DO J=1,3
          DUM1HU1(I,J)=G(351)*ID(I,J)+MQM(I,J)
          DUM1HD1(I,J)=G(352)*ID(I,J)+MQM(I,J)
          DUM1HD2(I,J)=G(352)*ID(I,J)+MLM(I,J)
          IF(SW2LP.EQ.1)THEN
            DUM2HU1(I,J)=6.D0*CMATMUL(0,DUM2HU11,YUDYUYUDYU,I,J)+6.D0
     $                   *YUDMUPMYUYUDYU(I,J)
     $                   +CMATMUL(0,DUM2HU12,YUDYUYDDYD,I,J)
     $                   +YUDMUPMYUYDDYD(I,J)+YUDYUMQMYDDYD(I,J)
     $                   +YUDYUYDDMDMYD(I,J)+6.D0*HUDHUYUDYU(I,J)+6.D0
     $                   *HUDYUYUDHU(I,J)+HDDHDYUDYU(I,J)
     $                   +YDDYDHUDHU(I,J)+HDDYDYUDHU(I,J)
     $                   +YDDHDHUDYU(I,J)
            DUM2HU2(I,J)=CMATMUL(0,DUM2HU21,YUDYU,I,J)+YUDMUPMYU(I,J)
     $                   +HUDHU(I,J)
            DUM2HD1(I,J)=6.D0*CMATMUL(0,DUM2HD11,YDDYDYDDYD,I,J)
     $                   +6.D0*YDDMDMYDYDDYD(I,J)
     $                   +CMATMUL(0,DUM2HD12,YUDYUYDDYD,I,J)
     $                   +YUDMUPMYUYDDYD(I,J)+YUDYUMQMYDDYD(I,J)
     $                   +YUDYUYDDMDMYD(I,J)+2.D0
     $                   *CMATMUL(0,DUM2HD13,YEDYEYEDYE,I,J)+2.D0
     $                   *YEDMEMYEYEDYE(I,J)+6.D0*HDDHDYDDYD(I,J)+6.D0
     $                   *HDDYDYDDHD(I,J)+HUDHUYDDYD(I,J)
     $                   +YUDYUHDDHD(I,J)+HUDYUYDDHD(I,J)
     $                   +YUDHUHDDYD(I,J)+2.D0*HEDHEYEDYE(I,J)+2.D0
     $                   *HEDYEYEDHE(I,J)
            DUM2HD2(I,J)=CMATMUL(0,DUM2HD21,YDDYD,I,J)+YDDMDMYD(I,J)
     $                   +HDDHD(I,J)
            DUM2HD3(I,J)=CMATMUL(0,DUM2HD31,YEDYE,I,J)+YEDMEMYE(I,J)
     $                   +HEDHE(I,J)
          ELSE
            DUM2HU1(I,J)=(0.D0,0.D0)
            DUM2HU2(I,J)=(0.D0,0.D0)
            DUM2HD1(I,J)=(0.D0,0.D0)
            DUM2HD2(I,J)=(0.D0,0.D0)
            DUM2HD3(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
      DO I=1,3
        DO J=1,3
          DUM1HU(I,J)=CMATMUL(0,DUM1HU1,YUDYU,I,J)+YUDMUPMYU(I,J)
     $                +HUDHU(I,J)
          DUM1HD(I,J)=6.D0*CMATMUL(0,DUM1HD1,YDDYD,I,J)+6.D0
     $                *YDDMDMYD(I,J)+2.D0*CMATMUL(0,DUM1HD2,YEDYE,I,J)
     $                +2.D0*YEDMEMYE(I,J)+6.D0*HDDHD(I,J)
     $                +2.D0*HEDHE(I,J)
        END DO
      END DO
!
!The higgs mass^2 beta parameters are not matrices:
!
      BETA1HU=6.D0*CTRACE(DUM1HU)-6.D0*G(292)**2*CMODSQ(G(322))
     $        -6.D0/5.D0*G(291)**2*CMODSQ(G(321))+3.D0/5.D0*G(291)**2*S
      BETA1HD=CTRACE(DUM1HD)-6.D0*G(292)**2*CMODSQ(G(322))-6.D0/5.D0
     $        *G(291)**2*CMODSQ(G(321))-3.D0/5.D0*G(291)**2*S
      IF(SW2LP.EQ.1)THEN
        BETA2HU=-6.D0*CTRACE(DUM2HU1)+(32.D0*G(293)**2+8.D0/5.D0
     $          *G(291)**2)*CTRACE(DUM2HU2)+32.D0*G(293)**2*(2.D0
     $          *CMODSQ(G(323))*TYUDYU-CCON(G(323))*TYUDHU-G(323)
     $          *THUDYU)+8.D0/5.D0*G(291)**2*(2.D0*CMODSQ(G(321))
     $          *TYUDYU-CCON(G(321))*TYUDHU-G(321)*THUDYU)+6.D0/5.D0
     $          *G(291)**2*SP+33.D0*G(292)**4*CMODSQ(G(322))
     $          +18.D0/5.D0*G(292)**2*G(291)**2*(CMODSQ(G(322))
     $          +CMODSQ(G(321))+CRE(2,G(321),G(322)))+621.D0/25.D0
     $          *G(291)**4*CMODSQ(G(321))+3.D0*G(292)**2*SIG2
     $          +3.D0/5.D0*G(291)**2*SIG1
        BETA2HD=-6.D0*CTRACE(DUM2HD1)+(32.D0*G(293)**2-4.D0/5.D0
     $          *G(291)**2)*CTRACE(DUM2HD2)+32.D0*G(293)**2*(2.D0
     $          *CMODSQ(G(323))*TYDDYD-CCON(G(323))*TYDDHD-G(323)
     $          *THDDYD)-4.D0/5.D0*G(291)**2*(2.D0*CMODSQ(G(321))
     $          *TYDDYD-CCON(G(321))*TYDDHD-G(321)*THDDYD)+12.D0/5.D0
     $          *G(291)**2*(CTRACE(DUM2HD3)+2.D0*CMODSQ(G(321))*TYEDYE
     $          -G(321)*THEDYE-CCON(G(321))*TYEDHE)-6.D0/5.D0
     $          *G(291)**2*SP+33.D0*G(292)**4*CMODSQ(G(322))
     $          +18.D0/5.D0*G(292)**2*G(291)**2*(CMODSQ(G(322))
     $          +CMODSQ(G(321))+CRE(2,G(321),G(322)))+621.D0/25.D0
     $          *G(291)**4*CMODSQ(G(321))+3.D0*G(292)**2*SIG2
     $          +3.D0/5.D0*G(291)**2*SIG1
         B2HUM=BETA2HU
         B2HDM=BETA2HD
      END IF
!
!Calculate the differentials F(351) and F(352)
!
      F(351)=1.D0/16.D0/PI**2*BETA1HU+1.D0/(16.D0*PI**2)**2*BETA2HU
      F(352)=1.D0/16.D0/PI**2*BETA1HD+1.D0/(16.D0*PI**2)**2*BETA2HD
!
!Now for the dummy matrices for the rest of the mass^2
!
      IF(SW2LP.EQ.1)THEN
        DO I=1,3
          DO J=1,3
            DUM2Q31(I,J)=MQM(I,J)+4.D0*G(351)*ID(I,J)
            DUM2Q41(I,J)=MQM(I,J)+4.D0*G(352)*ID(I,J)
            DUM2L21(I,J)=MLM(I,J)+4.D0*G(352)*ID(I,J)
            DUM2U31(I,J)=MUPM(I,J)+4.D0*G(351)*ID(I,J)
            DUM2D31(I,J)=MDM(I,J)+4.D0*G(352)*ID(I,J)
            DUM2E21(I,J)=MEM(I,J)+4.D0*G(352)*ID(I,J)
          END DO
        END DO
      ELSE
        DO I=1,3
          DO J=1,3
            DUM2Q31(I,J)=(0.D0,0.D0)
            DUM2Q41(I,J)=(0.D0,0.D0)
            DUM2L21(I,J)=(0.D0,0.D0)
            DUM2U31(I,J)=(0.D0,0.D0)
            DUM2D31(I,J)=(0.D0,0.D0)
            DUM2E21(I,J)=(0.D0,0.D0)
          END DO
        END DO
      END IF
!
!This is the second round of dummy matrices
!
      DO I=1,3
        DO J=1,3
          DUM1Q1(I,J)=MQM(I,J)+2.D0*G(351)*ID(I,J)
          DUM1Q2(I,J)=MQM(I,J)+2.D0*G(352)*ID(I,J)
          DUM1Q3(I,J)=YUDYU(I,J)+YDDYD(I,J)
          DUM1L1(I,J)=MLM(I,J)+2.D0*G(352)*ID(I,J)
          DUM1U1(I,J)=2.D0*MUPM(I,J)+4.D0*G(351)*ID(I,J)
          DUM1D1(I,J)=2.D0*MDM(I,J)+4.D0*G(352)*ID(I,J)
          DUM1E1(I,J)=2.D0*MEM(I,J)+4.D0*G(352)*ID(I,J)
          IF(SW2LP.EQ.1)THEN
            DUM2Q1(I,J)=2.D0*DUM2Q31(I,J)
            DUM2Q2(I,J)=2.D0*DUM2Q41(I,J)
            DUM2Q3(I,J)=CMATMUL(0,DUM2Q31,YUDYU,I,J)+2.D0
     $                  *YUDMUPMYU(I,J)+YUDYUMQM(I,J)
            DUM2Q4(I,J)=CMATMUL(0,DUM2Q41,YDDYD,I,J)+2.D0
     $                  *YDDMDMYD(I,J)+YDDYDMQM(I,J)
            DUM2Q5(I,J)=3.D0*YDDYD(I,J)+YEDYE(I,J)
            DUM2Q6(I,J)=MQMYUDYU(I,J)+YUDMUPMYU(I,J)
            DUM2Q7(I,J)=6.D0*MQMYDDYD(I,J)+6.D0*YDDMDMYD(I,J)+2.D0
     $                  *MLMYEDYE(I,J)+2.D0*YEDMEMYE(I,J)
            DUM2Q8(I,J)=6.D0*YDDYD(I,J)+2.D0*YEDYE(I,J)
            DUM2Q9(I,J)=6.D0*HDDHD(I,J)+2.D0*HEDHE(I,J)
            DUM2QA(I,J)=6.D0*YDDHD(I,J)+2.D0*YEDHE(I,J)
            DUM2QB(I,J)=6.D0*HDDYD(I,J)+2.D0*HEDYE(I,J)
            DUM2QC(I,J)=2.D0*DUM1Q1(I,J)
            DUM2QD(I,J)=MQM(I,J)+2.D0*G(352)*ID(I,J)
            DUM2L1(I,J)=2.D0*DUM2L21(I,J)
            DUM2L2(I,J)=CMATMUL(0,DUM2L21,YEDYE,I,J)+2.D0
     $                  *YEDMEMYE(I,J)+YEDYEMLM(I,J)
            DUM2L3(I,J)=3.D0*YDDYD(I,J)+YEDYE(I,J)
            DUM2L4(I,J)=6.D0*MQMYDDYD(I,J)+6.D0*YDDMDMYD(I,J)+2.D0
     $                  *MLMYEDYE(I,J)+2.D0*YEDMEMYE(I,J)
            DUM2L5(I,J)=6.D0*YDDYD(I,J)+2.D0*YEDYE(I,J)
            DUM2L6(I,J)=6.D0*HDDHD(I,J)+2.D0*HEDHE(I,J)
            DUM2L7(I,J)=6.D0*YDDHD(I,J)+2.D0*YEDHE(I,J)
            DUM2L8(I,J)=6.D0*HDDYD(I,J)+2.D0*HEDYE(I,J)
            DUM2L9(I,J)=DUM1L1(I,J)
            DUM2U1(I,J)=2.D0*DUM2U31(I,J)
            DUM2U2(I,J)=2.D0*MUPM(I,J)+4.D0*(G(351)+G(352))*ID(I,J)
            DUM2U3(I,J)=CMATMUL(0,DUM2U31,YUYUD,I,J)+2.D0*YUMQMYUD(I,J)
     $                  +YUYUDMUPM(I,J)
            DUM2U4(I,J)=MQMYUDYU(I,J)+YUDMUPMYU(I,J)
            DUM2U5(I,J)=MUPM(I,J)+2.D0*G(351)*ID(I,J)
            DUM2D1(I,J)=2.D0*DUM2D31(I,J)
            DUM2D2(I,J)=2.D0*MDM(I,J)+4.D0*(G(351)+G(352))*ID(I,J)
            DUM2D3(I,J)=CMATMUL(0,DUM2D31,YDYDD,I,J)+2.D0*YDMQMYDD(I,J)
     $                  +YDYDDMDM(I,J)
            DUM2D4(I,J)=6.D0*YDDYD(I,J)+2.D0*YEDYE(I,J)
            DUM2D5(I,J)=3.D0*MQMYDDYD(I,J)+3.D0*YDDMDMYD(I,J)
     $                  +MLMYEDYE(I,J)+YEDMEMYE(I,J)
            DUM2D6(I,J)=3.D0*YDDYD(I,J)+YEDYE(I,J)
            DUM2D7(I,J)=3.D0*HDDHD(I,J)+HEDHE(I,J)
            DUM2D8(I,J)=3.D0*HDDYD(I,J)+HEDYE(I,J)
            DUM2D9(I,J)=3.D0*YDDHD(I,J)+YEDHE(I,J)
            DUM2DA(I,J)=MDM(I,J)+2.D0*G(352)*ID(I,J)
            DUM2E1(I,J)=2.D0*DUM2E21(I,J)
            DUM2E2(I,J)=CMATMUL(0,DUM2E21,YEYED,I,J)+2.D0*YEMLMYED(I,J)
     $                  +YEYEDMEM(I,J)
            DUM2E3(I,J)=6.D0*YDDYD(I,J)+2.D0*YEDYE(I,J)
            DUM2E4(I,J)=3.D0*MQMYDDYD(I,J)+3.D0*YDDMDMYD(I,J)
     $                  +MLMYEDYE(I,J)+YEDMEMYE(I,J)
            DUM2E5(I,J)=3.D0*YDDYD(I,J)+YEDYE(I,J)
            DUM2E6(I,J)=3.D0*HDDHD(I,J)+HEDHE(I,J)
            DUM2E7(I,J)=3.D0*HDDYD(I,J)+HEDYE(I,J)
            DUM2E8(I,J)=3.D0*YDDHD(I,J)+YEDHE(I,J)
            DUM2E9(I,J)=MEM(I,J)+2.D0*G(352)*ID(I,J)
          ELSE
            DUM2Q1(I,J)=(0.D0,0.D0)
            DUM2Q2(I,J)=(0.D0,0.D0)
            DUM2Q3(I,J)=(0.D0,0.D0)
            DUM2Q4(I,J)=(0.D0,0.D0)
            DUM2Q5(I,J)=(0.D0,0.D0)
            DUM2Q6(I,J)=(0.D0,0.D0)
            DUM2Q7(I,J)=(0.D0,0.D0)
            DUM2Q8(I,J)=(0.D0,0.D0)
            DUM2Q9(I,J)=(0.D0,0.D0)
            DUM2QA(I,J)=(0.D0,0.D0)
            DUM2QB(I,J)=(0.D0,0.D0)
            DUM2QC(I,J)=(0.D0,0.D0)
            DUM2QD(I,J)=(0.D0,0.D0)
            DUM2L1(I,J)=(0.D0,0.D0)
            DUM2L2(I,J)=(0.D0,0.D0)
            DUM2L3(I,J)=(0.D0,0.D0)
            DUM2L4(I,J)=(0.D0,0.D0)
            DUM2L5(I,J)=(0.D0,0.D0)
            DUM2L6(I,J)=(0.D0,0.D0)
            DUM2L7(I,J)=(0.D0,0.D0)
            DUM2L8(I,J)=(0.D0,0.D0)
            DUM2L9(I,J)=(0.D0,0.D0)
            DUM2U1(I,J)=(0.D0,0.D0)
            DUM2U2(I,J)=(0.D0,0.D0)
            DUM2U3(I,J)=(0.D0,0.D0)
            DUM2U4(I,J)=(0.D0,0.D0)
            DUM2U5(I,J)=(0.D0,0.D0)
            DUM2D1(I,J)=(0.D0,0.D0)
            DUM2D2(I,J)=(0.D0,0.D0)
            DUM2D3(I,J)=(0.D0,0.D0)
            DUM2D4(I,J)=(0.D0,0.D0)
            DUM2D5(I,J)=(0.D0,0.D0)
            DUM2D6(I,J)=(0.D0,0.D0)
            DUM2D7(I,J)=(0.D0,0.D0)
            DUM2D8(I,J)=(0.D0,0.D0)
            DUM2D9(I,J)=(0.D0,0.D0)
            DUM2DA(I,J)=(0.D0,0.D0)
            DUM2E1(I,J)=(0.D0,0.D0)
            DUM2E2(I,J)=(0.D0,0.D0)
            DUM2E3(I,J)=(0.D0,0.D0)
            DUM2E4(I,J)=(0.D0,0.D0)
            DUM2E5(I,J)=(0.D0,0.D0)
            DUM2E6(I,J)=(0.D0,0.D0)
            DUM2E7(I,J)=(0.D0,0.D0)
            DUM2E8(I,J)=(0.D0,0.D0)
            DUM2E9(I,J)=(0.D0,0.D0)
          END IF
        END DO
      END DO
!
!Now calculate the beta functions for the rest of the mass^2
!
      DO I=1,3
        DO J=1,3
          BETA1MQ(I,J)=CMATMUL(0,DUM1Q1,YUDYU,I,J)
     $                 +CMATMUL(0,DUM1Q2,YDDYD,I,J)
     $                 +CMATMUL(0,DUM1Q3,MQM,I,J)+2.D0
     $                 *YUDMUPMYU(I,J)+2.D0*YDDMDMYD(I,J)+2.D0
     $                 *HUDHU(I,J)+2.D0*HDDHD(I,J)+(-32.D0/3.D0
     $                 *G(293)**2*CMODSQ(G(323))-6.D0*G(292)**2
     $                 *CMODSQ(G(322))-2.D0/15.D0*G(291)**2
     $                 *CMODSQ(G(321))+1.D0/5.D0*G(291)**2*S)*ID(I,J)
          BETA1ML(I,J)=CMATMUL(0,DUM1L1,YEDYE,I,J)+2.D0*YEDMEMYE(I,J)
     $                 +YEDYEMLM(I,J)+2.D0*HEDHE(I,J)+(-6.D0*G(292)**2
     $                 *CMODSQ(G(322))-6.D0/5.D0*G(291)**2
     $                 *CMODSQ(G(321))-3.D0/5.D0*G(291)**2*S)*ID(I,J)
          BETA1MU(I,J)=CMATMUL(0,DUM1U1,YUYUD,I,J)+4.D0*YUMQMYUD(I,J)
     $                 +2.D0*YUYUDMUPM(I,J)+4.D0*HUHUD(I,J)+(-32.D0/3.D0
     $                 *G(293)**2*CMODSQ(G(323))-32.D0/15.D0*G(291)**2
     $                 *CMODSQ(G(321))-4.D0/5.D0*G(291)**2*S)*ID(I,J)
          BETA1MD(I,J)=CMATMUL(0,DUM1D1,YDYDD,I,J)+4.D0*YDMQMYDD(I,J)
     $                 +2.D0*YDYDDMDM(I,J)+4.D0*HDHDD(I,J)+(-32.D0/3.D0
     $                 *G(293)**2*CMODSQ(G(323))-8.D0/15.D0*G(291)**2
     $                 *CMODSQ(G(321))+2.D0/5.D0*G(291)**2*S)*ID(I,J)
          BETA1ME(I,J)=CMATMUL(0,DUM1E1,YEYED,I,J)+4.D0*YEMLMYED(I,J)
     $                 +2.D0*YEYEDMEM(I,J)+4.D0*HEHED(I,J)+(-24.D0/5.D0
     $                 *G(291)**2*CMODSQ(G(321))+6.D0/5.D0*G(291)**2*S)
     $                 *ID(I,J)
         IF(SW2LP.EQ.1)THEN
            BETA2MQ(I,J)=-CMATMUL(0,DUM2Q1,YUDYUYUDYU,I,J)-4.D0
     $                   *YUDMUPMYUYUDYU(I,J)-4.D0*YUDYUMQMYUDYU(I,J)
     $                   -4.D0*YUDYUYUDMUPMYU(I,J)
     $                   -2.D0*YUDYUYUDYUMQM(I,J)
     $                   -CMATMUL(0,DUM2Q2,YDDYDYDDYD,I,J)
     $                   -4.D0*YDDMDMYDYDDYD(I,J)
     $                   -4.D0*YDDYDMQMYDDYD(I,J)
     $                   -4.D0*YDDYDYDDMDMYD(I,J)
     $                   -2.D0*YDDYDYDDYDMQM(I,J)
     $                   -DUM2Q3(I,J)*3.D0*TYUDYU-DUM2Q4(I,J)
     $                   *CTRACE(DUM2Q5)-6.D0*YUDYU(I,J)*CTRACE(DUM2Q6)
     $                   -YDDYD(I,J)*CTRACE(DUM2Q7)-4.D0
     $                   *(YUDYUHUDHU(I,J)+HUDHUYUDYU(I,J)
     $                   +YUDHUHUDYU(I,J)+HUDYUYUDHU(I,J))-4.D0
     $                   *(YDDYDHDDHD(I,J)+HDDHDYDDYD(I,J)
     $                   +YDDHDHDDYD(I,J)+HDDYDYDDHD(I,J))-HUDHU(I,J)
     $                   *6.D0*TYUDYU-YUDYU(I,J)*6.D0*THUDHU-HUDYU(I,J)
     $                   *6.D0*TYUDHU-YUDHU(I,J)*6.D0*THUDYU-HDDHD(I,J)
     $                   *CTRACE(DUM2Q8)-YDDYD(I,J)*CTRACE(DUM2Q9)
     $                   -HDDYD(I,J)*CTRACE(DUM2QA)-YDDHD(I,J)
     $                   *CTRACE(DUM2QB)+2.D0/5.D0*G(291)**2
     $                   *(CMATMUL(0,DUM2QC,YUDYU,I,J)+4.D0
     $                   *YUDMUPMYU(I,J)+2.D0*YUDYUMQM(I,J)+4.D0
     $                   *HUDHU(I,J)-4.D0*G(321)*HUDYU(I,J)-4.D0
     $                   *CCON(G(321))*YUDHU(I,J)+8.D0*CMODSQ(G(321))
     $                   *YUDYU(I,J)+CMATMUL(0,DUM2QD,YDDYD,I,J)+2.D0
     $                   *YDDMDMYD(I,J)+YDDYDMQM(I,J)+2.D0*HDDHD(I,J)
     $                   -2.D0*G(321)*HDDYD(I,J)-2.D0*CCON(G(321))
     $                   *YDDHD(I,J)+4.D0*CMODSQ(G(321))*YDDYD(I,J))
     $                   +(2.D0/5.D0*G(291)**2*SP-128.D0/3.D0*G(293)**4
     $                   *CMODSQ(G(323))+32.D0*G(293)**2*G(292)**2
     $                   *(CMODSQ(G(323))+CMODSQ(G(322))
     $                   +CRE(2,G(322),G(323)))+32.D0/45.D0*G(293)**2
     $                   *G(291)**2*(CMODSQ(G(323))+CMODSQ(G(321))
     $                   +CRE(2,G(321),G(323)))+33.D0*G(292)**4
     $                   *CMODSQ(G(322))+2.D0/5.D0*G(292)**2
     $                   *G(291)**2*(CMODSQ(G(322))+CMODSQ(G(321))
     $                   +CRE(2,G(321),G(322)))+199.D0/75.D0*G(291)**4
     $                   *CMODSQ(G(321))+16.D0/3.D0*G(293)**2*SIG3+3.D0
     $                   *G(292)**2*SIG2+1.D0/15.D0*G(291)**2*SIG1)
     $                   *ID(I,J)
            BETA2ML(I,J)=-CMATMUL(0,DUM2L1,YEDYEYEDYE,I,J)-4.D0
     $                   *YEDMEMYEYEDYE(I,J)-4.D0*YEDYEMLMYEDYE(I,J)
     $                   -4.D0*YEDYEYEDMEMYE(I,J)
     $                   -2.D0*YEDYEYEDYEMLM(I,J)
     $                   -DUM2L2(I,J)*CTRACE(DUM2L3)-YEDYE(I,J)
     $                   *CTRACE(DUM2L4)-4.D0*(YEDYEHEDHE(I,J)
     $                   +HEDHEYEDYE(I,J)+YEDHEHEDYE(I,J)
     $                   +HEDYEYEDHE(I,J))-HEDHE(I,J)*CTRACE(DUM2L5)
     $                   -YEDYE(I,J)*CTRACE(DUM2L6)-HEDYE(I,J)
     $                   *CTRACE(DUM2L7)-YEDHE(I,J)*CTRACE(DUM2L8)
     $                   +6.D0/5.D0*G(291)**2
     $                   *(CMATMUL(0,DUM2L9,YEDYE,I,J)
     $                   +2.D0*YEDMEMYE(I,J)+YEDYEMLM(I,J)
     $                   +2.D0*HEDHE(I,J)-2.D0*G(321)*HEDYE(I,J)
     $                   -2.D0*CCON(G(321))*YEDHE(I,J)+4.D0
     $                   *CMODSQ(G(321))*YEDYE(I,J))+(-6.D0/5.D0
     $                   *G(291)**2*SP+33.D0*G(292)**4*CMODSQ(G(322))
     $                   +18.D0/5.D0*G(292)**2*G(291)**2
     $                   *(CMODSQ(G(322))+CMODSQ(G(321))
     $                   +CRE(2,G(321),G(322)))+621.D0/25.D0
     $                   *G(291)**4*CMODSQ(G(321))+3.D0*G(292)**2*SIG2
     $                   +3.D0/5.D0*G(291)**2*SIG1)*ID(I,J)
            BETA2MU(I,J)=-CMATMUL(0,DUM2U1,YUYUDYUYUD,I,J)-4.D0
     $                   *YUMQMYUDYUYUD(I,J)-4.D0*YUYUDMUPMYUYUD(I,J)
     $                   -4.D0*YUYUDYUMQMYUD(I,J)
     $                   -2.D0*YUYUDYUYUDMUPM(I,J)
     $                   -CMATMUL(0,DUM2U2,YUYDDYDYUD,I,J)-4.D0
     $                   *YUMQMYDDYDYUD(I,J)-4.D0*YUYDDMDMYDYUD(I,J)
     $                   -4.D0*YUYDDYDMQMYUD(I,J)
     $                   -2.D0*YUYDDYDYUDMUPM(I,J)
     $                   -DUM2U3(I,J)*6.D0*TYUDYU-12.D0*YUYUD(I,J)
     $                   *CTRACE(DUM2U4)-4.D0*(HUHUDYUYUD(I,J)
     $                   +YUYUDHUHUD(I,J)+HUYUDYUHUD(I,J)
     $                   +YUHUDHUYUD(I,J))-4.D0*(HUHDDYDYUD(I,J)
     $                   +YUYDDHDHUD(I,J)+HUYDDYDHUD(I,J)
     $                   +YUHDDHDYUD(I,J))-12.D0*(HUHUD(I,J)*TYUDYU
     $                   +YUYUD(I,J)*THUDHU+HUYUD(I,J)*THUDYU+YUHUD(I,J)
     $                   *TYUDHU)+(6.D0*G(292)**2-2.D0/5.D0*G(291)**2)
     $                   *(CMATMUL(0,DUM2U5,YUYUD,I,J)
     $                   +2.D0*YUMQMYUD(I,J)+YUYUDMUPM(I,J)
     $                   +2.D0*HUHUD(I,J))+12.D0*G(292)**2
     $                   *(2.D0*CMODSQ(G(322))*YUYUD(I,J)-CCON(G(322))
     $                   *HUYUD(I,J)-G(322)*YUHUD(I,J))-4.D0/5.D0
     $                   *G(291)**2*(2.D0*CMODSQ(G(321))*YUYUD(I,J)
     $                   -CCON(G(321))*HUYUD(I,J)-G(321)*YUHUD(I,J))
     $                   +(-8.D0/5.D0*G(291)**2*SP-128.D0/3.D0*G(293)**4
     $                   *CMODSQ(G(323))+512.D0/45.D0*G(293)**2
     $                   *G(291)**2*(CMODSQ(G(323))+CMODSQ(G(321))
     $                   +CRE(2,G(321),G(323)))+3424.D0/75.D0
     $                   *G(291)**4*CMODSQ(G(321))+16.D0/3.D0*G(293)**2
     $                   *SIG3+16.D0/15.D0*G(291)**2*SIG1)*ID(I,J)
            BETA2MD(I,J)=-CMATMUL(0,DUM2D1,YDYDDYDYDD,I,J)-4.D0
     $                   *YDMQMYDDYDYDD(I,J)-4.D0*YDYDDMDMYDYDD(I,J)
     $                   -4.D0*YDYDDYDMQMYDD(I,J)
     $                   -2.D0*YDYDDYDYDDMDM(I,J)
     $                   -CMATMUL(0,DUM2D2,YDYUDYUYDD,I,J)-4.D0
     $                   *YDMQMYUDYUYDD(I,J)-4.D0*YDYUDMUPMYUYDD(I,J)
     $                   -4.D0*YDYUDYUMQMYDD(I,J)
     $                   -2.D0*YDYUDYUYDDMDM(I,J)
     $                   -DUM2D3(I,J)*CTRACE(DUM2D4)-4.D0*YDYDD(I,J)
     $                   *CTRACE(DUM2D5)-4.D0*(HDHDDYDYDD(I,J)
     $                   +YDYDDHDHDD(I,J)+HDYDDYDHDD(I,J)
     $                   +YDHDDHDYDD(I,J))-4.D0*(HDHUDYUYDD(I,J)
     $                   +YDYUDHUHDD(I,J)+HDYUDYUHDD(I,J)
     $                   +YDHUDHUYDD(I,J))-4.D0*HDHDD(I,J)
     $                   *CTRACE(DUM2D6)-4.D0*YDYDD(I,J)*CTRACE(DUM2D7)
     $                   -4.D0*HDYDD(I,J)*CTRACE(DUM2D8)-4.D0*YDHDD(I,J)
     $                   *CTRACE(DUM2D9)+(6.D0*G(292)**2+2.D0/5.D0
     $                   *G(291)**2)*(CMATMUL(0,DUM2DA,YDYDD,I,J)+2.D0
     $                   *YDMQMYDD(I,J)+YDYDDMDM(I,J)+2.D0*HDHDD(I,J))
     $                   +12.D0*G(292)**2*(2.D0*CMODSQ(G(322))
     $                   *YDYDD(I,J)-CCON(G(322))*HDYDD(I,J)-G(322)
     $                   *YDHDD(I,J))+4.D0/5.D0*G(291)**2*(2.D0
     $                   *CMODSQ(G(321))*YDYDD(I,J)-CCON(G(321))
     $                   *HDYDD(I,J)-G(321)*YDHDD(I,J))+(4.D0/5.D0
     $                   *G(291)**2*SP-128.D0/3.D0*G(293)**4
     $                   *CMODSQ(G(323))+128.D0/45.D0*G(293)**2
     $                   *G(291)**2*(CMODSQ(G(323))+CMODSQ(G(321))
     $                   +CRE(2,G(321),G(323)))+808.D0/75.D0*G(291)**4
     $                   *CMODSQ(G(321))+16.D0/3.D0*G(293)**2*SIG3
     $                   +4.D0/15.D0*G(291)**2*SIG1)*ID(I,J)
            BETA2ME(I,J)=-CMATMUL(0,DUM2E1,YEYEDYEYED,I,J)-4.D0
     $                   *YEMLMYEDYEYED(I,J)-4.D0*YEYEDMEMYEYED(I,J)
     $                   -4.D0*YEYEDYEMLMYED(I,J)
     $                   -2.D0*YEYEDYEYEDMEM(I,J)
     $                   -DUM2E2(I,J)*CTRACE(DUM2E3)-4.D0*YEYED(I,J)
     $                   *CTRACE(DUM2E4)-4.D0*(HEHEDYEYED(I,J)
     $                   +YEYEDHEHED(I,J)+HEYEDYEHED(I,J)
     $                   +YEHEDHEYED(I,J))-4.D0*HEHED(I,J)
     $                   *CTRACE(DUM2E5)-4.D0*YEYED(I,J)*CTRACE(DUM2E6)
     $                   -4.D0*HEYED(I,J)*CTRACE(DUM2E7)-4.D0*YEHED(I,J)
     $                   *CTRACE(DUM2E8)+(6.D0*G(292)**2-6.D0/5.D0
     $                   *G(291)**2)*(CMATMUL(0,DUM2E9,YEYED,I,J)+2.D0
     $                   *YEMLMYED(I,J)+YEYEDMEM(I,J)+2.D0*HEHED(I,J))
     $                   +12.D0*G(292)**2*(2.D0*CMODSQ(G(322))
     $                   *YEYED(I,J)-CCON(G(322))*HEYED(I,J)-G(322)
     $                   *YEHED(I,J))-12.D0/5.D0*G(291)**2*(2.D0
     $                   *CMODSQ(G(321))*YEYED(I,J)-CCON(G(321))
     $                   *HEYED(I,J)-G(321)*YEHED(I,J))+(12.D0/5.D0
     $                   *G(291)**2*SP+2808.D0/25.D0*G(291)**4
     $                   *CMODSQ(G(321))+12.D0/5.D0*G(291)**2*SIG1)
     $                   *ID(I,J)
            B2MQM(I,J)=BETA2MQ(I,J)
            B2MLM(I,J)=BETA2ML(I,J)
            B2MUM(I,J)=BETA2MU(I,J)
            B2MDM(I,J)=BETA2MD(I,J)
            B2MEM(I,J)=BETA2ME(I,J)
          END  IF
!
!Calculate the differentials DM
!
          DM(1,I,J)=1.D0/16.D0/PI**2*BETA1MQ(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2MQ(I,J)
          DM(2,I,J)=1.D0/16.D0/PI**2*BETA1ML(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2ML(I,J)
          DM(3,I,J)=1.D0/16.D0/PI**2*BETA1MU(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2MU(I,J)
          DM(4,I,J)=1.D0/16.D0/PI**2*BETA1MD(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2MD(I,J)
          DM(5,I,J)=1.D0/16.D0/PI**2*BETA1ME(I,J)+1.D0/(16.D0*PI**2)**2
     $              *BETA2ME(I,J)
!
!Convert into form readable by RKSTP
!
          F(352+(I-1)*3+J)=DM(1,I,J)
          F(361+(I-1)*3+J)=DM(2,I,J)
          F(370+(I-1)*3+J)=DM(3,I,J)
          F(379+(I-1)*3+J)=DM(4,I,J)
          F(388+(I-1)*3+J)=DM(5,I,J)
        END DO
      END DO
!
!***********************************************************************
!END OF MSSM SECTION
!
!Now I can find the threshold gauge running with a change at m_H to SM
!
      DO I=1,3
        SUM=(0.D0,0.D0)
        DO J=1,3
          IF(THHH.EQ.0)THEN
            SUM=SUM+B2LPSM(I,J)*G(J)**2
          ELSE
            SUM=SUM+B2LPM(I,J)*G(J)**2
          END IF
        END DO
        IF(THHH.EQ.0)THEN
          F(I)=G(I)**3/16.D0/PI**2*(B1LP(I)+DBLE(SW2LP)/16.D0/PI**2
     $         *(SUM-(CSM(I,1)*TLYUDLYU+CSM(I,2)*TLYDDLYD
     $         +CSM(I,3)*TLYEDLYE)))
        ELSE
          F(I)=G(I)**3/16.D0/PI**2*(B1LP(I)+DBLE(SW2LP)/16.D0/PI**2
     $         *(SUM-(CM(I,1)*TYUDYU+CM(I,2)*TYDDYD+CM(I,3)*TYEDYE)))
        END IF
      END DO
!
!Next the full Yukawas
!
      DO I=1,3
        DO J=1,3
          DUMU1(I,J)=THSH*SQFTUQDFTUQ(I,J)
     $               +4.D0/9.D0*THSB*SUGTPUSGTPUT(I,J)
     $               +4.D0/3.D0*THGL*SUGTSUSGTSUT(I,J)
          DUMU2(I,J)=2.D0*THSH*SUFTUUFTUUD(I,J)
     $               +2.D0*THSH*SDFTDDFTDDD(I,J)
     $               +3.D0*THSW*SQGTQTGTQS(I,J)
     $               +1.D0/9.D0*THSB*SQGTPQTGTPQS(I,J)
     $               +16.D0/3.D0*THGL*SQGTSQTGTSQS(I,J)
          DUMD1(I,J)=THSH*SQFTDQDFTDQ(I,J)
     $               +1.D0/9.D0*THSB*SDGTPDSGTPDT(I,J)
     $               +4.D0/3.D0*THGL*SDGTSDSGTSDT(I,J)
          DUMD2(I,J)=2.D0*THSH*SUFTUUFTUUD(I,J)
     $               +2.D0*THSH*SDFTDDFTDDD(I,J)
     $               +3.D0*THSW*SQGTQTGTQS(I,J)
     $               +1.D0/9.D0*THSB*SQGTPQTGTPQS(I,J)
     $               +16.D0/3.D0*THGL*SQGTSQTGTSQS(I,J)
          DUME1(I,J)=THSH*SLFTELDFTEL(I,J)+THSB*SEGTPESGTPET(I,J)
          DUME2(I,J)=2.D0*THSH*SEFTEEFTEED(I,J)
     $               +3.D0*THSW*SLGTLTGTLS(I,J)+THSB*SLGTPLTGTPLS(I,J)
        END DO
      END DO
!
      DO I=1,3
        DO J=1,3
!
          B1U(I,J)=1.D0/2.D0*(3.D0*FUFUDFU(I,J)+FDFDDFU(I,J))
     $             +CMATMUL(0,FU,DUMU1,I,J)
     $             +1.D0/4.D0*CMATMUL(0,DUMU2,FU,I,J)
     $             +THSH*(-3.D0*THSW*CONJG(G(204))
     $              *SQGTQTFTUQ(I,J)+1.D0/3.D0*THSB
     $              *CONJG(G(184))*SQGTPQTFTUQ(I,J))
     $             -4.D0/3.D0*THSB*THSH*CONJG(G(184))
     $              *SUFTUUGTPUT(I,J)
     $             +FU(I,J)*3.D0*TFUDFU
     $             +1.D0/2.D0*THSH*FU(I,J)*(3.D0*THSW*MGTHUSQ
     $              +THSB*MGTPHUSQ)
     $             -FU(I,J)*(17.D0/20.D0*G(1)**2
     $              +9.D0/4.D0*G(2)**2+8.D0*G(3)**2)
!
          B1D(I,J)=1.D0/2.D0*(3.D0*FDFDDFD(I,J)+FUFUDFD(I,J))
     $             +CMATMUL(0,FD,DUMD1,I,J)
     $             +1.D0/4.D0*CMATMUL(0,DUMD2,FD,I,J)
     $             +THSH*(-3.D0*THSW*CONJG(G(205))
     $              *SQGTQTFTDQ(I,J)-1.D0/3.D0*THSB
     $              *CONJG(G(185))*SQGTPQTFTDQ(I,J))
     $             -2.D0/3.D0*THSB*THSH*CONJG(G(185))
     $              *SDFTDDGTPDT(I,J)
     $             +FD(I,J)*(3.D0*TFDDFD+TFEDFE)
     $             +1.D0/2.D0*THSH*FD(I,J)*(3.D0*THSW*MGTHDSQ
     $              +THSB*MGTPHDSQ)
     $             -FD(I,J)*(3.D0/12.D0*G(1)**2
     $              +9.D0/4.D0*G(2)**2+8.D0*G(3)**2)
!
          B1E(I,J)=3.D0/2.D0*FEFEDFE(I,J)
     $             +CMATMUL(0,FE,DUME1,I,J)
     $             +1.D0/4.D0*CMATMUL(0,DUME2,FE,I,J)
     $             +THSH*(-3.D0*THSW*CONJG(G(205))
     $              *SLGTLTFTEL(I,J)+THSB
     $              *CONJG(G(185))*SLGTPLTFTEL(I,J))
     $             -2.D0*THSB*THSH*CONJG(G(185))
     $              *SEFTEEGTPET(I,J)
     $             +FE(I,J)*(3.D0*TFDDFD+TFEDFE)
     $             +1.D0/2.D0*THSH*FE(I,J)*(3.D0*THSW*MGTHDSQ
     $              +THSB*MGTPHDSQ)
     $             -FE(I,J)*(9.D0/4.D0*G(1)**2
     $              +9.D0/4.D0*G(2)**2)
        END DO
      END DO
      DO I=1,3
        DO J=1,3
!
!Convert into form readable by RKSTP. The transpose in BETA2 takes
!account of the differences in notation.
!
          F(3+(I-1)*3+J)=(1.D0/16.D0/PI**2*B1U(I,J)
     $                   +1.D0/(16.D0*PI**2)**2*B2YMU(J,I))*THHH
          F(12+(I-1)*3+J)=(1.D0/16.D0/PI**2*B1D(I,J)
     $                    +1.D0/(16.D0*PI**2)**2*B2YMD(J,I))*THHH
          F(21+(I-1)*3+J)=(1.D0/16.D0/PI**2*B1E(I,J)
     $                    +1.D0/(16.D0*PI**2)**2*B2YME(J,I))*THHH
        END DO
      END DO
!
!The lambdas use the same dummy matrices. I will reuse the betas
!Only find the lambdas if we are below m_H
!
      IF(THHH.EQ.0)THEN
        DO I=1,3
          DO J=1,3
            B1U(I,J)=(0.D0,0.D0)
            B1D(I,J)=(0.D0,0.D0)
            B1E(I,J)=(0.D0,0.D0)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            IF(SW2LP.EQ.1)THEN
              DUM2U(I,J)=3.D0/2.D0*LYUDLYU2(I,J)
     $                  -LYUDLYULYDDLYD(I,J)
     $                  -1.D0/4.D0*LYDDLYDLYUDLYU(I,J)
     $                  +11.D0/4.D0*LYDDLYD2(I,J)
     $                  +Y2*(5.D0/4.D0*LYDDLYD(I,J)-9.D0/4.D0
     $                  *LYUDLYU(I,J))-CHI4*ID(I,J)+3.D0/2.D0
     $                  *G(429)**2*ID(I,J)-2.D0*G(429)*(3.D0
     $                  *LYUDLYU(I,J)+LYDDLYD(I,J))+(221.D0/80.D0
     $                  *G(1)**2+117.D0/16.D0*G(2)**2+20.D0
     $                  *G(3)**2)*LYUDLYU(I,J)-(17.D0/80.D0*G(1)**2
     $                  -27.D0/16.D0*G(2)**2+20.D0*G(3)**2)
     $                  *LYDDLYD(I,J)+Y4*ID(I,J)+((7.D0/150.D0
     $                  +2.D0/3.D0*NG)*G(1)**4-9.D0/20.D0*G(1)**2
     $                  *G(2)**2+19.D0/15.D0*G(1)**2*G(3)**2
     $                  -(101.D0/8.D0-2.D0*NG)*G(2)**4+9.D0*G(2)**2
     $                  *G(3)**2-(292.D0/3.D0-16.D0/3.D0*NG)
     $                  *G(3)**4)*ID(I,J)
              DUM2D(I,J)=3.D0/2.D0*LYDDLYD2(I,J)
     $                  -LYDDLYDLYUDLYU(I,J)
     $                  -1.D0/4.D0*LYUDLYULYDDLYD(I,J)
     $                  +11.D0/4.D0*LYUDLYU2(I,J)
     $                  +Y2*(5.D0/4.D0*LYUDLYU(I,J)-9.D0/4.D0
     $                  *LYDDLYD(I,J))-CHI4*ID(I,J)+3.D0/2.D0
     $                  *G(429)**2*ID(I,J)-2.D0*G(429)*(3.D0
     $                  *LYDDLYD(I,J)+LYUDLYU(I,J))+(161.D0/80.D0
     $                  *G(1)**2+117.D0/16.D0*G(2)**2+20.D0
     $                  *G(3)**2)*LYDDLYD(I,J)-(77.D0/80.D0*G(1)**2
     $                  -27.D0/16.D0*G(2)**2+20.D0*G(3)**2)
     $                  *LYUDLYU(I,J)+Y4*ID(I,J)+(-(37.D0/300.D0
     $                  -4.D0/15.D0*NG)*G(1)**4-27.D0/20.D0*G(1)**2
     $                  *G(2)**2+31.D0/15.D0*G(1)**2*G(3)**2
     $                  -(101.D0/8.D0-2.D0*NG)*G(2)**4+9.D0*G(2)**2
     $                  *G(3)**2-(292.D0/3.D0-16.D0/3.D0*NG)
     $                  *G(3)**4)*ID(I,J)
              DUM2E(I,J)=3.D0/2.D0*LYEDLYE2(I,J)
     $                  -Y2*9.D0/4.D0*LYEDLYE(I,J)-CHI4*ID(I,J)
     $                  +3.D0/2.D0*G(429)**2*ID(I,J)-6.D0*G(429)
     $                  *LYEDLYE(I,J)+(441.D0/80.D0*G(1)**2
     $                  +117.D0/16.D0*G(2)**2)*LYEDLYE(I,J)
     $                  +Y4*ID(I,J)+((21.D0/100.D0+8.D0/5.D0*NG)
     $                  *G(1)**4+27.D0/20.D0*G(1)**2*G(2)**2
     $                  -(101.D0/8.D0-2.D0*NG)*G(2)**4)*ID(I,J)
            ELSE
              DUM2U(I,J)=(0.D0,0.D0)
              DUM2D(I,J)=(0.D0,0.D0)
              DUM2E(I,J)=(0.D0,0.D0)
            END IF
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            B1U(I,J)=1.D0/2.D0*(3.D0*LULUDLU(I,J)+LDLDDLU(I,J)
     $                -4.D0*LDLDDLU(I,J))
     $               +CMATMUL(0,LU,DUMU1,I,J)
     $               +1.D0/4.D0*CMATMUL(0,DUMU2,LU,I,J)
     $               +THSH*(-3.D0*THSW*CONJG(G(289))
     $                *SQGTQTFTUQ(I,J)+1.D0/3.D0*THSB
     $                *CONJG(G(287))*SQGTPQTFTUQ(I,J))
     $               -4.D0/3.D0*THSB*THSH*CONJG(G(287))
     $                *SUFTUUGTPUT(I,J)
     $               +LU(I,J)*(3.D0*TLUDLU+3.D0*TLDDLD+TLEDLE)
     $               +1.D0/2.D0*THSH*LU(I,J)*(3.D0*THSW
     $                *(MSGTHUSQ+MCGTHDSQ)+THSB
     $                *(MSGTPHUSQ+MCGTPHDSQ))
     $               -LU(I,J)*(17.D0/20.D0*G(1)**2
     $                +9.D0/4.D0*G(2)**2+8.D0*G(3)**2)
            B1D(I,J)=1.D0/2.D0*(3.D0*LDLDDLD(I,J)+LULUDLD(I,J)
     $                -4.D0*LULUDLD(I,J))
     $               +CMATMUL(0,LD,DUMD1,I,J)
     $               +1.D0/4.D0*CMATMUL(0,DUMD2,LD,I,J)
     $               +THSH*(-3.D0*THSW*CONJG(G(290))
     $                *SQGTQTFTDQ(I,J)-1.D0/3.D0*THSB
     $                *CONJG(G(288))*SQGTPQTFTDQ(I,J))
     $               -2.D0/3.D0*THSB*THSH*CONJG(G(288))
     $                *SDFTDDGTPDT(I,J)
     $               +LD(I,J)*(3.D0*TLUDLU+3.D0*TLDDLD+TLEDLE)
     $               +1.D0/2.D0*THSH*LD(I,J)*(3.D0*THSW
     $                *(MSGTHUSQ+MCGTHDSQ)+THSB
     $                *(MSGTPHUSQ+MCGTPHDSQ))
     $               -LD(I,J)*(3.D0/12.D0*G(1)**2
     $                +9.D0/4.D0*G(2)**2+8.D0*G(3)**2)
            B1E(I,J)=3.D0/2.D0*LELEDLE(I,J)+CMATMUL(0,LE,DUME1,I,J)
     $               +1.D0/4.D0*CMATMUL(0,DUME2,LE,I,J)
     $               +THSH*(-3.D0*THSW*CONJG(G(290))
     $                *SLGTLTFTEL(I,J)+THSB
     $                *CONJG(G(288))*SLGTPLTFTEL(I,J))
     $               -2.D0*THSB*THSH*CONJG(G(288))
     $                *SEFTEEGTPET(I,J)
     $               +LE(I,J)*(3.D0*TLUDLU+3.D0*TLDDLD+TLEDLE)
     $               +1.D0/2.D0*THSH*LE(I,J)*(3.D0*THSW
     $                *(MSGTHUSQ+MCGTHDSQ)+THSB
     $                *(MSGTPHUSQ+MCGTPHDSQ))
     $               -LE(I,J)*(9.D0/4.D0*G(1)**2
     $                +9.D0/4.D0*G(2)**2)
!
            IF(SW2LP.EQ.1)THEN
              BETA2U(I,J)=CMATMUL(0,LYU,DUM2U,I,J)
              BETA2D(I,J)=CMATMUL(0,LYD,DUM2D,I,J)
              BETA2E(I,J)=CMATMUL(0,LYE,DUM2E,I,J)
            END IF
          END DO
        END DO
        DO I=1,3
          DO J=1,3
!
!Convert into form readable by RKSTP.
!
            F(111+(I-1)*3+J)=1.D0/16.D0/PI**2*B1U(I,J)
     $              +1.D0/(16.D0*PI**2)**2*BETA2U(J,I)
            F(120+(I-1)*3+J)=1.D0/16.D0/PI**2*B1D(I,J)
     $              +1.D0/(16.D0*PI**2)**2*BETA2D(J,I)
            F(129+(I-1)*3+J)=1.D0/16.D0/PI**2*B1E(I,J)
     $              +1.D0/(16.D0*PI**2)**2*BETA2E(J,I)
          END DO
        END DO
      END IF
!
!Next I am going to work out the gaugino terms, \mu and M_{1,2,3}
!and the running of B in MV notation
!
      DO I=1,3
        DO J=1,3
          DUMGRKMU1(I,J)=3.D0*SUFTUUFTUUD(I,J)+3.D0*SDFTDDFTDDD(I,J)
     $                   +SEFTEEFTEED(I,J)+3.D0*SQFTUQDFTUQ(I,J)
     $                   +3.D0*SQFTDQDFTDQ(I,J)+SLFTELDFTEL(I,J)
!
          DUMM1(I,J)=1.D0/3.D0*SQGTPQDGTPQ(I,J)+SLGTPLDGTPL(I,J)
     $               +8.D0/3.D0*SUGTPUGTPUD(I,J)
     $               +2.D0/3.D0*SDGTPDGTPDD(I,J)+2.D0*SEGTPEGTPED(I,J)
!
          DUMM2(I,J)=3.D0*SQGTQDGTQ(I,J)+SLGTLDGTL(I,J)
!
          DUMM3(I,J)=2.D0*SQGTSQDGTSQ(I,J)+SUGTSUGTSUD(I,J)
     $               +SDGTSDGTSDD(I,J)
!     
        END DO
      END DO
      TDUMGRKMU=CTRACE(DUMGRKMU1)
      TDUMM1=CTRACE(DUMM1)
      TDUMM2=CTRACE(DUMM2)
      TDUMM3=CTRACE(DUMM3)
      SQTSUMTSFUSAUT=TCSFMUL(THSQ,SUMTSFUSAUT)
      SQTSDMTSFDSADT=TCSFMUL(THSQ,SDMTSFDSADT)
      SLTSEMTSFESAET=TCSFMUL(THSL,SEMTSFESAET)
!
      IF(THHH.EQ.0)THEN
        BM(1)=G(31)*(TDUMM1+THSH*(MSGTPHUSQ+MCGTPHDSQ))
     $        -2.D0*THSH*(G(287)*CONJG(G(108))*G(288)
     $                    +CONJG(G(287))*G(108)*CONJG(G(288)))
!
        BM(2)=G(32)*(TDUMM2+THSH*(MSGTHUSQ+MCGTHDSQ))
     $        -2.D0*THSH*(G(289)*CONJG(G(108))*G(290)
     $                    +CONJG(G(289))*G(108)*CONJG(G(290)))
     $       -12.D0*G(32)*G(2)**2
!
        BM(3)=G(33)*TDUMM3-18.D0*G(33)*G(3)**2
!
        BGRKMU=1.D0/2.D0*G(108)*THSH*TDUMGRKMU
     $       +1.D0/4.D0*G(108)*THSH*((3.D0*THSW*MSGTHUSQ+THSB*MSGTPHUSQ)
     $        +(3.D0*THSW*MCGTHDSQ+THSB*MCGTPHDSQ))
     $       -(3.D0*THSW*G(289)*(G(32)+(0.D0,1.D0)*G(600))*G(290)
     $        +THSB*G(287)*(G(31)+(0.D0,1.D0)*G(599))*G(288))
     $       -G(108)*(9.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2)
!
        BETA1B=(0.D0,0.D0)
      ELSE
        BM(1)=G(31)*(TDUMM1+THSH*(MGTPHUSQ+MGTPHDSQ))
!
        BM(2)=G(32)*(TDUMM2+THSH*(MGTHUSQ+MGTHDSQ))
     $        -12.D0*G(32)*G(2)**2
!
        BM(3)=G(33)*TDUMM3-18.D0*G(33)*G(3)**2
!
        BGRKMU=1.D0/2.D0*G(108)*THSH*TDUMGRKMU
     $         +1.D0/4.D0*G(108)*THSH*(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ
     $          +3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $         -G(108)*(9.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2)
        BETA1B=-1.D0/2.D0*(G(457)**2+3.D0*G(458)**2)*G(109)
     $         +6.D0*SQTSUMTSFUSAUT
     $         +6.D0*SQTSDMTSFDSADT
     $         +2.D0*SLTSEMTSFESAET
     $         -(2.D0*THSH*THSB*G(108)*CONJG(G(184))*CONJG(G(185))
     $          *(G(31)-(0.D0,1.D0)*G(599))+6.D0*THSH*THSW*G(108)
     $          *CONJG(G(204))*CONJG(G(205))*(G(32)-(0.D0,1.D0)*G(600)))
     $         -(9.D0*G(1)**2/10.D0+9.D0*G(2)**2/2.D0)*G(109)
     $         +1.D0/2.D0*(6.D0*TFUDFU+6.D0*TFDDFD+2.D0*TFEDFE
     $          +THSB*THSH*(MGTPHUSQ+MGTPHDSQ)+3.D0*THSW*THSH
     $          *(MGTHUSQ+MGTHDSQ))*G(109)
      END IF
!
!The RKSTP compatible derivatives are: (with a minus sign
!to convert the two loop mu running to BT notation)
!NB: There is some work here converting the MSSM MV notation
!    M_{1,2,3} 2-lp beta functions to BT notation.
!
      F(31)=THSB*(1.D0/16.D0/PI**2*BM(1)
     $      +1.D0/(16.D0*PI**2)**2*1.D0/2.D0*(B2M(1)+CONJG(B2M(1))))
      F(32)=THSW*(1.D0/16.D0/PI**2*BM(2)
     $      +1.D0/(16.D0*PI**2)**2*1.D0/2.D0*(B2M(2)+CONJG(B2M(2))))
      F(33)=THGL*(1.D0/16.D0/PI**2*BM(3)
     $      +1.D0/(16.D0*PI**2)**2*1.D0/2.D0*(B2M(3)+CONJG(B2M(3))))
!
      F(108)=(1.D0/16.D0/PI**2*BGRKMU+1.D0/(16.D0*PI**2)**2*B2GRKMUM)
     $                                                            *THSH
      IF(THHH.EQ.1)THEN
        F(109)=1.D0/16.D0/PI**2*BETA1B-1.D0/(16.D0*PI**2)**2*BETA2BM
      END IF
!
!V_U and V_D - from PRD 49,4882 (1994)
!
      BETA1VU=3.D0/4.D0*(1.D0/5.D0*G(291)**2+G(292)**2)-3.D0*TYUDYU
      BETA1VD=3.D0/4.D0*(1.D0/5.D0*G(291)**2+G(292)**2)-3.D0*TYDDYD
     $        -TYEDYE
      IF(SW2LP.EQ.1)THEN
        BETA2VU=3.D0/4.D0*(3.D0*TYUDYUYUDYU+3.D0*TYUDYUYDDYD)-(19.D0
     $          /10.D0*G(291)**2+9.D0/2.D0*G(292)**2+20.D0*G(293)**2)
     $          *TYUDYU-(279.D0/800.D0+1803.D0/1600.D0*3.D0)*G(291)**4
     $          -(207.D0/32.D0+357.D0/64.D0*3.D0)*G(292)**4-(27.D0/80.D0
     $          +9.D0/80.D0*3.D0)*G(291)**2*G(292)**2
        BETA2VD=3.D0/4.D0*(3.D0*TYDDYDYDDYD+3.D0*TYDDYDYUDYU
     $          +TYEDYEYEDYE)-(2.D0/5.D0*G(291)**2+9.D0/2.D0*G(292)**2
     $          +20.D0*G(293)**2)*TYDDYD-(9.D0/5.D0*G(291)**2+3.D0/2.D0
     $          *G(292)**2)*TYEDYE-(279.D0/800.D0+1803.D0/1600.D0*3.D0)
     $          *G(291)**4-(207.D0/32.D0+357.D0/64.D0*3.D0)*G(292)**4
     $          -(27.D0/80.D0+9.D0/80.D0*3.D0)*G(291)**2*G(292)**2
      END IF
!
      F(110)=THHH*(G(110)*(1.D0/16.D0/PI**2*BETA1VU
     $             +1.D0/(16.D0*PI**2)**2*BETA2VU))
      F(111)=THHH*(G(111)*(1.D0/16.D0/PI**2*BETA1VD
     $             +1.D0/(16.D0*PI**2)**2*BETA2VD))
!
!Now the trilinear couplings - it should be ok to use the same
!dummy matrices, but the betas must be reset
!
      DO I=1,3
        DO J=1,3
          BETA1U(I,J)=(0.D0,0.D0)
          BETA2U(I,J)=(0.D0,0.D0)
          BETA1D(I,J)=(0.D0,0.D0)
          BETA2D(I,J)=(0.D0,0.D0)
          BETA1E(I,J)=(0.D0,0.D0)
          BETA2E(I,J)=(0.D0,0.D0)
        END DO
      END DO
!
!Some common terms
!
      DO I=1,3
        DO J=1,3
          DUM1U1(I,J)=8.D0/9.D0*THSB*GTPUTGTPUS(I,J)
     $               +8.D0/3.D0*THGL*GTSUTGTSUS(I,J)
     $               +2.D0*THSH*FTUUDFTUU(I,J)
          DUM1U2(I,J)=THSH*FTUQFTUQD(I,J)+THSH*FTDQFTDQD(I,J)
     $               +1.D0/18.D0*THSB*GTPQSGTPQT(I,J)
     $               +3.D0/2.D0*THSW*GTQSGTQT(I,J)
     $               +8.D0/3.D0*THGL*GTSQSGTSQT(I,J)
!
          DUM1D1(I,J)=DUM1U2(I,J)
          DUM1D2(I,J)=2.D0/9.D0*THSB*GTPDTGTPDS(I,J)
     $               +8.D0/3.D0*THGL*GTSDTGTSDS(I,J)
     $               +2.D0*THSH*FTDDDFTDD(I,J)
!
          DUM1E1(I,J)=THSH*FTELFTELD(I,J)
     $               +1.D0/2.D0*THSB*GTPLSGTPLT(I,J)
     $               +3.D0/2.D0*THSW*GTLSGTLT(I,J)
          DUM1E2(I,J)=2.D0*THSB*GTPETGTPES(I,J)
     $               +2.D0*THSH*FTEEDFTEE(I,J)
        END DO
      END DO
!
!Running above m_H first
!
      IF(THHH.EQ.1)THEN
        DO I=1,3
          DO J=1,3
            SUAUID(I,J)=CSFMUL(THSU,AU,ID,I,J)
            SUAUFUQDFUQ(I,J)=CSFMUL(THSU,AU,FUQDFUQ,I,J)
            SQIDAU(I,J)=CSFMUL(THSQ,ID,AU,I,J)
            SQFUHUDAU(I,J)=CSFMUL(THSQ,FUHUD,AU,I,J)
            SQFUURFUURDAU(I,J)=CSFMUL(THSQ,FUURFUURD,AU,I,J)
            SDADFDQDFUQ(I,J)=CSFMUL(THSD,AD,FDQDFUQ,I,J)
!
            SQIDAD(I,J)=CSFMUL(THSQ,ID,AD,I,J)
            SQFDDRFDDRDAD(I,J)=CSFMUL(THSQ,FDDRFDDRD,AD,I,J)
            SQFDHDDAD(I,J)=CSFMUL(THSQ,FDHDD,AD,I,J)
            SLFEHDDAE(I,J)=CSFMUL(THSL,FEHDD,AE,I,J)
            SDADID(I,J)=CSFMUL(THSD,AD,ID,I,J)
            SDADFDQDFDQ(I,J)=CSFMUL(THSD,AD,FDQDFDQ,I,J)
            SUAUFUQDFDQ(I,J)=CSFMUL(THSU,AU,FUQDFDQ,I,J)
!
            SLIDAE(I,J)=CSFMUL(THSL,ID,AE,I,J)
            SLFEERFEERDAE(I,J)=CSFMUL(THSL,FEERFEERD,AE,I,J)
            SEAEID(I,J)=CSFMUL(THSE,AE,ID,I,J)
            SEAEFELDFEL(I,J)=CSFMUL(THSE,AE,FELDFEL,I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            SUSQIDAUID(I,J)=CSFMUL(THSU,SQIDAU,ID,I,J)
            SDSQIDADID(I,J)=CSFMUL(THSD,SQIDAD,ID,I,J)
            SESLIDAEID(I,J)=CSFMUL(THSE,SLIDAE,ID,I,J)
          END DO
        END DO
        SUTSQFUHUDAU=TCSFMUL(THSU,SQFUHUDAU)
        SDTSQFDHDDAD=TCSFMUL(THSD,SQFDHDDAD)
        SETSLFEHDDAE=TCSFMUL(THSE,SLFEHDDAE)
        DO I=1,3
          DO J=1,3
            BETA1U(I,J)=-2.D0/3.D0*G(457)**2*SUAUID(I,J)
     $                 +2.D0*SUAUFUQDFUQ(I,J)
     $                 -2.D0*(G(457)**2/9.D0+4.D0*G(459)**2/3.D0)
     $                  *SUSQIDAUID(I,J)
     $                 +6.D0*FUHU(I,J)*SUTSQFUHUDAU
     $                 +(G(457)**2/6.D0-3.D0*G(458)**2/2.D0)*SQIDAU(I,J)
     $                 +4.D0*SQFUURFUURDAU(I,J)
     $                 +2.D0*SDADFDQDFUQ(I,J)
     $                 +2.D0/3.D0*THSB*(G(31)-(0.D0,1.D0)*G(599))
     $                  *(THSH*CONJG(G(184))*GTPQSFTUU(I,J)
     $                  -4.D0/3.D0*GTPQSFUGTPUS(I,J)
     $                  -4.D0*THSH*FTUQGTPUS(I,J)*CONJG(G(184)))
     $                 -32.D0/3.D0*THGL*(G(33)-(0.D0,1.D0)*G(601))
     $                  *GTSQSFUGTSUS(I,J)
     $                 -6.D0*THSW*THSH*(G(32)-(0.D0,1.D0)*G(600))
     $                  *CONJG(G(204))*GTQSFTUU(I,J)
     $                 +CSFMUL(THSU,AU,DUM1U1,I,J)
     $                 +(3.D0*TFUDFU+1.D0/2.D0*THSH*THSB*MGTPHUSQ
     $                  +3.D0/2.D0*THSH*THSW*MGTHUSQ)*AU(I,J)
     $                 +CSFMUL(THSQ,DUM1U2,AU,I,J)
     $                 -(13.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2
     $                  +8.D0*G(3)**2)*AU(I,J)
!
            BETA1D(I,J)=-(G(457)**2/6.D0+3.D0*G(458)**2/2.D0)
     $                  *SQIDAD(I,J)
     $                 +4.D0*SQFDDRFDDRDAD(I,J)
     $                 +2.D0*(G(457)**2/18.D0-4.D0*G(459)**2/3.D0)
     $                  *SDSQIDADID(I,J)
     $                 +6.D0*FDHD(I,J)*SDTSQFDHDDAD
     $                 +2.D0*FDHD(I,J)*SETSLFEHDDAE
     $                 -1.D0/3.D0*G(457)**2*SDADID(I,J)
     $                 +2.D0*SDADFDQDFDQ(I,J)
     $                 +2.D0*SUAUFUQDFDQ(I,J)
     $                 +2.D0/3.D0*THSB*(G(31)-(0.D0,1.D0)*G(599))
     $                  *(-THSH*CONJG(G(185))*GTPQSFTDD(I,J)
     $                  +2.D0/3.D0*GTPQSFDGTPDS(I,J)
     $                  -2.D0*THSH*FTDQGTPDS(I,J)*CONJG(G(185)))
     $                 -32.D0/3.D0*THGL*(G(33)-(0.D0,1.D0)*G(601))
     $                  *GTSQSFDGTSDS(I,J)
     $                 -6.D0*THSW*THSH*(G(32)-(0.D0,1.D0)*G(600))
     $                  *CONJG(G(205))*GTQSFTDD(I,J)
     $                 +CSFMUL(THSQ,DUM1D1,AD,I,J)
     $                 +(3.D0*TFDDFD+TFEDFE
     $                  +1.D0/2.D0*THSH*THSB*MGTPHDSQ
     $                  +3.D0/2.D0*THSH*THSW*MGTHDSQ)*AD(I,J)
     $                 +CSFMUL(THSD,AD,DUM1D2,I,J)
     $                 -(7.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2
     $                  +8.D0*G(3)**2)*AD(I,J)
!
            BETA1E(I,J)=(G(457)**2/2.D0-3.D0*G(458)**2/2.D0)*SLIDAE(I,J)
     $                 +4.D0*SLFEERFEERDAE(I,J)
     $                 -G(457)**2*SESLIDAEID(I,J)
     $                 +2.D0*FEHD(I,J)*SETSLFEHDDAE
     $                 +6.D0*FEHD(I,J)*SDTSQFDHDDAD
     $                 -G(457)**2*SEAEID(I,J)
     $                 +2.D0*SEAEFELDFEL(I,J)
     $                 +2.D0*THSB*(G(31)-(0.D0,1.D0)*G(599))
     $                  *(THSH*CONJG(G(185))*GTPLSFTEE(I,J)
     $                  -2.D0*GTPLSFEGTPES(I,J)
     $                  -2.D0*THSH*FTELGTPES(I,J)*CONJG(G(185)))
     $                 -6.D0*THSW*THSH*(G(32)-(0.D0,1.D0)*G(600))
     $                  *CONJG(G(205))*GTLSFTEE(I,J)
     $                 +CSFMUL(THSL,DUM1E1,AE,I,J)
     $                 +(3.D0*TFDDFD+TFEDFE
     $                  +1.D0/2.D0*THSH*THSB*MGTPHDSQ
     $                  +3.D0/2.D0*THSH*THSW*MGTHDSQ)*AE(I,J)
     $                 +CSFMUL(THSE,AE,DUM1E2,I,J)
     $                 -(27.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2)
     $                  *AE(I,J)
          END DO
        END DO
!
!Convert into form readable by RKSTP (converting 2-lp to BT notation...)
!
        DO I=1,3
          DO J=1,3
            F(33+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BETA1U(I,J)
     $                      -1.D0/(16.D0*PI**2)**2*B2HMU(J,I))*THSU(J)
            F(42+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BETA1D(I,J)
     $                      -1.D0/(16.D0*PI**2)**2*B2HMD(J,I))*THSD(J)
            F(51+(I-1)*3+J)=THSL(I)*(1.D0/16.D0/PI**2*BETA1E(I,J)
     $                      -1.D0/(16.D0*PI**2)**2*B2HME(J,I))*THSE(J)
          END DO
        END DO
      ELSE
        DO I=1,3
          DO J=1,3
            SUTRIUID(I,J)=CSFMUL(THSU,TRIU,ID,I,J)
            SUTRIUSFUQDSFUQ(I,J)=CSFMUL(THSU,TRIU,SFUQDSFUQ,I,J)
            SQIDTRIU(I,J)=CSFMUL(THSQ,ID,TRIU,I,J)
            SQFUHUDTRIU(I,J)=CSFMUL(THSQ,FUHUD,TRIU,I,J)
            SQSFUURSFUURDTRIU(I,J)=CSFMUL(THSQ,SFUURSFUURD,TRIU,I,J)
            SQCFDDRCFDDRDTRIU(I,J)=CSFMUL(THSQ,CFDDRCFDDRD,TRIU,I,J)
!
            SQIDTRID(I,J)=CSFMUL(THSQ,ID,TRID,I,J)
            SQSFUURSFUURDTRID(I,J)=CSFMUL(THSQ,SFUURSFUURD,TRID,I,J)
            SQCFDDRCFDDRDTRID(I,J)=CSFMUL(THSQ,CFDDRCFDDRD,TRID,I,J)
            SQFDHDDTRID(I,J)=CSFMUL(THSQ,FDHDD,TRID,I,J)
            SLFEHDDTRIE(I,J)=CSFMUL(THSL,FEHDD,TRIE,I,J)
            SDTRIDID(I,J)=CSFMUL(THSD,TRID,ID,I,J)
            SDTRIDCFDQDCFDQ(I,J)=CSFMUL(THSD,TRID,CFDQDCFDQ,I,J)
!
            SLIDTRIE(I,J)=CSFMUL(THSL,ID,TRIE,I,J)
            SLCFEERCFEERDTRIE(I,J)=CSFMUL(THSL,CFEERCFEERD,TRIE,I,J)
            SETRIEID(I,J)=CSFMUL(THSE,TRIE,ID,I,J)
            SETRIECFELDCFEL(I,J)=CSFMUL(THSE,TRIE,CFELDCFEL,I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            SUSQIDTRIUID(I,J)=CSFMUL(THSU,SQIDTRIU,ID,I,J)
            SDSQIDTRIDID(I,J)=CSFMUL(THSD,SQIDTRID,ID,I,J)
            SESLIDTRIEID(I,J)=CSFMUL(THSE,SLIDTRIE,ID,I,J)
          END DO
        END DO
        SUTSQFUHUDTRIU=TCSFMUL(THSU,SQFUHUDTRIU)
        SDTSQFDHDDTRID=TCSFMUL(THSD,SQFDHDDTRID)
        SETSLFEHDDTRIE=TCSFMUL(THSE,SLFEHDDTRIE)
        DO I=1,3
          DO J=1,3
            B1TRIU(I,J)=2.D0*G(541)**2/3.D0*SUTRIUID(I,J)
     $                 +2.D0*SUTRIUSFUQDSFUQ(I,J)
     $                 -2.D0*(G(457)**2/9.D0+4.D0*G(459)**2/3.D0)
     $                  *SUSQIDTRIUID(I,J)
     $                 +6.D0*FUHU(I,J)*SUTSQFUHUDTRIU
     $                 -2.D0*(G(541)**2/12.D0-3.D0*G(542)**2/4.D0)
     $                  *SQIDTRIU(I,J)
     $                 +4.D0*SQSFUURSFUURDTRIU(I,J)
     $                 -2.D0*SQCFDDRCFDDRDTRIU(I,J)
     $                 +2.D0/3.D0*THSB*(G(31)-(0.D0,1.D0)*G(599))
     $                  *(THSH*CONJG(G(287))*GTPQSFTUU(I,J)
     $                  -4.D0/3.D0*GTPQSLUGTPUS(I,J)
     $                  -4.D0*THSH*FTUQGTPUS(I,J)*CONJG(G(287)))
     $                 -32.D0/3.D0*THGL*(G(33)-(0.D0,1.D0)*G(601))
     $                  *GTSQSLUGTSUS(I,J)
     $                 -6.D0*THSW*THSH*(G(32)-(0.D0,1.D0)*G(600))
     $                  *CONJG(G(289))*GTQSFTUU(I,J)
     $                 +2.D0/3.D0*THSB*THSH*CONJG(G(108))*G(288)
     $                  *(4.D0*FTUQGTPUS(I,J)-GTPQSFTUU(I,J))
     $                 +6.D0*THSH*THSW*CONJG(G(108))*G(290)
     $                  *GTQSFTUU(I,J)
     $                 -4.D0*THSH*CONJG(G(108))*FTDQLDDFTUU(I,J)
     $                 +CSFMUL(THSU,TRIU,DUM1U1,I,J)
     $                 +(3.D0*TLUDLU+3.D0*TLDDLD+TLEDLE)*TRIU(I,J)
     $                 +1.D0/2.D0*(THSB*MCGTPHDSQ+3.D0*THSW*MCGTHDSQ
     $                  +THSB*MSGTPHUSQ+3.D0*MSGTHUSQ)*THSH*TRIU(I,J)
     $                 +CSFMUL(THSQ,DUM1U2,TRIU,I,J)
     $                 -(13.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2
     $                  +8.D0*G(3)**2)*TRIU(I,J)
!
            B1TRID(I,J)=-2.D0*(G(541)**2/12.D0+3.D0*G(542)**2/4.D0)
     $                  *SQIDTRID(I,J)
     $                 -2.D0*SQSFUURSFUURDTRID(I,J)
     $                 +4.D0*SQCFDDRCFDDRDTRID(I,J)
     $                 +2.D0*(G(457)**2/18.D0-4.D0*G(459)**2/3.D0)
     $                  *SDSQIDTRIDID(I,J)
     $                 +6.D0*FDHD(I,J)*SDTSQFDHDDTRID
     $                 +2.D0*FDHD(I,J)*SETSLFEHDDTRIE
     $                 -G(541)**2/3.D0*SDTRIDID(I,J)
     $                 +2.D0*SDTRIDCFDQDCFDQ(I,J)
     $                 -4.D0*THSH*CONJG(G(108))*FTUQLUDFTDD(I,J)
     $                 +2.D0/3.D0*THSB*THSH*CONJG(G(108))*G(287)
     $                  *(2.D0*FTDQGTPDS(I,J)+GTPQSFTDD(I,J))
     $                 +6.D0*THSH*THSW*CONJG(G(108))*G(289)
     $                  *GTQSFTDD(I,J)
     $                 +2.D0/3.D0*THSB*(G(31)-(0.D0,1.D0)*G(599))
     $                  *(-THSH*CONJG(G(288))*GTPQSFTDD(I,J)
     $                  +2.D0/3.D0*GTPQSLDGTPDS(I,J)
     $                  -2.D0*THSH*FTDQGTPDS(I,J)*CONJG(G(288)))
     $                 -32.D0/3.D0*THGL*(G(33)-(0.D0,1.D0)*G(601))
     $                  *GTSQSLDGTSDS(I,J)
     $                 -6.D0*THSW*THSH*(G(32)-(0.D0,1.D0)*G(600))
     $                  *CONJG(G(290))*GTQSFTDD(I,J)
     $                 +CSFMUL(THSQ,DUM1D1,TRID,I,J)
     $                 +(3.D0*TLUDLU+3.D0*TLDDLD+TLEDLE)*TRID(I,J)
     $                 +1.D0/2.D0*(THSB*MCGTPHDSQ+3.D0*THSW*MCGTHDSQ
     $                  +THSB*MSGTPHUSQ+3.D0*MSGTHUSQ)*THSH*TRID(I,J)
     $                 +CSFMUL(THSD,TRID,DUM1D2,I,J)
     $                 -(7.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2
     $                  +8.D0*G(3)**2)*TRID(I,J)
!
            B1TRIE(I,J)=2.D0*(G(541)**2/4.D0-3.D0*G(542)**2/4.D0)
     $                  *SLIDTRIE(I,J)
     $                 +4.D0*SLCFEERCFEERDTRIE(I,J)
     $                 -G(457)**2*SESLIDTRIEID(I,J)
     $                 +2.D0*FEHD(I,J)*SETSLFEHDDTRIE
     $                 +6.D0*FEHD(I,J)*SDTSQFDHDDTRID
     $                 -G(541)**2*SETRIEID(I,J)
     $                 +2.D0*SETRIECFELDCFEL(I,J)
     $                 +2.D0*THSB*THSH*CONJG(G(108))*G(287)
     $                  *(2.D0*FTELGTPES(I,J)-GTPLSFTEE(I,J))
     $                 +6.D0*THSH*THSW*CONJG(G(108))*G(289)
     $                  *GTLSFTEE(I,J)
     $                 +2.D0*THSB*(G(31)-(0.D0,1.D0)*G(599))
     $                  *(THSH*CONJG(G(288))*GTPLSFTEE(I,J)
     $                  -2.D0*GTPLSLEGTPES(I,J)
     $                  -2.D0*THSH*FTELGTPES(I,J)*CONJG(G(288)))
     $                 -6.D0*THSW*THSH*(G(32)-(0.D0,1.D0)*G(600))
     $                  *CONJG(G(290))*GTLSFTEE(I,J)
     $                 +CSFMUL(THSL,DUM1E1,TRIE,I,J)
     $                 +(3.D0*TLUDLU+3.D0*TLDDLD+TLEDLE)*TRIE(I,J)
     $                 +1.D0/2.D0*(THSB*MCGTPHDSQ+3.D0*THSW*MCGTHDSQ
     $                  +THSB*MSGTPHUSQ+3.D0*MSGTHUSQ)*THSH*TRIE(I,J)
     $                 +CSFMUL(THSE,TRIE,DUM1E2,I,J)
     $                 -(27.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2)
     $                  *TRIE(I,J)
          END DO
        END DO
!
!Convert into form readable by RKSTP (converting 2-lp to BT notation...)
!
        DO I=1,3
          DO J=1,3
            F(399+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*B1TRIU(I,J)
     $                       +1.D0/(16.D0*PI**2)**2*(-SINB
     $                       *B2HMU(J,I)-COSB*(CONJG(G(398))
     $                       *B2YMU(J,I)+YU(J,I)*CONJG(B2GRKMUM))))
     $                       *THSU(J)
            F(408+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*B1TRID(I,J)
     $                       +1.D0/(16.D0*PI**2)**2*(-COSB
     $                       *B2HMD(J,I)-SINB*(CONJG(G(398))
     $                       *B2YMD(J,I)+YD(J,I)*CONJG(B2GRKMUM))))
     $                       *THSD(J)
            F(417+(I-1)*3+J)=THSL(I)*(1.D0/16.D0/PI**2*B1TRIE(I,J)
     $                       +1.D0/(16.D0*PI**2)**2*(-COSB
     $                       *B2HME(J,I)-SINB*(CONJG(G(398))
     $                       *B2YME(J,I)+YE(J,I)*CONJG(B2GRKMUM))))
     $                       *THSE(J)
          END DO
        END DO
      END IF
!
!Now for the (mass)^2 parameters. DUMSP are dummy matrices for the
!calculation of S'
!
      DO I=1,3
        DO J=1,3
          SUIDMU(I,J)=CSFMUL(THSU,ID,MUP,I,J)
          SQIDMQ(I,J)=CSFMUL(THSQ,ID,MQ,I,J)
          SDIDMD(I,J)=CSFMUL(THSD,ID,MD,I,J)
          SLIDML(I,J)=CSFMUL(THSL,ID,ML,I,J)
          SEIDME(I,J)=CSFMUL(THSE,ID,ME,I,J)
          SUFUHUSMU(I,J)=CSFMUL(THSU,FUHUS,MUP,I,J)
          SDFDHDSMD(I,J)=CSFMUL(THSD,FDHDS,MD,I,J)
          SQFUHUTMQ(I,J)=CSFMUL(THSQ,FUHUT,MQ,I,J)
          SQFDHDTMQ(I,J)=CSFMUL(THSQ,FDHDT,MQ,I,J)
          SEFEHDSME(I,J)=CSFMUL(THSE,FEHDS,ME,I,J)
          SLFEHDTML(I,J)=CSFMUL(THSL,FEHDT,ML,I,J)
        END DO
      END DO
      DO I=1,3
        DO J=1,3
          SQSQIDMQID(I,J)=CSFMUL(THSQ,SQIDMQ,ID,I,J)
          SUSUFUHUSMUFUHUT(I,J)=CSFMUL(THSU,SUFUHUSMU,FUHUT,I,J)
          SDSDFDHDSMDFDHDT(I,J)=CSFMUL(THSD,SDFDHDSMD,FDHDT,I,J)
          SUAUSAUT(I,J)=CSFMUL(THSU,AUS,AUT,I,J)
          DUM1Q1(I,J)=1.D0/18.D0*THSB*GTPQGTPQD(I,J)
     $               +3.D0/2.D0*THSW*GTQGTQD(I,J)
     $               +8.D0/3.D0*THGL*GTSQGTSQD(I,J)
     $               +THSH*FTUQSFTUQT(I,J)
     $               +THSH*FTDQSFTDQT(I,J)
!
          SUSUIDMUID(I,J)=CSFMUL(THSU,SUIDMU,ID,I,J)
          SQSQFUHUTMQFUHUS(I,J)=CSFMUL(THSQ,SQFUHUTMQ,FUHUS,I,J)
          SQAUTAUS(I,J)=CSFMUL(THSQ,AUT,AUS,I,J)
          DUM1U1(I,J)=8.D0/9.D0*THSB*GTPUDGTPU(I,J)
     $               +8.D0/3.D0*THGL*GTSUDGTSU(I,J)
     $               +2.D0*THSH*FTUUTFTUUS(I,J)
!
          SDSDIDMDID(I,J)=CSFMUL(THSD,SDIDMD,ID,I,J)
          SQSQFDHDTMQFDHDS(I,J)=CSFMUL(THSQ,SQFDHDTMQ,FDHDS,I,J)
          SQADTADS(I,J)=CSFMUL(THSQ,ADT,ADS,I,J)
          DUM1D1(I,J)=2.D0/9.D0*THSB*GTPDDGTPD(I,J)
     $               +8.D0/3.D0*THGL*GTSDDGTSD(I,J)
     $               +2.D0*THSH*FTDDTFTDDS(I,J)
!
          SLSLIDMLID(I,J)=CSFMUL(THSL,SLIDML,ID,I,J)
          SESEFEHDSMEFEHDT(I,J)=CSFMUL(THSE,SEFEHDSME,FEHDT,I,J)
          SDADSADT(I,J)=CSFMUL(THSD,ADS,ADT,I,J)
          SEAESAET(I,J)=CSFMUL(THSE,AES,AET,I,J)
          DUM1L1(I,J)=1.D0/2.D0*THSB*GTPLGTPLD(I,J)
     $               +3.D0/2.D0*THSW*GTLGTLD(I,J)
     $               +THSH*FTELSFTELT(I,J)
!
          SESEIDMEID(I,J)=CSFMUL(THSE,SEIDME,ID,I,J)
          SLSLFEHDTMLFEHDS(I,J)=CSFMUL(THSL,SLFEHDTML,FEHDS,I,J)
          SLAETAES(I,J)=CSFMUL(THSL,AET,AES,I,J)
          DUM1E1(I,J)=2.D0*THSB*GTPEDGTPE(I,J)
     $               +2.D0*THSH*FTEETFTEES(I,J)
        END DO
      END DO
      SUTSUIDMU=TCSFMUL(THSU,SUIDMU)
      SQTSQIDMQ=TCSFMUL(THSQ,SQIDMQ)
      SDTSDIDMD=TCSFMUL(THSD,SDIDMD)
      SLTSLIDML=TCSFMUL(THSL,SLIDML)
      SETSEIDME=TCSFMUL(THSE,SEIDME)
      SQTMQ=TCSFMUL(THSQ,MQ)
      SUTMU=TCSFMUL(THSU,MUP)
      SDTMD=TCSFMUL(THSD,MD)
      SLTML=TCSFMUL(THSL,ML)
      SETME=TCSFMUL(THSE,ME)
!
      IF(THHH.EQ.1)THEN
        DO I=1,3
          DO J=1,3
            SUFUQTFUQSMU(I,J)=CSFMUL(THSU,FUQTFUQS,MUP,I,J)
            SQFUURSFUURTMQ(I,J)=CSFMUL(THSQ,FUURSFUURT,MQ,I,J)
            SDMTSFDSMTSFDT(I,J)=CSFMUL(THSD,MTSFDS,MTSFDT,I,J)
            SEMTSFESMTSFET(I,J)=CSFMUL(THSE,MTSFES,MTSFET,I,J)
!
            SQFDDRSFDDRTMQ(I,J)=CSFMUL(THSQ,FDDRSFDDRT,MQ,I,J)
            SDFDQTFDQSMD(I,J)=CSFMUL(THSD,FDQTFDQS,MD,I,J)
            SLFEERSFEERTML(I,J)=CSFMUL(THSL,FEERSFEERT,ML,I,J)
            SEFELTFELSME(I,J)=CSFMUL(THSE,FELTFELS,ME,I,J)
            SUMTSFUSMTSFUT(I,J)=CSFMUL(THSU,MTSFUS,MTSFUT,I,J)
          END DO
        END DO
        SUTSUFUQTFUQSMU=TCSFMUL(THSU,SUFUQTFUQSMU)
        SQTSQFUURSFUURTMQ=TCSFMUL(THSQ,SQFUURSFUURTMQ)
        SQTSUAUSAUT=TCSFMUL(THSQ,SUAUSAUT)
        SQTSDMTSFDSMTSFDT=TCSFMUL(THSQ,SDMTSFDSMTSFDT)
        SLTSEMTSFESMTSFET=TCSFMUL(THSL,SEMTSFESMTSFET)
!
        SQTSQFDDRSFDDRTMQ=TCSFMUL(THSQ,SQFDDRSFDDRTMQ)
        SDTSDFDQTFDQSMD=TCSFMUL(THSD,SDFDQTFDQSMD)
        SLTSLFEERSFEERTML=TCSFMUL(THSL,SLFEERSFEERTML)
        SETSEFELTFELSME=TCSFMUL(THSE,SEFELTFELSME)
        SQTSUMTSFUSMTSFUT=TCSFMUL(THSQ,SUMTSFUSMTSFUT)
        SQTSDADSADT=TCSFMUL(THSQ,SDADSADT)
        SLTSEAESAET=TCSFMUL(THSL,SEAESAET)
!
        BMHUPMT=3.D0/2.D0*(G(457)**2+G(458)**2)*G(61)
     $         -G(457)**2*G(62)
     $         -2.D0*G(457)**2*SUTSUIDMU
     $         +6.D0*SUTSUFUQTFUQSMU
     $         +G(457)**2*SQTSQIDMQ
     $         +6.D0*SQTSQFUURSFUURTMQ
     $         +G(457)**2*SDTSDIDMD
     $         -G(457)**2*SLTSLIDML
     $         +G(457)**2*SETSEIDME
     $         +6.D0*SQTSUAUSAUT
     $         +6.D0*SQTSDMTSFDSMTSFDT
     $         +2.D0*SLTSEMTSFESMTSFET
     $         -2.D0*THSH*MMUSQ*(THSB*MGTPHUSQ+3.D0*THSW*MGTHUSQ)
     $         -2.D0*THSH*(THSB*M1PM1PSQ*MGTPHUSQ+3.D0*THSW
     $          *M2PM2PSQ*MGTHUSQ)
     $         -(9.D0*G(1)**2/10.D0+9.D0*G(2)**2/2.D0)*G(61)
     $         +(6.D0*TFUDFU+THSB*THSH*MGTPHUSQ+3.D0*THSW*THSH
     $          *MGTHUSQ)*G(61)
!
        BMHDPMT=-G(457)**2*G(61)
     $         +3.D0/2.D0*(G(457)**2+G(458)**2)*G(62)
     $         +2.D0*G(457)**2*SUTSUIDMU
     $         -G(457)**2*SQTSQIDMQ
     $         +6.D0*SQTSQFDDRSFDDRTMQ
     $         -G(457)**2*SDTSDIDMD
     $         +6.D0*SDTSDFDQTFDQSMD
     $         +G(457)**2*SLTSLIDML
     $         +2.D0*SLTSLFEERSFEERTML
     $         -G(457)**2*SETSEIDME
     $         +2.D0*SETSEFELTFELSME
     $         +6.D0*SQTSUMTSFUSMTSFUT
     $         +6.D0*SQTSDADSADT
     $         +2.D0*SLTSEAESAET
     $         -2.D0*THSH*MMUSQ*(THSB*MGTPHDSQ+3.D0*THSW*MGTHDSQ)
     $         -2.D0*THSH*(THSB*M1PM1PSQ*MGTPHDSQ+3.D0*THSW
     $          *M2PM2PSQ*MGTHDSQ)
     $         -(9.D0*G(1)**2/10.D0+9.D0*G(2)**2/2.D0)*G(62)
     $         +(6.D0*TFDDFD+2.D0*TFEDFE+THSB*THSH*MGTPHDSQ
     $          +3.D0*THSW*THSH*MGTHDSQ)*G(62)
!
        F(61)=1.D0/16.D0/PI**2*BMHUPMT+1.D0/(16.D0*PI**2)**2
     $       *(B2HUM+CONJG(G(398))*B2GRKMUM+G(398)*CONJG(B2GRKMUM))
        F(62)=1.D0/16.D0/PI**2*BMHDPMT+1.D0/(16.D0*PI**2)**2
     $       *(B2HDM+CONJG(G(398))*B2GRKMUM+G(398)*CONJG(B2GRKMUM))
!
!Now the soft mass matrices
!
        DO I=1,3
          DO J=1,3
            SQMTSFUTMTSFUS(I,J)=CSFMUL(THSQ,MTSFUT,MTSFUS,I,J)
            SQMTSFDTMTSFDS(I,J)=CSFMUL(THSQ,MTSFDT,MTSFDS,I,J)
            SLMTSFETMTSFES(I,J)=CSFMUL(THSL,MTSFET,MTSFES,I,J)
          END DO
        END DO
!
        DO I=1,3
          DO J=1,3
            BETA1MQ(I,J)=(1.D0/3.D0*G(457)**2*ID(I,J)+2.D0
     $                   *FUURSFUURT(I,J))*G(61)
     $                  +(-1.D0/3.D0*G(457)**2*ID(I,J)+2.D0
     $                   *FDDRSFDDRT(I,J))*G(62)
     $                  -2.D0/3.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +1.D0/3.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  +(G(457)**2/18.D0+3.D0*G(458)**2/2.D0
     $                   +8.D0*G(459)**2/3.D0)*SQSQIDMQID(I,J)
     $                  +1.D0/3.D0*G(457)**2*ID(I,J)*SDTMD
     $                  -1.D0/3.D0*G(457)**2*ID(I,J)*SLTML
     $                  +1.D0/3.D0*G(457)**2*ID(I,J)*SETME
     $                  +2.D0*SUSUFUHUSMUFUHUT(I,J)
     $                  +2.D0*SDSDFDHDSMDFDHDT(I,J)
     $                  +2.D0*SUAUSAUT(I,J)
     $                  +2.D0*SUMTSFUSMTSFUT(I,J)
     $                  +2.D0*SDADSADT(I,J)
     $                  +2.D0*SDMTSFDSMTSFDT(I,J)
     $                  -2.D0/9.D0*THSB*M1PM1PSQ*GTPQGTPQD(I,J)
     $                  -6.D0*THSW*M2PM2PSQ*GTQGTQD(I,J)
     $                  -32.D0/3.D0*THGL*M3PM3PSQ*GTSQGTSQD(I,J)
     $                  -4.D0*THSH*MMUSQ*(FTUQSFTUQT(I,J)
     $                   +FTDQSFTDQT(I,J))
     $                  -(G(1)**2/10.D0+9.D0/2.D0*G(2)**2
     $                   +8.D0*G(3)**2)*MQ(I,J)
     $                  +CSFMUL(THSQ,DUM1Q1,MQ,I,J)
     $                  +CSFMUL(THSQ,MQ,DUM1Q1,I,J)
!
            BETA1MU(I,J)=(-4.D0/3.D0*G(457)**2*ID(I,J)+4.D0
     $                   *FUQTFUQS(I,J))*G(61)
     $                  +4.D0/3.D0*G(457)**2*ID(I,J)*G(62)
     $                  +8.D0/3.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +8.D0/3.D0*(G(457)**2/3.D0+G(459)**2)
     $                   *SUSUIDMUID(I,J)
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SDTMD
     $                  +4.D0/3.D0*G(457)**2*ID(I,J)*SLTML
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SETME
     $                  +4.D0*SQSQFUHUTMQFUHUS(I,J)
     $                  +4.D0*SQAUTAUS(I,J)
     $                  +4.D0*SQMTSFUTMTSFUS(I,J)
     $                  -32.D0/9.D0*THSB*M1PM1PSQ*GTPUDGTPU(I,J)
     $                  -32.D0/3.D0*THGL*M3PM3PSQ*GTSUDGTSU(I,J)
     $                  -8.D0*THSH*MMUSQ*FTUUTFTUUS(I,J)
     $                  -(8.D0*G(1)**2/5.D0+8.D0*G(3)**2)*MUP(I,J)
     $                  +CSFMUL(THSU,DUM1U1,MUP,I,J)
     $                  +CSFMUL(THSU,MUP,DUM1U1,I,J)
!
            BETA1MD(I,J)=2.D0/3.D0*G(457)**2*ID(I,J)*G(61)
     $                  +(-2.D0/3.D0*G(457)**2*ID(I,J)+4.D0
     $                   *FDQTFDQS(I,J))*G(62)
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +2.D0/3.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  +2.D0/3.D0*G(457)**2*ID(I,J)*SDTMD
     $                  +2.D0/3.D0*(G(457)**2/3.D0+4.D0*G(459)**2)
     $                   *SDSDIDMDID(I,J)
     $                  -2.D0/3.D0*G(457)**2*ID(I,J)*SLTML
     $                  +2.D0/3.D0*G(457)**2*ID(I,J)*SETME
     $                  +4.D0*SQSQFDHDTMQFDHDS(I,J)
     $                  +4.D0*SQADTADS(I,J)
     $                  +4.D0*SQMTSFDTMTSFDS(I,J)
     $                  -8.D0/9.D0*THSB*M1PM1PSQ*GTPDDGTPD(I,J)
     $                  -32.D0/3.D0*THGL*M3PM3PSQ*GTSDDGTSD(I,J)
     $                  -8.D0*THSH*MMUSQ*FTDDTFTDDS(I,J)
     $                  -(2.D0*G(1)**2/5.D0+8.D0*G(3)**2)*MD(I,J)
     $                  +CSFMUL(THSD,DUM1D1,MD,I,J)
     $                  +CSFMUL(THSD,MD,DUM1D1,I,J)
!
            BETA1ML(I,J)=-G(457)**2*ID(I,J)*G(61)
     $                  +(G(457)**2*ID(I,J)+2.D0*FEERSFEERT(I,J))*G(62)
     $                  +2.D0*G(457)**2*ID(I,J)*SUTMU
     $                  -G(457)**2*ID(I,J)*SQTMQ
     $                  -G(457)**2*ID(I,J)*SDTMD
     $                  +G(457)**2*ID(I,J)*SLTML
     $                  +1.D0/2.D0*(G(457)**2+3.D0*G(458)**2)
     $                   *SLSLIDMLID(I,J)
     $                  -G(457)**2*ID(I,J)*SETME
     $                  +2.D0*SESEFEHDSMEFEHDT(I,J)
     $                  +2.D0*SEAESAET(I,J)
     $                  +2.D0*SEMTSFESMTSFET(I,J)
     $                  -2.D0*THSB*M1PM1PSQ*GTPLGTPLD(I,J)
     $                  -6.D0*THGL*M2PM2PSQ*GTLGTLD(I,J)
     $                  -4.D0*THSH*MMUSQ*FTELSFTELT(I,J)
     $                  -(9.D0*G(1)**2/10.D0+9.D0*G(2)**2/2.D0)*ML(I,J)
     $                  +CSFMUL(THSL,DUM1L1,ML,I,J)
     $                  +CSFMUL(THSL,ML,DUM1L1,I,J)
!
            BETA1ME(I,J)=2.D0*G(457)**2*ID(I,J)*G(61)
     $                  +(-2.D0*G(457)**2*ID(I,J)+4.D0*FELTFELS(I,J))
     $                   *G(62)
     $                  -4.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +2.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  +2.D0*G(457)**2*ID(I,J)*SDTMD
     $                  -2.D0*G(457)**2*ID(I,J)*SLTML
     $                  +2.D0*G(457)**2*ID(I,J)*SETME
     $                  +2.D0*G(457)**2*SESEIDMEID(I,J)
     $                  +4.D0*SLSLFEHDTMLFEHDS(I,J)
     $                  +4.D0*SLAETAES(I,J)
     $                  +4.D0*SLMTSFETMTSFES(I,J)
     $                  -8.D0*THSB*M1PM1PSQ*GTPEDGTPE(I,J)
     $                  -8.D0*THSH*MMUSQ*FTEETFTEES(I,J)
     $                  -18.D0*G(1)**2/5.D0*ME(I,J)
     $                  +CSFMUL(THSE,DUM1E1,ME,I,J)
     $                  +CSFMUL(THSE,ME,DUM1E1,I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            F(62+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1MQ(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MQM(I,J)
            F(71+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1ML(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MLM(I,J)
            F(80+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1MU(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MUM(I,J)
            F(89+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1MD(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MDM(I,J)
            F(98+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1ME(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MEM(I,J)
          END DO
        END DO
      ELSE
        DO I=1,3
          DO J=1,3
            SUSFUQTSFUQSMU(I,J)=CSFMUL(THSU,SFUQTSFUQS,MUP,I,J)
            SQSFUURSSFUURTMQ(I,J)=CSFMUL(THSQ,SFUURSSFUURT,MQ,I,J)
            SQCFDDRSCFDDRTMQ(I,J)=CSFMUL(THSQ,CFDDRSCFDDRT,MQ,I,J)
            SDCFDQTCFDQSMD(I,J)=CSFMUL(THSD,CFDQTCFDQS,MD,I,J)
            SLCFEERSCFEERTML(I,J)=CSFMUL(THSL,CFEERSCFEERT,ML,I,J)
            SECFELTCFELSME(I,J)=CSFMUL(THSE,CFELTCFELS,ME,I,J)
            SUTRIUTRIUD(I,J)=CSFMUL(THSU,TRIU,TRIUD,I,J)
            SDTRIDTRIDD(I,J)=CSFMUL(THSD,TRID,TRIDD,I,J)
            SETRIETRIED(I,J)=CSFMUL(THSE,TRIE,TRIED,I,J)
          END DO
        END DO
        SUTSUSFUQTSFUQSMU=TCSFMUL(THSU,SUSFUQTSFUQSMU)
        SQTSQSFUURSSFUURTMQ=TCSFMUL(THSQ,SQSFUURSSFUURTMQ)
        SQTSQCFDDRSCFDDRTMQ=TCSFMUL(THSQ,SQCFDDRSCFDDRTMQ)
        SDTSDCFDQTCFDQSMD=TCSFMUL(THSD,SDCFDQTCFDQSMD)
        SLTSLCFEERSCFEERTML=TCSFMUL(THSL,SLCFEERSCFEERTML)
        SETSECFELTCFELSME=TCSFMUL(THSE,SECFELTCFELSME)
        SQTSUTRIUTRIUD=TCSFMUL(THSQ,SUTRIUTRIUD)
        SQTSDTRIDTRIDD=TCSFMUL(THSQ,SDTRIDTRIDD)
        SLTSETRIETRIED=TCSFMUL(THSL,SETRIETRIED)
!      
        BMHUD=3.D0/2.D0*(G(543)**2+G(544)**2)*G(427)
     $       +2.D0*G(541)**2*SUTSUIDMU
     $       +6.D0*SUTSUSFUQTSFUQSMU
     $       -G(541)**2*SQTSQIDMQ
     $       +6.D0*SQTSQSFUURSSFUURTMQ
     $       +6.D0*SQTSQCFDDRSCFDDRTMQ
     $       -G(541)**2*SDTSDIDMD
     $       +6.D0*SDTSDCFDQTCFDQSMD
     $       +G(541)**2*SLTSLIDML
     $       +2.D0*SLTSLCFEERSCFEERTML
     $       -G(541)**2*SETSEIDME
     $       +2.D0*SETSECFELTCFELSME
     $       +6.D0*SQTSUTRIUTRIUD+6.D0*SQTSDTRIDTRIDD
     $        +2.D0*SLTSETRIETRIED
     $       -2.D0*THSH*MMUSQ*(THSB*(MSGTPHUSQ+MCGTPHDSQ)
     $        +3.D0*THSW*(MSGTHUSQ+MCGTHDSQ))
     $       -2.D0*THSH*(THSB*M1PM1PSQ*(MSGTPHUSQ+MCGTPHDSQ)
     $        +3.D0*THSW*M2PM2PSQ*(MSGTHUSQ+MCGTHDSQ))
     $       -1.D0/2.D0*(-4.D0*THSH*THSB*CONJG(G(108))*G(287)*G(288)
     $        *(G(31)+(0.D0,1.D0)*G(599))-12.D0*THSH*THSW*CONJG(G(108))
     $        *G(289)*G(290)*(G(32)+(0.D0,1.D0)*G(600)))
     $       -1.D0/2.D0*(-4.D0*THSH*THSB*G(108)*CONJG(G(287))
     $        *CONJG(G(288))*(G(31)-(0.D0,1.D0)*G(599))-12.D0*THSH*THSW
     $        *G(108)*CONJG(G(289))*CONJG(G(290))*(G(32)-(0.D0,1.D0)
     $        *G(600)))
     $       -(9.D0*G(1)**2/10.D0+9.D0*G(2)**2/2.D0)*G(427)
     $       +(6.D0*TLUDLU+THSB*THSH*MSGTPHUSQ+3.D0*THSW*THSH*MSGTHUSQ
     $        +6.D0*TLDDLD+2.D0*TLEDLE+THSB*THSH*MCGTPHDSQ
     $        +3.D0*THSW*THSH*MCGTHDSQ)*G(427)
!
        F(427)=1.D0/16.D0/PI**2*BMHUD+1.D0/(16.D0*PI**2)**2
     $        *(SINB**2*B2HUM+COSB**2*B2HDM+CONJG(G(398))*B2GRKMUM
     $         +G(398)*CONJG(B2GRKMUM)+SINB*COSB*(BETA2B+CONJG(BETA2B)))
!
!Now the soft mass matrices
!
        DO I=1,3
          DO J=1,3
            SUTRIUSTRIUT(I,J)=CSFMUL(THSU,TRIUS,TRIUT,I,J)
            SDTRIDSTRIDT(I,J)=CSFMUL(THSD,TRIDS,TRIDT,I,J)
            SQTRIUTTRIUS(I,J)=CSFMUL(THSQ,TRIUT,TRIUS,I,J)
            SQTRIDTTRIDS(I,J)=CSFMUL(THSQ,TRIDT,TRIDS,I,J)
            SETRIESTRIET(I,J)=CSFMUL(THSE,TRIES,TRIET,I,J)
            SLTRIETTRIES(I,J)=CSFMUL(THSL,TRIET,TRIES,I,J)
          END DO
        END DO
!
        DO I=1,3
          DO J=1,3
            BETA1MQ(I,J)=(-1.D0/3.D0*G(541)**2*ID(I,J)+2.D0
     $                   *SFUURSSFUURT(I,J)+2.D0
     $                   *CFDDRSCFDDRT(I,J))*G(427)
     $                  -2.D0/3.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +1.D0/3.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  +(G(457)**2/18.D0+3.D0*G(458)**2/2.D0
     $                   +8.D0*G(459)**2/3.D0)*SQSQIDMQID(I,J)
     $                  +1.D0/3.D0*G(457)**2*ID(I,J)*SDTMD
     $                  -1.D0/3.D0*G(457)**2*ID(I,J)*SLTML
     $                  +1.D0/3.D0*G(457)**2*ID(I,J)*SETME
     $                  +2.D0*SUSUFUHUSMUFUHUT(I,J)
     $                  +2.D0*SDSDFDHDSMDFDHDT(I,J)
     $                  +2.D0*SUTRIUSTRIUT(I,J)
     $                  +2.D0*SDTRIDSTRIDT(I,J)
     $                  -2.D0/9.D0*THSB*M1PM1PSQ*GTPQGTPQD(I,J)
     $                  -6.D0*THSW*M2PM2PSQ*GTQGTQD(I,J)
     $                  -32.D0/3.D0*THGL*M3PM3PSQ*GTSQGTSQD(I,J)
     $                  -4.D0*THSH*MMUSQ*(FTUQSFTUQT(I,J)
     $                   +FTDQSFTDQT(I,J))
     $                  -(G(1)**2/10.D0+9.D0/2.D0*G(2)**2
     $                   +8.D0*G(3)**2)*MQ(I,J)
     $                  +CSFMUL(THSQ,DUM1Q1,MQ,I,J)
     $                  +CSFMUL(THSQ,MQ,DUM1Q1,I,J)
!
            BETA1MU(I,J)=(4.D0/3.D0*G(541)**2*ID(I,J)+4.D0
     $                   *SFUQTSFUQS(I,J))*G(427)
     $                  +8.D0/3.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +8.D0/3.D0*(G(457)**2/3.D0+G(459)**2)
     $                   *SUSUIDMUID(I,J)
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SDTMD
     $                  +4.D0/3.D0*G(457)**2*ID(I,J)*SLTML
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SETME
     $                  +4.D0*SQSQFUHUTMQFUHUS(I,J)
     $                  +4.D0*SQTRIUTTRIUS(I,J)
     $                  -32.D0/9.D0*THSB*M1PM1PSQ*GTPUDGTPU(I,J)
     $                  -32.D0/3.D0*THGL*M3PM3PSQ*GTSUDGTSU(I,J)
     $                  -8.D0*THSH*MMUSQ*FTUUTFTUUS(I,J)
     $                  -(8.D0*G(1)**2/5.D0+8.D0*G(3)**2)*MUP(I,J)
     $                  +CSFMUL(THSU,DUM1U1,MUP,I,J)
     $                  +CSFMUL(THSU,MUP,DUM1U1,I,J)
!
            BETA1MD(I,J)=(-2.D0/3.D0*G(541)**2*ID(I,J)+4.D0
     $                   *CFDQTCFDQS(I,J))*G(427)
     $                  -4.D0/3.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +2.D0/3.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  +2.D0/3.D0*G(457)**2*ID(I,J)*SDTMD
     $                  +2.D0/3.D0*(G(457)**2/3.D0+4.D0*G(459)**2)
     $                   *SDSDIDMDID(I,J)
     $                  -2.D0/3.D0*G(457)**2*ID(I,J)*SLTML
     $                  +2.D0/3.D0*G(457)**2*ID(I,J)*SETME
     $                  +4.D0*SQSQFDHDTMQFDHDS(I,J)
     $                  +4.D0*SQTRIDTTRIDS(I,J)
     $                  -8.D0/9.D0*THSB*M1PM1PSQ*GTPDDGTPD(I,J)
     $                  -32.D0/3.D0*THGL*M3PM3PSQ*GTSDDGTSD(I,J)
     $                  -8.D0*THSH*MMUSQ*FTDDTFTDDS(I,J)
     $                  -(2.D0*G(1)**2/5.D0+8.D0*G(3)**2)*MD(I,J)
     $                  +CSFMUL(THSD,DUM1D1,MD,I,J)
     $                  +CSFMUL(THSD,MD,DUM1D1,I,J)
!
            BETA1ML(I,J)=(G(541)**2*ID(I,J)+2.D0*CFEERSCFEERT(I,J))
     $                   *G(427)
     $                  +2.D0*G(457)**2*ID(I,J)*SUTMU
     $                  -G(457)**2*ID(I,J)*SQTMQ
     $                  -G(457)**2*ID(I,J)*SDTMD
     $                  +G(457)**2*ID(I,J)*SLTML
     $                  +1.D0/2.D0*(G(457)**2+3.D0*G(458)**2)
     $                   *SLSLIDMLID(I,J)
     $                  -G(457)**2*ID(I,J)*SETME
     $                  +2.D0*SESEFEHDSMEFEHDT(I,J)
     $                  +2.D0*SETRIESTRIET(I,J)
     $                  -2.D0*THSB*M1PM1PSQ*GTPLGTPLD(I,J)
     $                  -6.D0*THGL*M2PM2PSQ*GTLGTLD(I,J)
     $                  -4.D0*THSH*MMUSQ*FTELSFTELT(I,J)
     $                  -(9.D0*G(1)**2/10.D0+9.D0*G(2)**2/2.D0)*ML(I,J)
     $                  +CSFMUL(THSL,DUM1L1,ML,I,J)
     $                  +CSFMUL(THSL,ML,DUM1L1,I,J)
!
            BETA1ME(I,J)=(-2.D0*G(541)**2*ID(I,J)
     $                   +4.D0*CFELTCFELS(I,J))*G(427)
     $                  -4.D0*G(457)**2*ID(I,J)*SUTMU
     $                  +2.D0*G(457)**2*ID(I,J)*SQTMQ
     $                  +2.D0*G(457)**2*ID(I,J)*SDTMD
     $                  -2.D0*G(457)**2*ID(I,J)*SLTML
     $                  +2.D0*G(457)**2*ID(I,J)*SETME
     $                  +2.D0*G(457)**2*SESEIDMEID(I,J)
     $                  +4.D0*SLSLFEHDTMLFEHDS(I,J)
     $                  +4.D0*SLTRIETTRIES(I,J)
     $                  -8.D0*THSB*M1PM1PSQ*GTPEDGTPE(I,J)
     $                  -8.D0*THSH*MMUSQ*FTEETFTEES(I,J)
     $                  -18.D0*G(1)**2/5.D0*ME(I,J)
     $                  +CSFMUL(THSE,DUM1E1,ME,I,J)
     $                  +CSFMUL(THSE,ME,DUM1E1,I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            F(62+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1MQ(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MQM(I,J)
            F(71+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1ML(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MLM(I,J)
            F(80+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1MU(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MUM(I,J)
            F(89+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1MD(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MDM(I,J)
            F(98+(I-1)*3+J)=1.D0/16.D0/PI**2*BETA1ME(I,J)
     $                      +1.D0/(16.D0*PI**2)**2*B2MEM(I,J)
          END DO
        END DO
      END IF
!
      IF(THHH.EQ.0)THEN
!
!Finally we have the running of the Higgs Quartic Coupling and SM VEV.
!Programmed here is the MS-bar running. It therefore needs the MS-bar
!gauge and Yukawas.
!The gauge couplings and Yukawas needed to be converted to MS-bar using
!the Martin and Vaughn conversion in hep-ph/9308222.
!The following is after the conversion, so all Yukawas and Gauge
!couplings are still in the DR-bar scheme.
!
        BETALAM1=12*G(429)**2-(9.D0/5.D0*G(1)**2+9.D0*G(2)**2)
     $           *G(429)+9.D0/4.D0*(3.D0/25.D0*G(1)**4+2.D0/5.D0
     $           *G(1)**2*G(2)**2+G(2)**4)+4.D0*Y2*G(429)-4*H
        IF(SW2LP.EQ.1)THEN
          BETALAM2=-78.D0*G(429)**3+18.D0*(3.D0/5.D0*G(1)**2
     $            +3.D0*G(2)**2)*G(429)**2-((265.D0/8.D0-10*NG)
     $            *G(2)**4-117.D0/20.D0*G(1)**2*G(2)**2
     $            -9.D0/25.D0*(229.D0/24.D0+50.D0/9.D0*NG)*G(1)**4)
     $            *G(429)+(473.D0/8.D0-8.D0*NG)*G(2)**6-3.D0/5.D0
     $            *(121.D0/24.D0+8.D0/3.D0*NG)*G(1)**2*G(2)**4
     $            -9.D0/25.D0*(239.D0/24.D0+40.D0/9.D0*NG)
     $            *G(1)**4*G(2)**2-27.D0/125.D0*(59.D0/24.D0
     $            +40.D0/9.D0*NG)*G(1)**6+(-14.D0/5.D0*G(1)**2
     $            +18.D0*G(2)**2-128.D0*G(3)**2)*TLYUDLYU2
     $            +(34.D0/5.D0*G(1)**2+18.D0*G(2)**2-128.D0
     $            *G(3)**2)*TLYDDLYD2+(-42.D0/5.D0*G(1)**2
     $            +6.D0*G(2)**2)*TLYEDLYE2-3.D0/2.D0*G(2)**4
     $            *Y2+G(429)*((83.D0/10.D0*G(1)**2+27.D0/2.D0
     $            *G(2)**2+112.D0*G(3)**2)*TLYUDLYU+(-1.D0/10.D0
     $            *G(1)**2+27.D0/2.D0*G(2)**2+112.D0*G(3)**2)
     $            *TLYDDLYD+(93.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2)
     $            *TLYEDLYE)+3.D0/5.D0*G(1)**2*((-57.D0/10.D0
     $            *G(1)**2+21.D0*G(2)**2)*TLYUDLYU+(3.D0/2.D0
     $            *G(1)**2+9.D0*G(2)**2)*TLYDDLYD+(-15.D0/2.D0
     $            *G(1)**2+11.D0*G(2)**2)*TLYEDLYE)-24.D0
     $            *G(429)**2*Y2-G(429)*H+6.D0*G(429)
     $            *TLYUDLYULYDDLYD+20.D0*(3.D0*TLYUDLYU3+3.D0*TLYDDLYD3
     $            +TLYEDLYE3)-12.D0*TDUMLUD
        END IF
!
        F(429)=1.D0/(16.D0*PI**2)*BETALAM1+1.D0/(16.D0*PI**2)**2
     $         *BETALAM2
!
!Calculate the betas for the standard model vev.
!As with lambda this is the MS-bar running with DR-bar inputs except
!v and lambda
!
      BETAVEV1=9.D0/4.D0*(1.D0/5.D0*G(1)**2+G(2)**2)-Y2
      IF(SW2LP.EQ.1)THEN
        BETAVEV2=-3.D0/2.D0*G(429)**2-(83.D0/40.D0*G(1)**2+27.D0/8.D0
     $           *G(2)**2+28.D0*G(3)**2)*TYUDYU-(-1.D0/40.D0*G(1)**2
     $           +27.D0/8.D0*G(2)**2+28.D0*G(3)**2)*TYDDYD
     $           -(93.D0/40.D0*G(1)**2+9.D0/8.D0*G(2)**2)*TYEDYE+CHI4
     $           -27.D0/80.D0*G(1)**2*G(2)**2-(93.D0/800.D0+1.D0/2.D0
     $           *NG)*G(1)**4+(463.D0/32.D0-5.D0/2.D0*NG)*G(2)**4
      END IF
!
      F(428)=G(428)*(1.D0/(16.D0*PI**2)*BETAVEV1+1.D0/(16.D0*PI**2)**2
     $      *BETAVEV2)
!
      END IF
!
!Now the tilde terms are calculated.
!
!
      DO I=1,3
        DO J=1,3
          DUMTUQ1(I,J)=4.D0/9.D0*THSB*SUGTPUSGTPUT(I,J)
     $                 +4.D0/3.D0*THGL*SUGTSUSGTSUT(I,J)
     $                 +THSH*SQFTUQDFTUQ(I,J)
          DUMTUQ2(I,J)=SUFTUUFTUUD(I,J)+SQFTUQDFTUQ(I,J)
          IF(THHH.EQ.0)THEN
            DUMTUQ3(I,J)=-3.D0*THSW*GTQS(I,J)*G(289)
     $                   +1.D0/3.D0*THSB*GTPQS(I,J)*G(287)
          ELSE
            DUMTUQ3(I,J)=-3.D0*THSW*GTQS(I,J)*G(204)
     $                   +1.D0/3.D0*THSB*GTPQS(I,J)*G(184)
          END IF
          DUMTUQ4(I,J)=3.D0/2.D0*THSW*GTQSGTQT(I,J)
     $                 +1.D0/18.D0*THSB*GTPQSGTPQT(I,J)
     $                 +8.D0/3.D0*THGL*GTSQSGTSQT(I,J)
          DUMTUQ5(I,J)=FTUQFTUQD(I,J)+FTDQFTDQD(I,J)
!
          DUMTDQ1(I,J)=1.D0/9.D0*THSB*SDGTPDSGTPDT(I,J)
     $                 +4.D0/3.D0*THGL*SDGTSDSGTSDT(I,J)
     $                 +THSH*SQFTDQDFTDQ(I,J)
          DUMTDQ2(I,J)=3.D0*SDFTDDFTDDD(I,J)+SEFTEEFTEED(I,J)
     $                 +3.D0*SQFTDQDFTDQ(I,J)+SLFTELDFTEL(I,J)
          IF(THHH.EQ.0)THEN
            DUMTDQ3(I,J)=-3.D0*THSW*GTQS(I,J)*G(290)
     $                   -1.D0/3.D0*THSB*GTPQS(I,J)*G(288)
          ELSE
            DUMTDQ3(I,J)=-3.D0*THSW*GTQS(I,J)*G(205)
     $                   -1.D0/3.D0*THSB*GTPQS(I,J)*G(185)
          END IF
          DUMTDQ4(I,J)=3.D0/2.D0*THSW*GTQSGTQT(I,J)
     $                 +1.D0/18.D0*THSB*GTPQSGTPQT(I,J)
     $                 +8.D0/3.D0*THGL*GTSQSGTSQT(I,J)
          DUMTDQ5(I,J)=FTUQFTUQD(I,J)+FTDQFTDQD(I,J)
!
          DUMTEL1(I,J)=THSB*SEGTPESGTPET(I,J)
     $                 +THSH*SLFTELDFTEL(I,J)
          IF(THHH.EQ.0)THEN
            DUMTEL3(I,J)=-3.D0*THSW*GTLS(I,J)*G(290)
     $                   +THSB*GTPLS(I,J)*G(288)
          ELSE
            DUMTEL3(I,J)=-3.D0*THSW*GTLS(I,J)*G(205)
     $                   +THSB*GTPLS(I,J)*G(185)
          END IF
          DUMTEL4(I,J)=3.D0*THSW*GTLSGTLT(I,J)
     $                 +THSB*GTPLSGTPLT(I,J)
          DUMTEL5(I,J)=FTELFTELD(I,J)
!
          IF(THHH.EQ.0)THEN
            DUMTUU2(I,J)=LULUD(I,J)+LDLDD(I,J)
          ELSE
            DUMTUU2(I,J)=FUFUD(I,J)+FDFDD(I,J)
          END IF
          DUMTUU3(I,J)=THSH*(SUFTUUFTUUD(I,J)+SDFTDDFTDDD(I,J))
     $                 +3.D0/2.D0*THSW*SQGTQTGTQS(I,J)
     $                 +1.D0/18.D0*THSB*SQGTPQTGTPQS(I,J)
     $                 +8.D0/3.D0*THGL*SQGTSQTGTSQS(I,J)
          DUMTUU4(I,J)=8.D0/9.D0*THSB*GTPUTGTPUS(I,J)
     $                 +8.D0/3.D0*THGL*GTSUTGTSUS(I,J)
!
          DUMTDD2(I,J)=DUMTUU2(I,J)
          DUMTDD3(I,J)=DUMTUU3(I,J)
          DUMTDD4(I,J)=2.D0/9.D0*THSB*GTPDTGTPDS(I,J)
     $                 +8.D0/3.D0*THGL*GTSDTGTSDS(I,J)
!
          DUMTEE3(I,J)=THSH*SEFTEEFTEED(I,J)
     $                 +3.D0/2.D0*THSW*SLGTLTGTLS(I,J)
     $                 +1.D0/2.D0*THSB*SLGTPLTGTPLS(I,J)
        END DO
      END DO
      TDUMTUQ2=CTRACE(DUMTUQ2)
      TDUMTDQ2=CTRACE(DUMTDQ2)
      TDUMTEL2=TDUMTDQ2
      TDUMTUU1=TDUMTUQ2
      TDUMTDD1=TDUMTDQ2
      TDUMTEE1=TDUMTEL2
      DO I=1,3
        DO J=1,3
          IF(THHH.EQ.0)THEN
            BFTUQ(I,J)=FTUQLUDLU(I,J)
     $                 +CMATMUL(0,FTUQ,DUMTUQ1,I,J)
     $                 +3.D0/2.D0*THSH*FTUQ(I,J)*TDUMTUQ2
     $                 +1.D0/4.D0*THSH*FTUQ(I,J)
     $                  *(3.D0*THSW*MSGTHUSQ+THSB*MSGTPHUSQ)
     $                 +CMATMUL(0,DUMTUQ3,LU,I,J)
     $                 -4.D0/9.D0*THSB
     $                  *CMATMUL(0,GTPQS,SUFTUUGTPUT,I,J)
     $                 -16.D0/3.D0*THGL
     $                  *CMATMUL(0,GTSQS,SUFTUUGTSUT,I,J)
     $                 +CSFMUL(THSQ,DUMTUQ4,FTUQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTUQ5,FTUQ,I,J)
     $                 -FTUQ(I,J)*(5.D0/4.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTDQ(I,J)=FTDQLDDLD(I,J)
     $                 +CMATMUL(0,FTDQ,DUMTDQ1,I,J)
     $                 +1.D0/2.D0*THSH*FTDQ(I,J)*TDUMTDQ2
     $                 +1.D0/4.D0*THSH*FTDQ(I,J)
     $                  *(3.D0*THSW*MCGTHDSQ+THSB*MCGTPHDSQ)
     $                 +CMATMUL(0,DUMTDQ3,LD,I,J)
     $                 +2.D0/9.D0*THSB
     $                  *CMATMUL(0,GTPQS,SDFTDDGTPDT,I,J)
     $                 -16.D0/3.D0*THGL
     $                  *CMATMUL(0,GTSQS,SDFTDDGTSDT,I,J)
     $                 +CSFMUL(THSQ,DUMTDQ4,FTDQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTDQ5,FTDQ,I,J)
     $                 -FTDQ(I,J)*(13.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTEL(I,J)=FTELLEDLE(I,J)
     $                 +CMATMUL(0,FTEL,DUMTEL1,I,J)
     $                 +1.D0/2.D0*THSH*FTEL(I,J)*TDUMTEL2
     $                 +1.D0/4.D0*THSH*FTEL(I,J)
     $                  *(3.D0*THSW*MCGTHDSQ+THSB*MCGTPHDSQ)
     $                 +CMATMUL(0,DUMTEL3,LE,I,J)
     $                 -2.D0*THSB*CMATMUL(0,GTPLS,SEFTEEGTPET,I,J)
     $                 +1.D0/2.D0*CSFMUL(THSL,DUMTEL4,FTEL,I,J)
     $                 +THSH*CSFMUL(THSL,DUMTEL5,FTEL,I,J)
     $                 -FTEL(I,J)*(9.D0/4.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2)
!
            BFTUU(I,J)=3.D0/2.D0*THSH*FTUU(I,J)*TDUMTUU1
     $                 +1.D0/4.D0*THSH*FTUU(I,J)
     $                  *(3.D0*THSW*MSGTHUSQ+THSB*MSGTPHUSQ)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTUU2,FTUU,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTUU3,FTUU,I,J)
     $                 -4.D0/9.D0*THSB*CMATMUL(0,SQGTPQTFTUQ,GTPUS,I,J)
     $                 -16.D0/3.D0*THGL*CMATMUL(0,SQGTSQTFTUQ,GTSUS,I,J)
     $                 -4.D0/3.D0*THSB*G(287)*LUGTPUS(I,J)
     $                 +2.D0*THSH*CMATMUL(0,SUFTUUFTUUD,FTUU,I,J)
     $                 +CSFMUL(THSU,FTUU,DUMTUU4,I,J)
     $                 -FTUU(I,J)*(1.D0/2.D0*G(1)**2
     $                  +9.D0/2.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTDD(I,J)=1.D0/2.D0*THSH*FTDD(I,J)*TDUMTDD1
     $                 +1.D0/4.D0*THSH*FTDD(I,J)
     $                  *(3.D0*THSW*MCGTHDSQ+THSB*MCGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTDD2,FTDD,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTDD3,FTDD,I,J)
     $                 +2.D0/9.D0*THSB*CMATMUL(0,SQGTPQTFTDQ,GTPDS,I,J)
     $                 -16.D0/3.D0*THGL*CMATMUL(0,SQGTSQTFTDQ,GTSDS,I,J)
     $                 -2.D0/3.D0*THSB*G(288)*LDGTPDS(I,J)
     $                 +2.D0*THSH*CMATMUL(0,SDFTDDFTDDD,FTDD,I,J)
     $                 +CSFMUL(THSD,FTDD,DUMTDD4,I,J)
     $                 -FTDD(I,J)*(1.D0/2.D0*G(1)**2
     $                  +9.D0/2.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTEE(I,J)=1.D0/2.D0*THSH*FTEE(I,J)*TDUMTEE1
     $                 +1.D0/4.D0*THSH*FTEE(I,J)
     $                  *(3.D0*THSW*MCGTHDSQ+THSB*MCGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,LELED,FTEE,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTEE3,FTEE,I,J)
     $                 -2.D0*THSB*CMATMUL(0,SLGTPLTFTEL,GTPES,I,J)
     $                 -2.D0*THSB*G(288)*LEGTPES(I,J)
     $                 +2.D0*THSH*CMATMUL(0,SEFTEEFTEED,FTEE,I,J)
     $                 +2.D0*THSB*CMATMUL(0,SEFTEEGTPET,GTPES,I,J)
     $                 -FTEE(I,J)*(9.D0/10.D0*G(1)**2
     $                  +9.D0/2.D0*G(2)**2)
          ELSE
            BFTUQ(I,J)=FTUQFUDFU(I,J)
     $                 +CMATMUL(0,FTUQ,DUMTUQ1,I,J)
     $                 +3.D0/2.D0*THSH*FTUQ(I,J)*TDUMTUQ2
     $                 +1.D0/4.D0*THSH*FTUQ(I,J)
     $                  *(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ)
     $                 +CMATMUL(0,DUMTUQ3,FU,I,J)
     $                 -4.D0/9.D0*THSB
     $                  *CMATMUL(0,GTPQS,SUFTUUGTPUT,I,J)
     $                 -16.D0/3.D0*THGL
     $                  *CMATMUL(0,GTSQS,SUFTUUGTSUT,I,J)
     $                 +CSFMUL(THSQ,DUMTUQ4,FTUQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTUQ5,FTUQ,I,J)
     $                 -FTUQ(I,J)*(5.D0/4.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTDQ(I,J)=FTDQFDDFD(I,J)
     $                 +CMATMUL(0,FTDQ,DUMTDQ1,I,J)
     $                 +1.D0/2.D0*THSH*FTDQ(I,J)*TDUMTDQ2
     $                 +1.D0/4.D0*THSH*FTDQ(I,J)
     $                  *(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $                 +CMATMUL(0,DUMTDQ3,FD,I,J)
     $                 +2.D0/9.D0*THSB
     $                  *CMATMUL(0,GTPQS,SDFTDDGTPDT,I,J)
     $                 -16.D0/3.D0*THGL
     $                  *CMATMUL(0,GTSQS,SDFTDDGTSDT,I,J)
     $                 +CSFMUL(THSQ,DUMTDQ4,FTDQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTDQ5,FTDQ,I,J)
     $                 -FTDQ(I,J)*(13.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTEL(I,J)=FTELFEDFE(I,J)
     $                 +CMATMUL(0,FTEL,DUMTEL1,I,J)
     $                 +1.D0/2.D0*THSH*FTEL(I,J)*TDUMTEL2
     $                 +1.D0/4.D0*THSH*FTEL(I,J)
     $                  *(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $                 +CMATMUL(0,DUMTEL3,FE,I,J)
     $                 -2.D0*THSB*CMATMUL(0,GTPLS,SEFTEEGTPET,I,J)
     $                 +1.D0/2.D0*CSFMUL(THSL,DUMTEL4,FTEL,I,J)
     $                 +THSH*CSFMUL(THSL,DUMTEL5,FTEL,I,J)
     $                 -FTEL(I,J)*(9.D0/4.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2)
!
            BFTUU(I,J)=3.D0/2.D0*THSH*FTUU(I,J)*TDUMTUU1
     $                 +1.D0/4.D0*THSH*FTUU(I,J)
     $                  *(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTUU2,FTUU,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTUU3,FTUU,I,J)
     $                 -4.D0/9.D0*THSB*CMATMUL(0,SQGTPQTFTUQ,GTPUS,I,J)
     $                 -16.D0/3.D0*THGL*CMATMUL(0,SQGTSQTFTUQ,GTSUS,I,J)
     $                 -4.D0/3.D0*THSB*G(184)*FUGTPUS(I,J)
     $                 +2.D0*THSH*CMATMUL(0,SUFTUUFTUUD,FTUU,I,J)
     $                 +CSFMUL(THSU,FTUU,DUMTUU4,I,J)
     $                 -FTUU(I,J)*(1.D0/2.D0*G(1)**2
     $                  +9.D0/2.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTDD(I,J)=1.D0/2.D0*THSH*FTDD(I,J)*TDUMTDD1
     $                 +1.D0/4.D0*THSH*FTDD(I,J)
     $                  *(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTDD2,FTDD,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTDD3,FTDD,I,J)
     $                 +2.D0/9.D0*THSB*CMATMUL(0,SQGTPQTFTDQ,GTPDS,I,J)
     $                 -16.D0/3.D0*THGL*CMATMUL(0,SQGTSQTFTDQ,GTSDS,I,J)
     $                 -2.D0/3.D0*THSB*G(185)*FDGTPDS(I,J)
     $                 +2.D0*THSH*CMATMUL(0,SDFTDDFTDDD,FTDD,I,J)
     $                 +CSFMUL(THSD,FTDD,DUMTDD4,I,J)
     $                 -FTDD(I,J)*(1.D0/2.D0*G(1)**2
     $                  +9.D0/2.D0*G(2)**2+4.D0*G(3)**2)
!
            BFTEE(I,J)=1.D0/2.D0*THSH*FTEE(I,J)*TDUMTEE1
     $                 +1.D0/4.D0*THSH*FTEE(I,J)
     $                  *(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,FEFED,FTEE,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,DUMTEE3,FTEE,I,J)
     $                 -2.D0*THSB*CMATMUL(0,SLGTPLTFTEL,GTPES,I,J)
     $                 -2.D0*THSB*G(185)*FEGTPES(I,J)
     $                 +2.D0*THSH*CMATMUL(0,SEFTEEFTEED,FTEE,I,J)
     $                 +2.D0*THSB*CMATMUL(0,SEFTEEGTPET,GTPES,I,J)
     $                 -FTEE(I,J)*(9.D0/10.D0*G(1)**2
     $                  +9.D0/2.D0*G(2)**2)
          END IF
!
!Convert into form readable by RKSTP. Two loop running is based
!on MV notation RGEs so I must take the transpose
!
          F(232+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BFTUQ(I,J)
     $                     +1.D0/(16.D0*PI**2)**2*B2YMU(J,I))
          F(241+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BFTDQ(I,J)
     $                     +1.D0/(16.D0*PI**2)**2*B2YMD(J,I))
          F(250+(I-1)*3+J)=THSL(I)*(1.D0/16.D0/PI**2*BFTEL(I,J)
     $                     +1.D0/(16.D0*PI**2)**2*B2YME(J,I))
          F(259+(I-1)*3+J)=(1.D0/16.D0/PI**2*BFTUU(I,J)
     $                     +1.D0/(16.D0*PI**2)**2*B2YMU(J,I))*THSU(J)
          F(268+(I-1)*3+J)=(1.D0/16.D0/PI**2*BFTDD(I,J)
     $                     +1.D0/(16.D0*PI**2)**2*B2YMD(J,I))*THSD(J)
          F(277+(I-1)*3+J)=(1.D0/16.D0/PI**2*BFTEE(I,J)
     $                     +1.D0/(16.D0*PI**2)**2*B2YME(J,I))*THSE(J)
        END DO
      END DO
!
!That's the yukawas done, now for the gauge couplings
!
      DO I=1,3
        DO J=1,3
          DUMTQ1(I,J)=3.D0*SQGTQDGTQ(I,J)+SLGTLDGTL(I,J)
          IF(THHH.EQ.0)THEN
            DUMTQ2(I,J)=LUSLUT(I,J)+LDSLDT(I,J)
          ELSE
            DUMTQ2(I,J)=FUSFUT(I,J)+FDSFDT(I,J)
          END IF
          DUMTQ3(I,J)=THSH*(SUFTUUSFTUUT(I,J)+SDFTDDSFTDDT(I,J))
     $                +3.D0/2.D0*THSW*SQGTQDGTQ(I,J)
     $                +1.D0/18.D0*THSB*SQGTPQDGTPQ(I,J)
     $                +8.D0/3.D0*THGL*SQGTSQDGTSQ(I,J)
          DUMTQ4(I,J)=3.D0*THSW*GTQGTQD(I,J)+1.D0/9.D0*THSB
     $                 *GTPQGTPQD(I,J)+16.D0/3.D0*THGL*GTSQGTSQD(I,J) 
          DUMTQ5(I,J)=FTUQSFTUQT(I,J)+FTDQSFTDQT(I,J)
!
          DUMTL2(I,J)=THSH*SEFTEESFTEET(I,J)
     $                +3.D0/2.D0*THSW*SLGTLDGTL(I,J)
     $                +1.D0/2.D0*THSB*SLGTPLDGTPL(I,J)
          DUMTL3(I,J)=3.D0*THSW*GTLGTLD(I,J)+THSB*GTPLGTPLD(I,J)
!
          DUMTPQ1(I,J)=1.D0/3.D0*SQGTPQDGTPQ(I,J)+SLGTPLDGTPL(I,J)
     $                 +8.D0/3.D0*SUGTPUGTPUD(I,J)
     $                 +2.D0/3.D0*SDGTPDGTPDD(I,J)
     $                 +2.D0*SEGTPEGTPED(I,J)
          DUMTPQ2(I,J)=DUMTQ2(I,J)
          DUMTPQ3(I,J)=DUMTQ3(I,J)
          DUMTPQ4(I,J)=DUMTQ4(I,J)
          DUMTPQ5(I,J)=DUMTQ5(I,J)
!
          DUMTPL2(I,J)=DUMTL2(I,J)
          DUMTPL3(I,J)=DUMTL3(I,J)
!
          DUMTPU1(I,J)=4.D0/9.D0*THSB*SUGTPUGTPUD(I,J)
     $                 +4.D0/3.D0*THGL*SUGTSUGTSUD(I,J)
     $                 +THSH*SQFTUQTFTUQS(I,J)
          DUMTPU3(I,J)=8.D0/9.D0*THSB*GTPUDGTPU(I,J)
     $                 +8.D0/3.D0*THGL*GTSUDGTSU(I,J)
!
          DUMTPD1(I,J)=1.D0/9.D0*THSB*SDGTPDGTPDD(I,J)
     $                 +4.D0/3.D0*THGL*SDGTSDGTSDD(I,J)
     $                 +THSH*SQFTDQTFTDQS(I,J)
          DUMTPD3(I,J)=2.D0/9.D0*THSB*GTPDDGTPD(I,J)
     $                 +8.D0/3.D0*THGL*GTSDDGTSD(I,J)
!
          DUMTPE1(I,J)=THSB*SEGTPEGTPED(I,J)+THSH*SLFTELTFTELS(I,J)
        END DO
      END DO
      TDUMTQ1=CTRACE(DUMTQ1)
      TDUMTL1=TDUMTQ1
      TDUMTPQ1=CTRACE(DUMTPQ1)
      TDUMTPL1=TDUMTPQ1
      TDUMTPU2=TDUMTPQ1
      TDUMTPD2=TDUMTPU2
      TDUMTPE2=TDUMTPD2
      DO I=1,3
        DO J=1,3
          IF(THHH.EQ.0)THEN
            BGTQ(I,J)=1.D0/2.D0*THSW*GTQ(I,J)*TDUMTQ1
     $                +1.D0/2.D0*THSH*THSW*GTQ(I,J)
     $                 *(MSGTHUSQ+MCGTHDSQ)
     $                +1.D0/2.D0*CMATMUL(0,GTQ,DUMTQ2,I,J)
     $                +1.D0/2.D0*CMATMUL(0,GTQ,DUMTQ3,I,J)
     $                -2.D0*THSH*(G(289)*FTUQSLUT(I,J)
     $                 +G(290)*FTDQSLDT(I,J))
     $                +1.D0/2.D0*CSFMUL(THSQ,DUMTQ4,GTQ,I,J)
     $                +THSH*CSFMUL(THSQ,DUMTQ5,GTQ,I,J)
     $                -GTQ(I,J)*(1.D0/20.D0*G(1)**2
     $                 +33.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BGTL(I,J)=1.D0/2.D0*THSW*GTL(I,J)*TDUMTL1
     $                +1.D0/2.D0*THSH*THSW*GTL(I,J)
     $                 *(MSGTHUSQ+MCGTHDSQ)
     $                +1.D0/2.D0*CMATMUL(0,GTL,LESLET,I,J)
     $                +1.D0/2.D0*CMATMUL(0,GTL,DUMTL2,I,J)
     $                -2.D0*THSH*G(290)*FTELSLET(I,J)
     $                +1.D0/2.D0*CSFMUL(THSL,DUMTL3,GTL,I,J)
     $                +THSH*CSFMUL(THSL,FTELSFTELT,GTL,I,J)
     $                -GTL(I,J)*(9.D0/20.D0*G(1)**2
     $                 +33.D0/4.D0*G(2)**2)
!
            BGTPQ(I,J)=1.D0/2.D0*THSB*GTPQ(I,J)*TDUMTPQ1
     $                 +1.D0/2.D0*THSH*THSB*GTPQ(I,J)
     $                  *(MSGTPHUSQ+MCGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,GTPQ,DUMTPQ2,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTPQ,DUMTPQ3,I,J)
     $                 +4.D0*THSH*(-2.D0
     $                  *CMATMUL(0,FTUQS,SUGTPUFTUUT,I,J)
     $                  +CMATMUL(0,FTDQS,SDGTPDFTDDT,I,J))
     $                 +6.D0*THSH*(G(287)*FTUQSLUT(I,J)
     $                  -G(288)*FTDQSLDT(I,J))
     $                 +1.D0/2.D0*CSFMUL(THSQ,DUMTPQ4,GTPQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTPQ5,GTPQ,I,J)
     $                 -GTPQ(I,J)*(1.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BGTPL(I,J)=1.D0/2.D0*THSB*GTPL(I,J)*TDUMTPL1
     $                 +1.D0/2.D0*THSH*THSB*GTPL(I,J)
     $                  *(MSGTPHUSQ+MCGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,GTPL,LESLET,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTPL,DUMTPL2,I,J)
     $                 -4.D0*THSH*CMATMUL(0,FTELS,SEGTPEFTEET,I,J)
     $                 +2.D0*THSH*G(288)*FTELSLET(I,J)
     $                 +1.D0/2.D0*CSFMUL(THSL,DUMTPL3,GTPL,I,J)
     $                 +THSH*CSFMUL(THSL,FTELSFTELT,GTPL,I,J)
     $                 -GTPL(I,J)*(9.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2)
!
            BGTPU(I,J)=LUTLUSGTPU(I,J)
     $                 +CMATMUL(0,DUMTPU1,GTPU,I,J)
     $                 +1.D0/2.D0*THSB*GTPU(I,J)*TDUMTPU2
     $                 +1.D0/2.D0*THSB*THSH*GTPU(I,J)
     $                  *(MSGTPHUSQ+MCGTPHDSQ)
     $                 -3.D0*THSB*THSH*LUTFTUUS(I,J)*G(287)
     $                 -THSH*CMATMUL(0,SQFTUQTGTPQ,FTUUS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SUGTPUFTUUT,FTUUS,I,J)
     $                 +CSFMUL(THSU,GTPU,DUMTPU3,I,J)
     $                 -GTPU(I,J)*(4.D0/5.D0*G(1)**2+4.D0*G(3)**2)
!
            BGTPD(I,J)=LDTLDSGTPD(I,J)
     $                 +CMATMUL(0,DUMTPD1,GTPD,I,J)
     $                 +1.D0/2.D0*THSB*GTPD(I,J)*TDUMTPD2
     $                 +1.D0/2.D0*THSB*THSH*GTPD(I,J)
     $                  *(MSGTPHUSQ+MCGTPHDSQ)
     $                 -6.D0*THSB*THSH*LDTFTDDS(I,J)*G(288)
     $                 +2.D0*THSH*CMATMUL(0,SQFTDQTGTPQ,FTDDS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SDGTPDFTDDT,FTDDS,I,J)
     $                 +CSFMUL(THSD,GTPD,DUMTPD3,I,J)
     $                 -GTPD(I,J)*(1.D0/5.D0*G(1)**2+4.D0*G(3)**2)
!
            BGTPE(I,J)=LETLESGTPE(I,J)
     $                 +CMATMUL(0,DUMTPE1,GTPE,I,J)
     $                 +1.D0/2.D0*THSB*GTPE(I,J)*TDUMTPE2
     $                 +1.D0/2.D0*THSB*THSH*GTPE(I,J)
     $                  *(MSGTPHUSQ+MCGTPHDSQ)
     $                 -2.D0*THSB*THSH*LETFTEES(I,J)*G(288)
     $                 -2.D0*THSH*CMATMUL(0,SLFTELTGTPL,FTEES,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SEGTPEFTEET,FTEES,I,J)
     $                 +2.D0*THSB*CMATMUL(0,SEGTPEGTPED,GTPE,I,J)
     $                 -GTPE(I,J)*9.D0/5.D0*G(1)**2
          ELSE 
            BGTQ(I,J)=1.D0/2.D0*THSW*GTQ(I,J)*TDUMTQ1
     $                +1.D0/2.D0*THSH*THSW*GTQ(I,J)
     $                 *(MGTHUSQ+MGTHDSQ)
     $                +1.D0/2.D0*CMATMUL(0,GTQ,DUMTQ2,I,J)
     $                +1.D0/2.D0*CMATMUL(0,GTQ,DUMTQ3,I,J)
     $                -2.D0*THSH*(G(204)*FTUQSFUT(I,J)
     $                 +G(205)*FTDQSFDT(I,J))
     $                +1.D0/2.D0*CSFMUL(THSQ,DUMTQ4,GTQ,I,J)
     $                +THSH*CSFMUL(THSQ,DUMTQ5,GTQ,I,J)
     $                -GTQ(I,J)*(1.D0/20.D0*G(1)**2
     $                 +33.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BGTL(I,J)=1.D0/2.D0*THSW*GTL(I,J)*TDUMTL1
     $                +1.D0/2.D0*THSH*THSW*GTL(I,J)
     $                 *(MGTHUSQ+MGTHDSQ)
     $                +1.D0/2.D0*CMATMUL(0,GTL,FESFET,I,J)
     $                +1.D0/2.D0*CMATMUL(0,GTL,DUMTL2,I,J)
     $                -2.D0*THSH*G(205)*FTELSFET(I,J)
     $                +1.D0/2.D0*CSFMUL(THSL,DUMTL3,GTL,I,J)
     $                +THSH*CSFMUL(THSL,FTELSFTELT,GTL,I,J)
     $                -GTL(I,J)*(9.D0/20.D0*G(1)**2
     $                 +33.D0/4.D0*G(2)**2)
!
            BGTPQ(I,J)=1.D0/2.D0*THSB*GTPQ(I,J)*TDUMTPQ1
     $                 +1.D0/2.D0*THSH*THSB*GTPQ(I,J)
     $                  *(MGTPHUSQ+MGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,GTPQ,DUMTPQ2,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTPQ,DUMTPQ3,I,J)
     $                 +4.D0*THSH*(-2.D0
     $                  *CMATMUL(0,FTUQS,SUGTPUFTUUT,I,J)
     $                  +CMATMUL(0,FTDQS,SDGTPDFTDDT,I,J))
     $                 +6.D0*THSH*(G(184)*FTUQSFUT(I,J)
     $                  -G(185)*FTDQSFDT(I,J))
     $                 +1.D0/2.D0*CSFMUL(THSQ,DUMTPQ4,GTPQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTPQ5,GTPQ,I,J)
     $                 -GTPQ(I,J)*(1.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+4.D0*G(3)**2)
!
            BGTPL(I,J)=1.D0/2.D0*THSB*GTPL(I,J)*TDUMTPL1
     $                 +1.D0/2.D0*THSH*THSB*GTPL(I,J)
     $                  *(MGTPHUSQ+MGTPHDSQ)
     $                 +1.D0/2.D0*CMATMUL(0,GTPL,FESFET,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTPL,DUMTPL2,I,J)
     $                 -4.D0*THSH*CMATMUL(0,FTELS,SEGTPEFTEET,I,J)
     $                 +2.D0*THSH*G(185)*FTELSFET(I,J)
     $                 +1.D0/2.D0*CSFMUL(THSL,DUMTPL3,GTPL,I,J)
     $                 +THSH*CSFMUL(THSL,FTELSFTELT,GTPL,I,J)
     $                 -GTPL(I,J)*(9.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2)
!
            BGTPU(I,J)=FUTFUSGTPU(I,J)
     $                 +CMATMUL(0,DUMTPU1,GTPU,I,J)
     $                 +1.D0/2.D0*THSB*GTPU(I,J)*TDUMTPU2
     $                 +1.D0/2.D0*THSB*THSH*GTPU(I,J)
     $                  *(MGTPHUSQ+MGTPHDSQ)
     $                 -3.D0*THSB*THSH*FUTFTUUS(I,J)*G(184)
     $                 -THSH*CMATMUL(0,SQFTUQTGTPQ,FTUUS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SUGTPUFTUUT,FTUUS,I,J)
     $                 +CSFMUL(THSU,GTPU,DUMTPU3,I,J)
     $                 -GTPU(I,J)*(4.D0/5.D0*G(1)**2+4.D0*G(3)**2)
!
            BGTPD(I,J)=FDTFDSGTPD(I,J)
     $                 +CMATMUL(0,DUMTPD1,GTPD,I,J)
     $                 +1.D0/2.D0*THSB*GTPD(I,J)*TDUMTPD2
     $                 +1.D0/2.D0*THSB*THSH*GTPD(I,J)
     $                  *(MGTPHUSQ+MGTPHDSQ)
     $                 -6.D0*THSB*THSH*FDTFTDDS(I,J)*G(185)
     $                 +2.D0*THSH*CMATMUL(0,SQFTDQTGTPQ,FTDDS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SDGTPDFTDDT,FTDDS,I,J)
     $                 +CSFMUL(THSD,GTPD,DUMTPD3,I,J)
     $                 -GTPD(I,J)*(1.D0/5.D0*G(1)**2+4.D0*G(3)**2)
!
            BGTPE(I,J)=FETFESGTPE(I,J)
     $                 +CMATMUL(0,DUMTPE1,GTPE,I,J)
     $                 +1.D0/2.D0*THSB*GTPE(I,J)*TDUMTPE2
     $                 +1.D0/2.D0*THSB*THSH*GTPE(I,J)
     $                  *(MGTPHUSQ+MGTPHDSQ)
     $                 -2.D0*THSB*THSH*FETFTEES(I,J)*G(185)
     $                 -2.D0*THSH*CMATMUL(0,SLFTELTGTPL,FTEES,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SEGTPEFTEET,FTEES,I,J)
     $                 +2.D0*THSB*CMATMUL(0,SEGTPEGTPED,GTPE,I,J)
     $                 -GTPE(I,J)*9.D0/5.D0*G(1)**2
          END IF
!
!Convert into form readable by RKSTP
!
          F(185+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BGTQ(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(2)*ID(I,J))
          F(194+(I-1)*3+J)=THSL(I)*(1.D0/16.D0/PI**2*BGTL(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(2)*ID(I,J))
          F(138+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BGTPQ(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0)*ID(I,J))
          F(147+(I-1)*3+J)=THSL(I)*(1.D0/16.D0/PI**2*BGTPL(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0)*ID(I,J))
          F(156+(I-1)*3+J)=(1.D0/16.D0/PI**2*BGTPU(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0)*ID(I,J))
     $       *THSU(J)
          F(165+(I-1)*3+J)=(1.D0/16.D0/PI**2*BGTPD(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0)*ID(I,J))
     $       *THSD(J)
          F(174+(I-1)*3+J)=(1.D0/16.D0/PI**2*BGTPE(I,J)
     $       +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0)*ID(I,J))
     $       *THSE(J)
        END DO
      END DO
      DO I=1,3
        DO J=1,3
          DUMTSQ1(I,J)=2.D0*SQGTSQDGTSQ(I,J)+SUGTSUGTSUD(I,J)
     $                 +SDGTSDGTSDD(I,J)
          IF(THHH.EQ.0)THEN
            DUMTSQ2(I,J)=LUSLUT(I,J)+LDSLDT(I,J)
          ELSE
            DUMTSQ2(I,J)=FUSFUT(I,J)+FDSFDT(I,J)
          END IF
          DUMTSQ3(I,J)=DUMTQ3(I,J)
          DUMTSQ4(I,J)=DUMTQ4(I,J)
          DUMTSQ5(I,J)=DUMTQ5(I,J)
!
          DUMTSU1(I,J)=DUMTPU1(I,J)
          DUMTSU3(I,J)=SUGTSUGTSUD(I,J)+SDGTSDGTSDD(I,J)
          DUMTSU4(I,J)=DUMTPU3(I,J)
!
          DUMTSD1(I,J)=DUMTPD1(I,J)
          DUMTSD4(I,J)=DUMTPD3(I,J)
        END DO
      END DO
      TDUMTSQ1=CTRACE(DUMTSQ1)
      TDUMTSU2=CTRACE(SQGTSQDGTSQ)
      TDUMTSU3=CTRACE(DUMTSU3)
      TDUMTSD2=TDUMTSU2
      TDUMTSD3=TDUMTSU3
      DO I=1,3
        DO J=1,3
          IF(THHH.EQ.0)THEN
            BGTSQ(I,J)=1.D0/2.D0*THGL*TDUMTSQ1*GTSQ(I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTSQ,DUMTSQ2,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTSQ,DUMTSQ3,I,J)
     $                 -2.D0*THSH*(CMATMUL(0,FTUQS,SUGTSUFTUUT,I,J)
     $                  +CMATMUL(0,FTDQS,SDGTSDFTDDT,I,J))
     $                 +1.D0/2.D0*CSFMUL(THSQ,DUMTSQ4,GTSQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTSQ5,GTSQ,I,J)
     $                 -GTSQ(I,J)*(1.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+13.D0*G(3)**2)
!
            BGTSU(I,J)=LUTLUSGTSU(I,J)
     $                 +CMATMUL(0,DUMTSU1,GTSU,I,J)
     $                 +THGL*GTSU(I,J)*TDUMTSU2
     $                 +1.D0/2.D0*THGL*GTSU(I,J)*TDUMTSU3
     $                 -4.D0*THSH*CMATMUL(0,SQFTUQTGTSQ,FTUUS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SUGTSUFTUUT,FTUUS,I,J)
     $                 +CSFMUL(THSU,GTSU,DUMTSU4,I,J)
     $                 -GTSU(I,J)*(4.D0/5.D0*G(1)**2
     $                  +13.D0*G(3)**2)
!
            BGTSD(I,J)=LDTLDSGTSD(I,J)
     $                 +CMATMUL(0,DUMTSD1,GTSD,I,J)
     $                 +THGL*GTSD(I,J)*TDUMTSD2
     $                 +1.D0/2.D0*THGL*GTSD(I,J)*TDUMTSD3
     $                 -4.D0*THSH*CMATMUL(0,SQFTDQTGTSQ,FTDDS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SDGTSDFTDDT,FTDDS,I,J)
     $                 +CSFMUL(THSD,GTSD,DUMTSD4,I,J)
     $                 -GTSD(I,J)*(1.D0/5.D0*G(1)**2
     $                  +13.D0*G(3)**2)
          ELSE
            BGTSQ(I,J)=1.D0/2.D0*THGL*TDUMTSQ1*GTSQ(I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTSQ,DUMTSQ2,I,J)
     $                 +1.D0/2.D0*CMATMUL(0,GTSQ,DUMTSQ3,I,J)
     $                 -2.D0*THSH*(CMATMUL(0,FTUQS,SUGTSUFTUUT,I,J)
     $                  +CMATMUL(0,FTDQS,SDGTSDFTDDT,I,J))
     $                 +1.D0/2.D0*CSFMUL(THSQ,DUMTSQ4,GTSQ,I,J)
     $                 +THSH*CSFMUL(THSQ,DUMTSQ5,GTSQ,I,J)
     $                 -GTSQ(I,J)*(1.D0/20.D0*G(1)**2
     $                  +9.D0/4.D0*G(2)**2+13.D0*G(3)**2)
!
            BGTSU(I,J)=FUTFUSGTSU(I,J)
     $                 +CMATMUL(0,DUMTSU1,GTSU,I,J)
     $                 +THGL*GTSU(I,J)*TDUMTSU2
     $                 +1.D0/2.D0*THGL*GTSU(I,J)*TDUMTSU3
     $                 -4.D0*THSH*CMATMUL(0,SQFTUQTGTSQ,FTUUS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SUGTSUFTUUT,FTUUS,I,J)
     $                 +CSFMUL(THSU,GTSU,DUMTSU4,I,J)
     $                 -GTSU(I,J)*(4.D0/5.D0*G(1)**2
     $                  +13.D0*G(3)**2)
!
            BGTSD(I,J)=FDTFDSGTSD(I,J)
     $                 +CMATMUL(0,DUMTSD1,GTSD,I,J)
     $                 +THGL*GTSD(I,J)*TDUMTSD2
     $                 +1.D0/2.D0*THGL*GTSD(I,J)*TDUMTSD3
     $                 -4.D0*THSH*CMATMUL(0,SQFTDQTGTSQ,FTDDS,I,J)
     $                 +2.D0*THSH*CMATMUL(0,SDGTSDFTDDT,FTDDS,I,J)
     $                 +CSFMUL(THSD,GTSD,DUMTSD4,I,J)
     $                 -GTSD(I,J)*(1.D0/5.D0*G(1)**2
     $                  +13.D0*G(3)**2)

          END IF
!
!Convert into form readable by RKSTP
!
          F(205+(I-1)*3+J)=THSQ(I)*(1.D0/16.D0/PI**2*BGTSQ(I,J)
     $           +1.D0/(16.D0*PI**2)**2*B2GM(3)*ID(I,J))
          F(214+(I-1)*3+J)=(1.D0/16.D0/PI**2*BGTSU(I,J)
     $           +1.D0/(16.D0*PI**2)**2*B2GM(3)*ID(I,J))*THSU(J)
          F(223+(I-1)*3+J)=(1.D0/16.D0/PI**2*BGTSD(I,J)
     $           +1.D0/(16.D0*PI**2)**2*B2GM(3)*ID(I,J))*THSD(J)
        END DO
      END DO
!
!The Higgs tilde gauge couplings are calculated twice,
!once for below m_H when s and c are absorbed into the definition.
!Some terms are valid in both regimes and do not need to be
!calculated twice.
!
      DO I=1,3
        DO J=1,3
          DUMGTHU1(I,J)=CMATMUL(0,SQFTUQTGTQ,FUS,I,J)
          DUMGTHD1(I,J)=3.D0*CMATMUL(0,SQFTDQTGTQ,FDS,I,J)
     $                  +CMATMUL(0,SLFTELTGTL,FES,I,J)
          DUMGTPHU1(I,J)=CMATMUL(0,SQFTUQTGTPQ,FUS,I,J)
          DUMGTPHU2(I,J)=CMATMUL(0,SUGTPUFTUUT,FUS,I,J)
          DUMGTPHD1(I,J)=-CMATMUL(0,SQFTDQTGTPQ,FDS,I,J)
     $                   +CMATMUL(0,SLFTELTGTPL,FES,I,J)
          DUMGTPHD2(I,J)=CMATMUL(0,SDGTPDFTDDT,FDS,I,J)
     $                   +CMATMUL(0,SEGTPEFTEET,FES,I,J)
        END DO
      END DO
      TSQGTQDGTQ=CTRACE(SQGTQDGTQ)
      TSLGTLDGTL=CTRACE(SLGTLDGTL)
      TSUFTUUFTUUD=CTRACE(SUFTUUFTUUD)
      TSQFTUQDFTUQ=CTRACE(SQFTUQDFTUQ)
      TDUMGTHU1=CTRACE(DUMGTHU1)
      TFUSFUT=CTRACE(FUSFUT)
      TFDSFDT=CTRACE(FDSFDT)
      TFESFET=CTRACE(FESFET)
      TSDFTDDFTDDD=CTRACE(SDFTDDFTDDD)
      TSEFTEEFTEED=CTRACE(SEFTEEFTEED)
      TSQFTDQDFTDQ=CTRACE(SQFTDQDFTDQ)
      TSLFTELDFTEL=CTRACE(SLFTELDFTEL)
      TDUMGTHD1=CTRACE(DUMGTHD1)
      TSQGTPQDGTPQ=CTRACE(SQGTPQDGTPQ)
      TSLGTPLDGTPL=CTRACE(SLGTPLDGTPL)
      TSUGTPUGTPUD=CTRACE(SUGTPUGTPUD)
      TSDGTPDGTPDD=CTRACE(SDGTPDGTPDD)
      TSEGTPEGTPED=CTRACE(SEGTPEGTPED)
      TDUMGTPHU1=CTRACE(DUMGTPHU1)
      TDUMGTPHU2=CTRACE(DUMGTPHU2)
      TDUMGTPHD1=CTRACE(DUMGTPHD1)
      TDUMGTPHD2=CTRACE(DUMGTPHD2)
!
      BGTHU=1.D0/2.D0*THSW*(3.D0*TSQGTQDGTQ+TSLGTLDGTL)*G(204)
     $      +1.D0/2.D0*THSH*THSW*(MGTHUSQ+MGTHDSQ)*G(204)
     $      +1.D0/2.D0*THSH*(3.D0*G(204)*TSUFTUUFTUUD
     $       +3.D0*G(204)*TSQFTUQDFTUQ)
     $      +1.D0/4.D0*THSH*G(204)*(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ)
     $      -6.D0*TDUMGTHU1
     $      +G(204)*3.D0*TFUSFUT
     $      +1.D0/2.D0*THSH*G(204)*(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ)
     $      -G(204)*(9.D0/20.D0*G(1)**2+33.D0/4.D0*G(2)**2)
!
      BGTHD=1.D0/2.D0*THSW*(3.D0*TSQGTQDGTQ+TSLGTLDGTL)*G(205)
     $      +1.D0/2.D0*THSH*THSW*(MGTHUSQ+MGTHDSQ)*G(205)
     $      +1.D0/2.D0*THSH*(3.D0*G(205)*TSDFTDDFTDDD
     $       +G(205)*TSEFTEEFTEED+3.D0*G(205)*TSQFTDQDFTDQ
     $       +G(205)*TSLFTELDFTEL)
     $      +1.D0/4.D0*THSH*G(205)*(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $      -2.D0*TDUMGTHD1
     $      +G(205)*(3.D0*TFDSFDT+TFESFET)
     $      +1.D0/2.D0*THSH*G(205)*(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $      -G(205)*(9.D0/20.D0*G(1)**2+33.D0/4.D0*G(2)**2)
!
      BGTPHU=2.D0/4.D0*THSB*(1.D0/3.D0*TSQGTPQDGTPQ+TSLGTPLDGTPL
     $        +8.D0/3.D0*TSUGTPUGTPUD+2.D0/3.D0*TSDGTPDGTPDD
     $        +2.D0*TSEGTPEGTPED)*G(184)
     $       +1.D0/2.D0*THSH*THSB*(MGTPHUSQ+MGTPHDSQ)*G(184)
     $       +1.D0/2.D0*THSH*(3.D0*G(184)*TSUFTUUFTUUD
     $        +3.D0*G(184)*TSQFTUQDFTUQ)
     $       +1.D0/4.D0*THSH*G(184)*(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ)
     $       +2.D0*TDUMGTPHU1-8.D0*TDUMGTPHU2
     $       +G(184)*3.D0*TFUSFUT
     $       +1.D0/2.D0*THSH*G(184)*(3.D0*THSW*MGTHUSQ+THSB*MGTPHUSQ)
     $       -G(184)*(9.D0/20.D0*G(1)**2+9.D0/4.D0*G(2)**2)
!
      BGTPHD=2.D0/4.D0*THSB*(1.D0/3.D0*TSQGTPQDGTPQ+TSLGTPLDGTPL
     $        +8.D0/3.D0*TSUGTPUGTPUD+2.D0/3.D0*TSDGTPDGTPDD
     $        +2.D0*TSEGTPEGTPED)*G(185)
     $       +1.D0/2.D0*THSH*THSB*(MGTPHUSQ+MGTPHDSQ)*G(185)
     $       +1.D0/2.D0*THSH*(3.D0*G(185)*TSDFTDDFTDDD
     $        +G(185)*TSEFTEEFTEED+3.D0*G(185)*TSQFTDQDFTDQ
     $        +G(185)*TSLFTELDFTEL)
     $       +1.D0/4.D0*THSH*G(185)*(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $       +2.D0*TDUMGTPHD1-4.D0*TDUMGTPHD2
     $       +G(185)*(3.D0*TFDSFDT+TFESFET)
     $       +1.D0/2.D0*THSH*G(185)*(3.D0*THSW*MGTHDSQ+THSB*MGTPHDSQ)
     $       -G(185)*(9.D0/20.D0*G(1)**2+9.D0/4.D0*G(2)**2)
!
!Convert into form readable by RKSTP
!
      F(184)=THHH*(1.D0/16.D0/PI**2*BGTPHU
     $           +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0))
      F(185)=THHH*(1.D0/16.D0/PI**2*BGTPHD
     $           +1.D0/(16.D0*PI**2)**2*B2GM(1)*DSQRT(3.D0/5.D0))
      F(204)=THHH*(1.D0/16.D0/PI**2*BGTHU
     $           +1.D0/(16.D0*PI**2)**2*B2GM(2))
      F(205)=THHH*(1.D0/16.D0/PI**2*BGTHD
     $           +1.D0/(16.D0*PI**2)**2*B2GM(2))
!
      IF(THHH.EQ.0)THEN
        DO I=1,3
          DO J=1,3
            DUMGTHU1(I,J)=CMATMUL(0,SQFTUQTGTQ,LUS,I,J)
            DUMGTHD1(I,J)=3.D0*CMATMUL(0,SQFTDQTGTQ,LDS,I,J)
     $                    +CMATMUL(0,SLFTELTGTL,LES,I,J)
            DUMGTPHU1(I,J)=CMATMUL(0,SQFTUQTGTPQ,LUS,I,J)
            DUMGTPHU2(I,J)=CMATMUL(0,SUGTPUFTUUT,LUS,I,J)
            DUMGTPHD1(I,J)=-CMATMUL(0,SQFTDQTGTPQ,LDS,I,J)
     $                     +CMATMUL(0,SLFTELTGTPL,LES,I,J)
            DUMGTPHD2(I,J)=CMATMUL(0,SDGTPDFTDDT,LDS,I,J)
     $                     +CMATMUL(0,SEGTPEFTEET,LES,I,J)
          END DO
        END DO
        TDUMGTHU1=CTRACE(DUMGTHU1)
        TLUSLUT=CTRACE(LUSLUT)
        TLDSLDT=CTRACE(LDSLDT)
        TLESLET=CTRACE(LESLET)
        TDUMGTHD1=CTRACE(DUMGTHD1)
        TDUMGTPHU1=CTRACE(DUMGTPHU1)
        TDUMGTPHU2=CTRACE(DUMGTPHU2)
        TDUMGTPHD1=CTRACE(DUMGTPHD1)
        TDUMGTPHD2=CTRACE(DUMGTPHD2)
!
        BSGTHU=1.D0/2.D0*THSW*(3.D0*TSQGTQDGTQ+TSLGTLDGTL)*G(289)
     $        +1.D0/2.D0*THSH*THSW*(MSGTHUSQ+MCGTHDSQ)*G(289)
     $        +1.D0/2.D0*THSH*(3.D0*G(289)*TSUFTUUFTUUD
     $         +3.D0*G(289)*TSQFTUQDFTUQ)
     $        +1.D0/4.D0*THSH*G(289)
     $         *(3.D0*THSW*MSGTHUSQ+THSB*MSGTPHUSQ)
     $        -6.D0*TDUMGTHU1
****
     $        +THSB*THSH*G(290)*CONJG(G(288))*G(287)
     $        -THSW*THSH*MCGTHDSQ*G(289)
****
     $        +G(289)*(3.D0*TLUSLUT+3.D0*TLDSLDT+TLESLET)
     $        +1.D0/2.D0*THSH*G(289)*(3.D0*THSW*(MSGTHUSQ+MCGTHDSQ)
     $         +THSB*(MSGTPHUSQ+MCGTPHDSQ))
     $        -G(289)*(9.D0/20.D0*G(1)**2+33.D0/4.D0*G(2)**2)
!
        BCGTHD=1.D0/2.D0*THSW*(3.D0*TSQGTQDGTQ+TSLGTLDGTL)*G(290)
     $        +1.D0/2.D0*THSH*THSW*(MSGTHUSQ+MCGTHDSQ)*G(290)
     $        +1.D0/2.D0*THSH*(3.D0*G(290)*TSDFTDDFTDDD
     $         +G(290)*TSEFTEEFTEED+3.D0*G(290)*TSQFTDQDFTDQ
     $         +G(290)*TSLFTELDFTEL)
     $        +1.D0/4.D0*THSH*G(290)*(3.D0*THSW*MCGTHDSQ+THSB*MCGTPHDSQ)
     $        -2.D0*TDUMGTHD1
****
     $        +THSB*THSH*G(289)*CONJG(G(287))*G(288)
     $        -THSW*THSH*MSGTHUSQ*G(290)
****
     $        +G(290)*(3.D0*TLUSLUT+3.D0*TLDSLDT+TLESLET)
     $        +1.D0/2.D0*THSH*G(290)*(3.D0*THSW*(MSGTHUSQ+MCGTHDSQ)
     $         +THSB*(MSGTPHUSQ+MCGTPHDSQ))
     $        -G(290)*(9.D0/20.D0*G(1)**2+33.D0/4.D0*G(2)**2)
!
        BSGTPHU=2.D0/4.D0*THSB*(1.D0/3.D0*TSQGTPQDGTPQ+TSLGTPLDGTPL
     $          +8.D0/3.D0*TSUGTPUGTPUD+2.D0/3.D0*TSDGTPDGTPDD
     $          +2.D0*TSEGTPEGTPED)*G(287)
     $         +1.D0/2.D0*THSH*THSB*(MSGTPHUSQ+MCGTPHDSQ)*G(287)
     $         +1.D0/2.D0*THSH*(3.D0*G(287)*TSUFTUUFTUUD
     $          +3.D0*G(287)*TSQFTUQDFTUQ)
     $         +1.D0/4.D0*THSH*G(287)*(3.D0*THSW*MSGTHUSQ
     $          +THSB*MSGTPHUSQ)
     $         +2.D0*TDUMGTPHU1-8.D0*TDUMGTPHU2
****
     $         +THSB*THSH*MCGTPHDSQ*G(287)
     $         +3.D0*THSW*THSH*G(288)*CONJG(G(290))*G(289)
****
     $         +G(287)*(3.D0*TLUSLUT+3.D0*TLDSLDT+TLESLET)
     $         +1.D0/2.D0*THSH*G(287)*(3.D0*THSW*(MSGTHUSQ+MCGTHDSQ)
     $          +THSB*(MSGTPHUSQ+MCGTPHDSQ))
     $         -G(287)*(9.D0/20.D0*G(1)**2+9.D0/4.D0*G(2)**2)
!
        BCGTPHD=2.D0/4.D0*THSB*(1.D0/3.D0*TSQGTPQDGTPQ+TSLGTPLDGTPL
     $          +8.D0/3.D0*TSUGTPUGTPUD+2.D0/3.D0*TSDGTPDGTPDD
     $          +2.D0*TSEGTPEGTPED)*G(288)
     $         +1.D0/2.D0*THSH*THSB*(MSGTPHUSQ+MCGTPHDSQ)*G(288)
     $         +1.D0/2.D0*THSH*(3.D0*G(288)*TSDFTDDFTDDD
     $          +G(288)*TSEFTEEFTEED+3.D0*G(288)*TSQFTDQDFTDQ
     $          +G(288)*TSLFTELDFTEL)
     $         +1.D0/4.D0*THSH*G(288)*(3.D0*THSW*MCGTHDSQ
     $          +THSB*MCGTPHDSQ)
     $         +2.D0*TDUMGTPHD1-4.D0*TDUMGTPHD2
****
     $         +THSB*THSH*MSGTPHUSQ*G(288)
     $         +3.D0*THSW*THSH*G(287)*CONJG(G(289))*G(290)
****
     $         +G(288)*(3.D0*TLUSLUT+3.D0*TLDSLDT+TLESLET)
     $         +1.D0/2.D0*THSH*G(288)*(3.D0*THSW*(MSGTHUSQ+MCGTHDSQ)
     $          +THSB*(MSGTPHUSQ+MCGTPHDSQ))
     $         -G(288)*(9.D0/20.D0*G(1)**2+9.D0/4.D0*G(2)**2)
!
!The two loop part of the running will be the same as the
!ordinary g running multiplied by an s (or corresponding c)
!
!
!Convert into form readable by RKSTP
!
        F(287)=1.D0/16.D0/PI**2*BSGTPHU
     $             +1.D0/(16.D0*PI**2)**2*SINB*B2GM(1)*DSQRT(3.D0/5.D0)
        F(288)=1.D0/16.D0/PI**2*BCGTPHD
     $             +1.D0/(16.D0*PI**2)**2*COSB*B2GM(1)*DSQRT(3.D0/5.D0)
        F(289)=1.D0/16.D0/PI**2*BSGTHU
     $             +1.D0/(16.D0*PI**2)**2*SINB*B2GM(2)
        F(290)=1.D0/16.D0/PI**2*BCGTHD
     $             +1.D0/(16.D0*PI**2)**2*COSB*B2GM(2)
      END IF
!
!Now I work out the \tilde{\mu}^* f^{h_u}_u terms. These only exist
!above m_H
!
      IF(THHH.EQ.1)THEN
        DO I=1,3
          DO J=1,3
            SQIDMTSFU(I,J)=CSFMUL(THSQ,ID,MTSFU,I,J)
            SQIDMTSFD(I,J)=CSFMUL(THSQ,ID,MTSFD,I,J)
            SQFUHUDMTSFU(I,J)=CSFMUL(THSQ,FUHUD,MTSFU,I,J)
            SQFDHDDMTSFD(I,J)=CSFMUL(THSQ,FDHDD,MTSFD,I,J)
            SLIDMTSFE(I,J)=CSFMUL(THSL,ID,MTSFE,I,J)
            SLFEHDDMTSFE(I,J)=CSFMUL(THSL,FEHDD,MTSFE,I,J)
            SUMTSFUID(I,J)=CSFMUL(THSU,MTSFU,ID,I,J)
            SUMTSFUFUQDFDQ(I,J)=CSFMUL(THSU,MTSFU,FUQDFDQ,I,J)
            SDMTSFDID(I,J)=CSFMUL(THSD,MTSFD,ID,I,J)
            SDMTSFDFDQDFUQ(I,J)=CSFMUL(THSD,MTSFD,FDQDFUQ,I,J)
            SEMTSFEID(I,J)=CSFMUL(THSE,MTSFE,ID,I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            SUSQIDMTSFUID(I,J)=CSFMUL(THSU,SQIDMTSFU,ID,I,J)
            SDSQIDMTSFDID(I,J)=CSFMUL(THSD,SQIDMTSFD,ID,I,J)
            SESLIDMTSFEID(I,J)=CSFMUL(THSE,SLIDMTSFE,ID,I,J)
          END DO
        END DO
        SUTSQFUHUDMTSFU=TCSFMUL(THSU,SQFUHUDMTSFU)
        SDTSQFDHDDMTSFD=TCSFMUL(THSD,SQFDHDDMTSFD)
        SETSLFEHDDMTSFE=TCSFMUL(THSE,SLFEHDDMTSFE)
        DO I=1,3
          DO J=1,3
            DUMMTSFU1(I,J)=(G(457)**2/6.D0-3.D0*G(458)**2/2.D0)*ID(I,J)
     $                    +2.D0*FDDRFDDRD(I,J)
            DUMMTSFU2(I,J)=8.D0/9.D0*THSB*GTPUTGTPUS(I,J)
     $                    +8.D0/3.D0*THGL*GTSUTGTSUS(I,J)
     $                    +2.D0*THSH*FTUUDFTUU(I,J)
            DUMMTSFU3(I,J)=THSH*FTUQFTUQD(I,J)+THSH*FTDQFTDQD(I,J)
     $                    +1.D0/18.D0*THSB*GTPQSGTPQT(I,J)
     $                    +3.D0/2.D0*THSW*GTQSGTQT(I,J)
     $                    +8.D0/3.D0*THGL*GTSQSGTSQT(I,J)
!
            DUMMTSFD1(I,J)=(G(457)**2/6.D0+3.D0*G(458)**2/2.D0)*ID(I,J)
     $                    -2.D0*FUURFUURD(I,J)
            DUMMTSFD2(I,J)=2.D0/9.D0*THSB*GTPDTGTPDS(I,J)
     $                    +8.D0/3.D0*THGL*GTSDTGTSDS(I,J)
     $                    +2.D0*THSH*FTDDDFTDD(I,J)
            DUMMTSFD3(I,J)=DUMMTSFU3(I,J)
!
            DUMMTSFE1(I,J)=(G(457)**2/2.D0-3.D0*G(458)**2/2.D0)*ID(I,J)
            DUMMTSFE2(I,J)=2.D0*THSB*GTPETGTPES(I,J)
     $                    +2.D0*THSH*FTEEDFTEE(I,J)
            DUMMTSFE3(I,J)=THSH*FTELFTELD(I,J)
     $                    +1.D0/2.D0*THSB*GTPLSGTPLT(I,J)
     $                    +3.D0/2.D0*THSW*GTLSGTLT(I,J)
          END DO
        END DO
        DO I=1,3
          DO J=1,3
            BMTSFU(I,J)=2.D0/3.D0*G(457)**2*SUMTSFUID(I,J)
     $                 -2.D0*(G(457)**2/9.D0+4.D0*G(459)**2/3.D0)
     $                  *SUSQIDMTSFUID(I,J)
     $                 +6.D0*FUHU(I,J)*SUTSQFUHUDMTSFU
     $                 -CSFMUL(THSQ,DUMMTSFU1,MTSFU,I,J)
     $                 -2.D0*SDMTSFDFDQDFUQ(I,J)
     $                 -2.D0/3.D0*THSB*THSH*CONJG(G(108))*G(185)
     $                  *(4.D0*FTUQGTPUS(I,J)-GTPQSFTUU(I,J))
     $                 -6.D0*THSH*THSW*CONJG(G(108))*G(205)
     $                  *GTQSFTUU(I,J)
     $                 +4.D0*THSH*CONJG(G(108))*FTDQFDDFTUU(I,J)
     $                 +CSFMUL(THSU,MTSFU,DUMMTSFU2,I,J)
     $                 +(3.D0*TFDDFD+TFEDFE+1.D0/2.D0*THSB*THSH*MGTPHDSQ
     $                  +3.D0/2.D0*THSW*THSH*MGTHDSQ)*MTSFU(I,J)
     $                 +CSFMUL(THSQ,DUMMTSFU3,MTSFU,I,J)
     $                 -(13.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2
     $                  +8.D0*G(3)**2)*MTSFU(I,J)
!
            BMTSFD(I,J)=1.D0/3.D0*G(457)**2*SDMTSFDID(I,J)
     $                 +2.D0*(G(457)**2/18.D0-4.D0*G(459)**2/3.D0)
     $                  *SDSQIDMTSFDID(I,J)
     $                 +6.D0*FDHD(I,J)*SDTSQFDHDDMTSFD
     $                 +2.D0*FDHD(I,J)*SETSLFEHDDMTSFE
     $                 +CSFMUL(THSQ,DUMMTSFD1,MTSFD,I,J)
     $                 -2.D0*SUMTSFUFUQDFDQ(I,J)
     $                 -2.D0/3.D0*THSB*THSH*CONJG(G(108))*G(184)
     $                  *(2.D0*FTDQGTPDS(I,J)+GTPQSFTDD(I,J))
     $                 -6.D0*THSH*THSW*CONJG(G(108))*G(204)
     $                  *GTQSFTDD(I,J)
     $                 +4.D0*THSH*CONJG(G(108))*FTUQFUDFTDD(I,J)
     $                 +CSFMUL(THSD,MTSFD,DUMMTSFD2,I,J)
     $                 +(3.D0*TFUDFU+1.D0/2.D0*THSB*THSH*MGTPHUSQ
     $                  +3.D0/2.D0*THSW*THSH*MGTHUSQ)*MTSFD(I,J)
     $                 +CSFMUL(THSQ,DUMMTSFD3,MTSFD,I,J)
     $                 -(7.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2
     $                  +8.D0*G(3)**2)*MTSFD(I,J)
!
            BMTSFE(I,J)=G(457)**2*SEMTSFEID(I,J)
     $                 -G(457)**2*SESLIDMTSFEID(I,J)
     $                 +2.D0*FEHD(I,J)*SETSLFEHDDMTSFE
     $                 +6.D0*FEHD(I,J)*SDTSQFDHDDMTSFD
     $                 -CSFMUL(THSL,DUMMTSFE1,MTSFE,I,J)
     $                 -2.D0*THSB*THSH*CONJG(G(108))*G(184)
     $                  *(2.D0*FTELGTPES(I,J)-GTPLSFTEE(I,J))
     $                 -6.D0*THSH*THSW*CONJG(G(108))*G(204)
     $                  *GTLSFTEE(I,J)
     $                 +CSFMUL(THSE,MTSFE,DUMMTSFE2,I,J)
     $                 +(3.D0*TFUDFU+1.D0/2.D0*THSB*THSH*MGTPHUSQ
     $                  +3.D0/2.D0*THSW*THSH*MGTHUSQ)*MTSFE(I,J)
     $                 +CSFMUL(THSL,DUMMTSFE3,MTSFE,I,J)
     $                 -(27.D0/10.D0*G(1)**2+9.D0/2.D0*G(2)**2)
     $                  *MTSFE(I,J)
!
!Convert into form readable by RKSTP
!
            F(429+(I-1)*3+J)=1.D0/16.D0/PI**2*BMTSFU(I,J)
     $           +1.D0/(16.D0*PI**2)**2*(CONJG(G(398))*B2YMU(J,I)
     $                                    +YU(J,I)*CONJG(B2GRKMUM))
            F(438+(I-1)*3+J)=1.D0/16.D0/PI**2*BMTSFD(I,J)
     $           +1.D0/(16.D0*PI**2)**2*(CONJG(G(398))*B2YMD(J,I)
     $                                    +YD(J,I)*CONJG(B2GRKMUM))
            F(447+(I-1)*3+J)=1.D0/16.D0/PI**2*BMTSFE(I,J)
     $           +1.D0/(16.D0*PI**2)**2*(CONJG(G(398))*B2YME(J,I)
     $                                    +YE(J,I)*CONJG(B2GRKMUM))

          END DO
        END DO
      END IF
!
!
!Next I am going to work out the primed gaugino terms, M'_{1,2,3}
!
!
      IF(THHH.EQ.0)THEN
        BMP(1)=G(599)*(TDUMM1+THSH*(MSGTPHUSQ+MCGTPHDSQ))
     $        -2.D0*(0.D0,1.D0)*THSH*(G(287)*CONJG(G(108))*G(288)
     $                            -CONJG(G(287))*G(108)*CONJG(G(288)))
!
        BMP(2)=G(600)*(TDUMM2+THSH*(MSGTHUSQ+MCGTHDSQ))
     $        -2.D0*(0.D0,1.D0)*THSH*(G(289)*CONJG(G(108))*G(290)
     $                            -CONJG(G(289))*G(108)*CONJG(G(290)))
     $        -12.D0*G(600)*G(2)**2
!
        BMP(3)=G(601)*TDUMM3-18.D0*G(601)*G(3)**2
      ELSE
        BMP(1)=G(599)*(TDUMM1+THSH*(MGTPHUSQ+MGTPHDSQ))
!
        BMP(2)=G(600)*(TDUMM2+THSH*(MGTHUSQ+MGTHDSQ))
     $        -12.D0*G(600)*G(2)**2
!
        BMP(3)=G(601)*TDUMM3-18.D0*G(601)*G(3)**2
      END IF
!
!NB: There is some work here converting the MSSM MV notation
!    M_{1,2,3} 2-lp beta functions to BT notation.
!The RKSTP compatible derivatives are:
!
      F(599)=THSB*(1.D0/16.D0/PI**2*BMP(1)
     $         +1.D0/(16.D0*PI**2)**2*(0.D0,1.D0)/2.D0
     $                                *(B2M(1)-CONJG(B2M(1))))
      F(600)=THSW*(1.D0/16.D0/PI**2*BMP(2)
     $         +1.D0/(16.D0*PI**2)**2*(0.D0,1.D0)/2.D0
     $                                *(B2M(2)-CONJG(B2M(2))))
      F(601)=THGL*(1.D0/16.D0/PI**2*BMP(3)
     $         +1.D0/(16.D0*PI**2)**2*(0.D0,1.D0)/2.D0
     $                                *(B2M(3)-CONJG(B2M(3))))
!
!Rotate F to original basis.
!
      DO I=1,601
        FCURR(I)=F(I)
      END DO
!
      IF(NSQ+NSU+NSD+NSL+NSE.LT.15)THEN
!
!If necessary, rotate the Fs back into the old current basis.
!
        CALL ROTSQBACK(F,FCURR)
      END IF
!
!Set the OLDN for the next step
!
      OLDNSQ=NSQ
      OLDNSU=NSU
      OLDNSD=NSD
      OLDNSL=NSL
      OLDNSE=NSE
!
      RETURN
      END
