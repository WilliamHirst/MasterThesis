


**********************************************************************
*** dsntearthmass gives the mass of the earth in units of kg within
*** a sphere with of radius r meters.
*** author: joakim edsjo (edsjo@physto.se)
*** date: april 1, 1999
**********************************************************************

      real*8 function dsntearthmass(r)
      implicit none

      real*8 radius(42),mass(42),rpl,r
      integer i,j

      data radius/0.0d0,7140.0d0,128140.0d0,378140.0d0,628140.0d0,
     &  878140.0d0,1128140.0d0,1228140.0d0,1228150.0d0,1378140.0d0,
     &  1628140.0d0,1878140.0d0,2128140.0d0,2378140.0d0,2628140.0d0,
     &  2878140.0d0,3128140.0d0,3378140.0d0,3478140.0d0,3478150.0d0,
     &  3628140.0d0,3878140.0d0,4128140.0d0,4378140.0d0,4628140.0d0,
     &  4878140.0d0,5128140.0d0,5378140.0d0,5608140.0d0,5708140.0d0,
     &  5708150.0d0,5778140.0d0,5878140.0d0,5978140.0d0,5978150.0d0,
     &  6158140.0d0,6158150.0d0,6298140.0d0,6354140.0d0,6363140.0d0,
     &  6375140.0d0,6378140.0d0/

      data mass/0.0d0,1.995826989053280d+016,
     &  1.153672166114359d+20,2.960479834293988d+21,
     &  1.353238541344870d+22,3.683097886213703d+22,
     &  7.771511245625917d+22,1.000355952176438d+23,
     &  1.000374913517410d+23,1.389014568570631d+23,
     &  2.243166261552859d+23,3.387904193104730d+23,
     &  4.857875282471053d+23,6.682836839120930d+23,
     &  8.886484066215031d+23,1.148615481867068d+24,
     &  1.449160656962283d+24,1.790289116936135d+24,
     &  1.937828583590099d+24,1.937822126866906d+24,
     &  2.069555870110683d+24,2.310077261394531d+24,
     &  2.577440897386178d+24,2.872127280497442d+24,
     &  3.194147870073969d+24,3.543692732155418d+24,
     &  3.920323075644481d+24,4.323473219955291d+24,
     &  4.716777846816285d+24,4.894195991180629d+24,
     &  4.894221810886638d+24,5.009792253818371d+24,
     &  5.176911789147846d+24,5.344007207753540d+24,
     &  5.344022853739555d+24,5.634742120264167d+24,
     &  5.634724737014979d+24,5.864461998416195d+24,
     &  5.959375032775971d+24,5.973827205427459d+24,
     &  5.990633218714214d+24,5.994583806913682d+24/

      if (r.ge.6378.140d3) then
        dsntearthmass=mass(42)
        return
      endif

      if (r.le.0.0d0) then
        dsntearthmass=0.0d0
        return
      endif

      call dshunt(radius,42,r,j)
      if (j.le.42.and.j.ge.1) goto 20

      dsntearthmass=mass(42)
      return

c      write(*,*) 'radius=',r,'  j=',j
 20   rpl=(r-radius(j))/(radius(j+1)-radius(j))

      dsntearthmass=mass(j)*(1.0d0-rpl)+mass(j+1)*rpl

      return
      end
